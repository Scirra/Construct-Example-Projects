{
	"name": "Events",
	"events": [
		{
			"eventType": "comment",
			"text": "Made by Viridino Studios (@ViridinoStudios)\n\nMateus Ferreira Moreira - Programmer\nX: @BonzerKitten\nE-mail: ferreiramoreiramateus@gmail.com\n\nFelipe Vaiano Calderan - Programmer\nX: @fvcalderan\nE-mail: fvcalderan@gmail.com\n\nWesley Andrade - Artist\nX: @andrart7\nE-mail: wesleymatos1989@gmail.com\n\nHelp us make new examples by supporting our work on https://www.patreon.com/viridinostudios"
		},
		{
			"eventType": "comment",
			"text": "Global variables"
		},
		{
			"eventType": "variable",
			"name": "currentPlayer",
			"type": "string",
			"initialValue": "placeCue",
			"comment": "Current player",
			"isStatic": false,
			"isConstant": false,
			"sid": 274050599205347
		},
		{
			"eventType": "variable",
			"name": "aBallHasBeenPotted",
			"type": "boolean",
			"initialValue": "false",
			"comment": "Has at least one ball been potted this turn?",
			"isStatic": false,
			"isConstant": false,
			"sid": 162834463283429
		},
		{
			"eventType": "variable",
			"name": "wrongColor",
			"type": "boolean",
			"initialValue": "false",
			"comment": "Did the player pot a wrong color ball?",
			"isStatic": false,
			"isConstant": false,
			"sid": 579780878345677
		},
		{
			"eventType": "variable",
			"name": "correctColor",
			"type": "boolean",
			"initialValue": "false",
			"comment": "Did the player pot a correct color ball?",
			"isStatic": false,
			"isConstant": false,
			"sid": 678155572889530
		},
		{
			"eventType": "variable",
			"name": "cueHit",
			"type": "boolean",
			"initialValue": "false",
			"comment": "Did the player already hit the cue ball?",
			"isStatic": false,
			"isConstant": false,
			"sid": 419722458607944
		},
		{
			"eventType": "variable",
			"name": "breakPotColor",
			"type": "string",
			"initialValue": "noBallsPotted",
			"comment": "Color of the first ball potted during the break",
			"isStatic": false,
			"isConstant": false,
			"sid": 759351162671229
		},
		{
			"eventType": "comment",
			"text": "Settings"
		},
		{
			"eventType": "variable",
			"name": "MIN_BALL_VELOCITY",
			"type": "number",
			"initialValue": "10",
			"comment": "Minimum velocity before a ball stops",
			"isStatic": false,
			"isConstant": true,
			"sid": 346084892261581
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Tool Functions",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "End the game with a message."
				},
				{
					"functionName": "endGame",
					"functionDescription": "End the game with a message",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "message",
							"type": "string",
							"initialValue": "",
							"comment": "Message to be displayed",
							"sid": 569088785272037
						}
					],
					"eventType": "function-block",
					"conditions": [],
					"actions": [
						{
							"type": "comment",
							"text": "Set the current player to \"gameOver\". This disables several functionalities of the program."
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 796004989470118,
							"parameters": {
								"variable": "currentPlayer",
								"value": "\"gameOver\""
							}
						},
						{
							"type": "comment",
							"text": "Disable Stick group"
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 641663194620035,
							"parameters": {
								"group-name": "\"Stick\"",
								"state": "deactivated"
							}
						},
						{
							"type": "comment",
							"text": "Display the text."
						},
						{
							"callFunction": "changeInfoText",
							"sid": 759953274042388,
							"parameters": [
								"message"
							]
						},
						{
							"type": "comment",
							"text": "Stop all the balls."
						},
						{
							"id": "set-velocity",
							"objectClass": "Ball",
							"sid": 567010676884480,
							"behaviorType": "Physics",
							"parameters": {
								"x-component": "0",
								"y-component": "0"
							}
						},
						{
							"id": "set-velocity",
							"objectClass": "CueBall",
							"sid": 888281765134585,
							"behaviorType": "Physics",
							"parameters": {
								"x-component": "0",
								"y-component": "0"
							}
						},
						{
							"type": "comment",
							"text": "Wait before restarting the game."
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 473445625684194,
							"parameters": {
								"seconds": "5.0"
							}
						},
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 565273099607727
						},
						{
							"id": "reset-global-variables",
							"objectClass": "System",
							"sid": 393393321805369
						}
					],
					"sid": 852937592492678
				},
				{
					"eventType": "comment",
					"text": "Change information text with a flash effect."
				},
				{
					"functionName": "changeInfoText",
					"functionDescription": "Change information text",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "text",
							"type": "string",
							"initialValue": "",
							"comment": "Text to be displayed",
							"sid": 404740572233591
						}
					],
					"eventType": "function-block",
					"conditions": [],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "TextInfo",
							"sid": 365592183863355,
							"parameters": {
								"text": "text"
							}
						},
						{
							"id": "flash",
							"objectClass": "TextInfo",
							"sid": 897863791896851,
							"behaviorType": "Flash",
							"parameters": {
								"on-time": "0.1",
								"off-time": "0.1",
								"duration": "1"
							}
						}
					],
					"sid": 811321500453781
				}
			],
			"sid": 635406975152412
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Setup",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Intial setup."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 448090279118028
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Remove gravity, since the game is topdown."
						},
						{
							"id": "set-world-gravity",
							"objectClass": "Ball",
							"sid": 894039682310821,
							"behaviorType": "Physics",
							"parameters": {
								"gravity": "0"
							}
						},
						{
							"type": "comment",
							"text": "Disable gameplay groups."
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 865936483358304,
							"parameters": {
								"group-name": "\"Place Cue\"",
								"state": "deactivated"
							}
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 817378393019722,
							"parameters": {
								"group-name": "\"Stick\"",
								"state": "deactivated"
							}
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 191649113817394,
							"parameters": {
								"group-name": "\"Balls\"",
								"state": "deactivated"
							}
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 910550896625749,
							"parameters": {
								"group-name": "\"Turn\"",
								"state": "deactivated"
							}
						},
						{
							"type": "comment",
							"text": "Start balls movement analysis."
						},
						{
							"id": "start-timer",
							"objectClass": "GameManager",
							"sid": 798831214577028,
							"behaviorType": "Timer",
							"parameters": {
								"duration": "0.01",
								"type": "regular",
								"tag": "\"AnalyzeMovement\""
							}
						}
					],
					"sid": 537536104415602
				}
			],
			"sid": 776957965110561
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Tutorial",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Tutorial is disabled on any click."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-any-click",
							"objectClass": "Mouse",
							"sid": 681459899082205
						}
					],
					"actions": [
						{
							"id": "tween-one-property",
							"objectClass": "TextTutorial",
							"sid": 173549234711954,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"TutorialOpacityTween\"",
								"property": "offsetOpacity",
								"end-value": "0",
								"time": "1",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "TextInfo",
							"sid": 672195240120735,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"InfoOpacityTween\"",
								"property": "offsetOpacity",
								"end-value": "100",
								"time": "1",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 343648992306681
						},
						{
							"type": "comment",
							"text": "Disable the tutorial."
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 832099487371833,
							"parameters": {
								"group-name": "\"Tutorial\"",
								"state": "deactivated"
							}
						},
						{
							"type": "comment",
							"text": "Enable gameplay groups."
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 630334661461444,
							"parameters": {
								"group-name": "\"Place Cue\"",
								"state": "activated"
							}
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 149379068475067,
							"parameters": {
								"group-name": "\"Balls\"",
								"state": "activated"
							}
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 865973582940349,
							"parameters": {
								"group-name": "\"Turn\"",
								"state": "activated"
							}
						}
					],
					"sid": 894962697030122
				}
			],
			"sid": 840936778107696
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Place Cue",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Let the player place the cue ball somewhere behind the head string."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 140294784805188
						}
					],
					"actions": [
						{
							"id": "set-position",
							"objectClass": "CueBall",
							"sid": 776707142159293,
							"parameters": {
								"x": "max(min(Mouse.X, LayoutWidth - 768), 160)",
								"y": "max(min(Mouse.Y, LayoutHeight - 160), 160)"
							}
						}
					],
					"sid": 169891976509416
				},
				{
					"eventType": "comment",
					"text": "When the player places the ball, the Place Cue group is deactivated and the Stick group is activated. This starts the normal game loop."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-button-released",
							"objectClass": "Mouse",
							"sid": 369652697398789,
							"parameters": {
								"mouse-button": "left"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Deactivate special \"Cue placement\" game loop."
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 284042960796892,
							"parameters": {
								"group-name": "\"Place Cue\"",
								"state": "deactivated"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 492791008479469,
							"parameters": {
								"variable": "currentPlayer",
								"value": "\"break\""
							}
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 532438225841969,
							"parameters": {
								"seconds": "0.1"
							}
						},
						{
							"type": "comment",
							"text": "Activate normal game loop."
						},
						{
							"id": "set-boolean-instvar",
							"objectClass": "Stick",
							"sid": 633006104123094,
							"parameters": {
								"instance-variable": "canCharge",
								"value": "true"
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "Stick",
							"sid": 848496161777649,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"StickFadeInTween\"",
								"property": "offsetOpacity",
								"end-value": "100",
								"time": "0.5",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 426362030139423,
							"parameters": {
								"group-name": "\"Stick\"",
								"state": "activated"
							}
						},
						{
							"callFunction": "changeInfoText",
							"sid": 546113665799384,
							"parameters": [
								"\"Perform the break.\""
							]
						},
						{
							"id": "set-enabled",
							"objectClass": "CueBall",
							"sid": 154155609506593,
							"behaviorType": "Physics",
							"parameters": {
								"mode": "enabled"
							}
						}
					],
					"sid": 198431832313564
				}
			],
			"sid": 388710719011360
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Stick",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "A new turn started."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-signal",
							"objectClass": "System",
							"sid": 131886988661513,
							"parameters": {
								"tag": "\"NewTurn\""
							}
						}
					],
					"actions": [],
					"sid": 408202408953382,
					"children": [
						{
							"eventType": "comment",
							"text": "If no ball has been potted during the break, swap the players (this should be done IRL, since no colors have been assigned to the players yet.)"
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 420572037758256,
									"parameters": {
										"value": "breakPotColor = \"noBallsPotted\""
									}
								}
							],
							"actions": [
								{
									"callFunction": "changeInfoText",
									"sid": 621647559287387,
									"parameters": [
										"\"No ball has been potted.\" & newline & \"Swap players!\""
									]
								}
							],
							"sid": 841472245007857
						},
						{
							"eventType": "comment",
							"text": "If a ball has been potted during the break, the current player assumes the color of that ball and starts the game."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 439547737112256
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 416975599496094,
									"parameters": {
										"value": "breakPotColor <> \"\""
									}
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "Stick",
									"sid": 629596637223916,
									"parameters": {
										"animation": "breakPotColor",
										"from": "beginning"
									}
								},
								{
									"callFunction": "changeInfoText",
									"sid": 947390134897570,
									"parameters": [
										"\"Player \" & breakPotColor & \" plays\""
									]
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 558860613255575,
									"parameters": {
										"variable": "currentPlayer",
										"value": "breakPotColor"
									}
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 959082039894621,
									"parameters": {
										"variable": "breakPotColor",
										"value": "\"\""
									}
								}
							],
							"sid": 195442136867162
						},
						{
							"eventType": "comment",
							"text": "This executes if the break has already happened."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 765976435255596
								}
							],
							"actions": [],
							"sid": 472402667601075,
							"children": [
								{
									"eventType": "comment",
									"text": "If the player potted a ball of the wrong color FIRST, swap players (which is now possible to identify, since, at this point, players have been assigned colors.)"
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-boolean-eventvar",
											"objectClass": "System",
											"sid": 300548056739883,
											"parameters": {
												"variable": "wrongColor"
											}
										}
									],
									"actions": [
										{
											"id": "set-boolean-eventvar",
											"objectClass": "System",
											"sid": 292808591593137,
											"parameters": {
												"variable": "cueHit",
												"value": "false"
											}
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 579874348137506,
											"parameters": {
												"variable": "currentPlayer",
												"value": "currentPlayer = \"red\" ? \"yellow\" : \"red\""
											}
										},
										{
											"callFunction": "changeInfoText",
											"sid": 565767639937713,
											"parameters": [
												"\"Wrong color potted.\" & newline & \"Player \" & currentPlayer & \" plays.\""
											]
										},
										{
											"id": "set-animation",
											"objectClass": "Stick",
											"sid": 713948750261262,
											"parameters": {
												"animation": "currentPlayer",
												"from": "beginning"
											}
										}
									],
									"sid": 528070981764499
								},
								{
									"eventType": "comment",
									"text": "If the player potted a ball of the correct color FIRST, they play again."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 979109840438976
										},
										{
											"id": "compare-boolean-eventvar",
											"objectClass": "System",
											"sid": 722851858680424,
											"parameters": {
												"variable": "correctColor"
											}
										}
									],
									"actions": [
										{
											"callFunction": "changeInfoText",
											"sid": 854386973581454,
											"parameters": [
												"\"Correct color potted.\" & newline & \"Player \" & currentPlayer & \" plays.\""
											]
										}
									],
									"sid": 818930465807784
								},
								{
									"eventType": "comment",
									"text": "If the player hasn't potted a ball in this turn, swap players."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 680581169703627
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 139878854320177,
											"parameters": {
												"variable": "currentPlayer",
												"value": "currentPlayer = \"red\" ? \"yellow\" : \"red\""
											}
										},
										{
											"callFunction": "changeInfoText",
											"sid": 462524207784404,
											"parameters": [
												"\"No ball has been potted.\" & newline & \"Player \" & currentPlayer & \" plays.\""
											]
										},
										{
											"id": "set-animation",
											"objectClass": "Stick",
											"sid": 886265332520039,
											"parameters": {
												"animation": "currentPlayer",
												"from": "beginning"
											}
										}
									],
									"sid": 387744931164412
								}
							]
						},
						{
							"eventType": "comment",
							"text": "If the stick is disabled (can't charge + invisible), enable it and reset aBallHasBeenPotted variable."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-boolean-instance-variable-set",
									"objectClass": "Stick",
									"sid": 274570095343030,
									"parameters": {
										"instance-variable": "canCharge"
									},
									"isInverted": true
								}
							],
							"actions": [
								{
									"id": "set-boolean-instvar",
									"objectClass": "Stick",
									"sid": 758214302381633,
									"parameters": {
										"instance-variable": "canCharge",
										"value": "true"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "Stick",
									"sid": 881268063236041,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"StickFadeInTween\"",
										"property": "offsetOpacity",
										"end-value": "100",
										"time": "0.5",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "set-boolean-eventvar",
									"objectClass": "System",
									"sid": 675585480424564,
									"parameters": {
										"variable": "aBallHasBeenPotted",
										"value": "false"
									}
								}
							],
							"sid": 588392795335714
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Set stick position and rotation when it's allowed to move."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-boolean-instance-variable-set",
							"objectClass": "Stick",
							"sid": 471734656326687,
							"parameters": {
								"instance-variable": "canCharge"
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "Stick",
							"sid": 284128840635472,
							"parameters": {
								"instance-variable": "chargeLevel",
								"comparison": 0,
								"value": "0"
							}
						}
					],
					"actions": [
						{
							"id": "set-position",
							"objectClass": "Stick",
							"sid": 611817649436186,
							"parameters": {
								"x": "CueBall.X",
								"y": "CueBall.Y"
							}
						},
						{
							"id": "set-angle-toward-position",
							"objectClass": "Stick",
							"sid": 108155648397182,
							"parameters": {
								"x": "Mouse.X",
								"y": "Mouse.Y"
							}
						}
					],
					"sid": 397088598767943
				},
				{
					"eventType": "comment",
					"text": "Increase sitck force when the player holds the left mouse button and the stick can be charged."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "mouse-button-is-down",
							"objectClass": "Mouse",
							"sid": 470086036448682,
							"parameters": {
								"mouse-button": "left"
							}
						},
						{
							"id": "is-boolean-instance-variable-set",
							"objectClass": "Stick",
							"sid": 224753722861735,
							"parameters": {
								"instance-variable": "canCharge"
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "Stick",
							"sid": 343632849079326,
							"parameters": {
								"instance-variable": "chargeLevel",
								"comparison": 2,
								"value": "50000"
							}
						},
						{
							"id": "is-playing",
							"objectClass": "Stick",
							"sid": 949292077226180,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"StickHit\""
							},
							"isInverted": true
						}
					],
					"actions": [
						{
							"id": "set-position",
							"objectClass": "Stick",
							"sid": 178841829377395,
							"parameters": {
								"x": "Self.X - cos(Self.Angle) * dt * 100",
								"y": "Self.Y - sin(Self.Angle) * dt * 100"
							}
						},
						{
							"id": "add-to-instvar",
							"objectClass": "Stick",
							"sid": 104941907601427,
							"parameters": {
								"instance-variable": "chargeLevel",
								"value": "dt * 30000"
							}
						},
						{
							"type": "comment",
							"text": "Disable movement analysis."
						},
						{
							"id": "set-boolean-instvar",
							"objectClass": "GameManager",
							"sid": 385591390426577,
							"parameters": {
								"instance-variable": "canAnalyzeMovement",
								"value": "false"
							}
						}
					],
					"sid": 545547036425983
				},
				{
					"eventType": "comment",
					"text": "Release stick to hit the ball."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-button-released",
							"objectClass": "Mouse",
							"sid": 859294234224715,
							"parameters": {
								"mouse-button": "left"
							}
						},
						{
							"id": "is-boolean-instance-variable-set",
							"objectClass": "Stick",
							"sid": 541712063971032,
							"parameters": {
								"instance-variable": "canCharge"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Move the stick to the ball."
						},
						{
							"id": "tween-two-properties",
							"objectClass": "Stick",
							"sid": 709449326729421,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"StickHit\"",
								"property": "position",
								"end-x": "CueBall.X + cos(Self.Angle) * 40",
								"end-y": "CueBall.Y + sin(Self.Angle) * 40",
								"time": "0.25",
								"ease": "easeinback",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"type": "comment",
							"text": "Disable charging."
						},
						{
							"id": "set-boolean-instvar",
							"objectClass": "Stick",
							"sid": 182847059444958,
							"parameters": {
								"instance-variable": "canCharge",
								"value": "false"
							}
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 570734991603448
						},
						{
							"type": "comment",
							"text": "When the stick hits the ball, apply the correct force."
						},
						{
							"id": "apply-force-towards-position",
							"objectClass": "CueBall",
							"sid": 537017311154275,
							"behaviorType": "Physics",
							"parameters": {
								"force": "Stick.chargeLevel",
								"x": "Stick.X + cos(Stick.Angle) * 1024",
								"y": "Stick.Y + sin(Stick.Angle) * 1024",
								"image-point": "0"
							}
						},
						{
							"type": "comment",
							"text": "Disable stick"
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Stick",
							"sid": 913256817596908,
							"parameters": {
								"instance-variable": "chargeLevel",
								"value": "0"
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "Stick",
							"sid": 830117682346245,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"StickFadeOutTween\"",
								"property": "offsetOpacity",
								"end-value": "0",
								"time": "0.5",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"type": "comment",
							"text": "Cue ball hit."
						},
						{
							"id": "set-boolean-eventvar",
							"objectClass": "System",
							"sid": 146445980563907,
							"parameters": {
								"variable": "cueHit",
								"value": "true"
							}
						},
						{
							"type": "comment",
							"text": "Enable movement analysis."
						},
						{
							"id": "set-boolean-instvar",
							"objectClass": "GameManager",
							"sid": 845299650656096,
							"parameters": {
								"instance-variable": "canAnalyzeMovement",
								"value": "true"
							}
						}
					],
					"sid": 968662173684897,
					"children": [
						{
							"eventType": "comment",
							"text": "When the cue ball starts rolling, if it's a normal turn (not a break), reset correctColor and wrongColor variables, as well as show \"In progress...\""
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 923504922530767,
									"parameters": {
										"value": "currentPlayer = \"red\" | currentPlayer = \"yellow\""
									}
								}
							],
							"actions": [
								{
									"callFunction": "changeInfoText",
									"sid": 689786962959424,
									"parameters": [
										"\"In progress...\""
									]
								},
								{
									"id": "set-boolean-eventvar",
									"objectClass": "System",
									"sid": 598572180481306,
									"parameters": {
										"variable": "correctColor",
										"value": "false"
									}
								},
								{
									"id": "set-boolean-eventvar",
									"objectClass": "System",
									"sid": 640411302659970,
									"parameters": {
										"variable": "wrongColor",
										"value": "false"
									}
								}
							],
							"sid": 609530354919091
						}
					]
				}
			],
			"sid": 229861001751560
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Balls",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Count the number of balls of a given color."
				},
				{
					"eventType": "variable",
					"name": "accumulator",
					"type": "number",
					"initialValue": "0",
					"comment": "Used to count the number of balls",
					"isStatic": false,
					"isConstant": false,
					"sid": 956123831197120
				},
				{
					"functionName": "countBallsOfGivenColor",
					"functionDescription": "Count the number of balls of a given color",
					"functionCategory": "",
					"functionReturnType": "number",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "color",
							"type": "string",
							"initialValue": "",
							"comment": "Color to count",
							"sid": 236519438675286
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "for-each",
							"objectClass": "System",
							"sid": 286677725908889,
							"parameters": {
								"object": "Ball"
							}
						},
						{
							"id": "is-animation-playing",
							"objectClass": "Ball",
							"sid": 412432304731883,
							"parameters": {
								"animation": "color"
							}
						}
					],
					"actions": [
						{
							"id": "add-to-eventvar",
							"objectClass": "System",
							"sid": 136229960766672,
							"parameters": {
								"variable": "accumulator",
								"value": "1"
							}
						}
					],
					"sid": 484389743894434,
					"children": [
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "set-function-return-value",
									"objectClass": "Functions",
									"sid": 667353702765398,
									"parameters": {
										"value": "accumulator"
									}
								}
							],
							"sid": 108869673603559
						}
					]
				},
				{
					"eventType": "comment",
					"text": "If a ball goes over a hole, make it match the hole position."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "Ball",
							"sid": 748667247273369,
							"parameters": {
								"object": "Hole"
							}
						},
						{
							"id": "is-any-playing",
							"objectClass": "Ball",
							"sid": 550180722210869,
							"behaviorType": "Tween",
							"isInverted": true
						}
					],
					"actions": [
						{
							"id": "tween-two-properties",
							"objectClass": "Ball",
							"sid": 511161128904126,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"PotBallPositionTween\"",
								"property": "position",
								"end-x": "Hole.X",
								"end-y": "Hole.Y",
								"time": "distance(Ball.X, Ball.Y, Hole.X, Hole.Y)/sqrt(Ball.Physics.VelocityX^2 + Ball.Physics.VelocityY^2)",
								"ease": "easeoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"id": "set-enabled",
							"objectClass": "Ball",
							"sid": 280403568956796,
							"behaviorType": "Physics",
							"parameters": {
								"mode": "disabled"
							}
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 796029186050493
						},
						{
							"type": "comment",
							"text": "After the ball has matched the hole position, destroy it using a shrink animation."
						},
						{
							"id": "tween-two-properties",
							"objectClass": "Ball",
							"sid": 685126247133311,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"PotBallSizeTween\"",
								"property": "size",
								"end-x": "0",
								"end-y": "0",
								"time": "0.5",
								"ease": "easeinoutsine",
								"destroy-on-complete": "yes",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						}
					],
					"sid": 363393693387778,
					"children": [
						{
							"eventType": "comment",
							"text": "Break logic."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 216815252540819,
									"parameters": {
										"value": "currentPlayer = \"break\""
									}
								}
							],
							"actions": [],
							"sid": 680508766184241,
							"children": [
								{
									"eventType": "comment",
									"text": "If the black ball is immediately potted, the current player loses."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-animation-playing",
											"objectClass": "Ball",
											"sid": 525306068555787,
											"parameters": {
												"animation": "\"black\""
											}
										}
									],
									"actions": [
										{
											"callFunction": "endGame",
											"sid": 778560916588064,
											"parameters": [
												"\"Black ball potted during break.\" & newline & \"Current player loses!\""
											]
										}
									],
									"sid": 236848632217237
								},
								{
									"eventType": "comment",
									"text": "Otherwise, current player assumes the role of the potted ball's color."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 396899253752827
										},
										{
											"id": "compare-boolean-eventvar",
											"objectClass": "System",
											"sid": 602404720427802,
											"parameters": {
												"variable": "aBallHasBeenPotted"
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 249468962771915,
											"parameters": {
												"variable": "breakPotColor",
												"value": "Ball.AnimationName"
											}
										},
										{
											"id": "set-boolean-eventvar",
											"objectClass": "System",
											"sid": 979552413320897,
											"parameters": {
												"variable": "aBallHasBeenPotted",
												"value": "true"
											}
										}
									],
									"sid": 941631693876634
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Normal play logic."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 145773633266875
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 702000840456609,
									"parameters": {
										"value": "currentPlayer = \"red\" | currentPlayer = \"yellow\""
									}
								}
							],
							"actions": [],
							"sid": 431126142148652,
							"children": [
								{
									"eventType": "variable",
									"name": "otherPlayer",
									"type": "string",
									"initialValue": "",
									"comment": "If current is red, the other is yellow, and vice-versa.",
									"isStatic": false,
									"isConstant": false,
									"sid": 649393379538896
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 754702814458173,
											"parameters": {
												"variable": "otherPlayer",
												"value": "currentPlayer = \"red\" ? \"yellow\" : \"red\""
											}
										}
									],
									"sid": 173771645223136
								},
								{
									"eventType": "comment",
									"text": "Black potted logic."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-animation-playing",
											"objectClass": "Ball",
											"sid": 436713754123379,
											"parameters": {
												"animation": "\"black\""
											}
										}
									],
									"actions": [],
									"sid": 530033525705036,
									"children": [
										{
											"eventType": "comment",
											"text": "If all the balls assigned to the current player are potted, they win the frame."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "evaluate-expression",
													"objectClass": "System",
													"sid": 916964746707177,
													"parameters": {
														"value": "Functions.countBallsOfGivenColor(currentPlayer) = 0"
													}
												}
											],
											"actions": [
												{
													"callFunction": "endGame",
													"sid": 587644818251494,
													"parameters": [
														"\"Black and \" & currentPlayer & \" balls potted.\" & newline & \"Player \" & currentPlayer & \" wins!\""
													]
												}
											],
											"sid": 264509651541158
										},
										{
											"eventType": "comment",
											"text": "Otherwise, current player loses the frame."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "else",
													"objectClass": "System",
													"sid": 798472818574167
												}
											],
											"actions": [
												{
													"callFunction": "endGame",
													"sid": 164150302946632,
													"parameters": [
														"\"Black ball potted too soon.\" & newline & \"Player \" & otherPlayer & \" wins!\""
													]
												}
											],
											"sid": 742123594505933
										}
									]
								},
								{
									"eventType": "comment",
									"text": "If a ball not assigned to the current player is potted and no assigned ball has been potted yet, change turns."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 123664493913178
										},
										{
											"id": "is-animation-playing",
											"objectClass": "Ball",
											"sid": 459697430958832,
											"parameters": {
												"animation": "otherPlayer"
											}
										},
										{
											"id": "compare-boolean-eventvar",
											"objectClass": "System",
											"sid": 468097336332443,
											"parameters": {
												"variable": "aBallHasBeenPotted"
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "set-boolean-eventvar",
											"objectClass": "System",
											"sid": 982502858654281,
											"parameters": {
												"variable": "wrongColor",
												"value": "true"
											}
										}
									],
									"sid": 616849607956162
								},
								{
									"eventType": "comment",
									"text": "If an assigned ball is potted, at least one ball has been potted."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 471209762737859
										},
										{
											"id": "is-animation-playing",
											"objectClass": "Ball",
											"sid": 723963437773293,
											"parameters": {
												"animation": "currentPlayer"
											}
										},
										{
											"id": "compare-boolean-eventvar",
											"objectClass": "System",
											"sid": 528567681514598,
											"parameters": {
												"variable": "aBallHasBeenPotted"
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "set-boolean-eventvar",
											"objectClass": "System",
											"sid": 474729750364448,
											"parameters": {
												"variable": "aBallHasBeenPotted",
												"value": "true"
											}
										},
										{
											"id": "set-boolean-eventvar",
											"objectClass": "System",
											"sid": 675922027999206,
											"parameters": {
												"variable": "correctColor",
												"value": "true"
											}
										}
									],
									"sid": 285130280857458
								}
							]
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Stop ball if overall velocity is less than or equal to MIN_BALL_VELOCITY."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-velocity",
							"objectClass": "Ball",
							"sid": 143469898689395,
							"behaviorType": "Physics",
							"parameters": {
								"which": "overall-velocity",
								"comparison": 3,
								"value": "MIN_BALL_VELOCITY"
							}
						}
					],
					"actions": [
						{
							"id": "set-velocity",
							"objectClass": "Ball",
							"sid": 877862017082950,
							"behaviorType": "Physics",
							"parameters": {
								"x-component": "0",
								"y-component": "0"
							}
						},
						{
							"id": "set-angular-velocity",
							"objectClass": "Ball",
							"sid": 735770604513554,
							"behaviorType": "Physics",
							"parameters": {
								"angular-velocity": "0"
							}
						}
					],
					"sid": 740759199436765
				},
				{
					"eventType": "comment",
					"text": "If the cue ball goes over a hole, make it match the hole position."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "CueBall",
							"sid": 738354469789522,
							"parameters": {
								"object": "Hole"
							}
						},
						{
							"id": "is-any-playing",
							"objectClass": "CueBall",
							"sid": 167086159457833,
							"behaviorType": "Tween",
							"isInverted": true
						}
					],
					"actions": [
						{
							"id": "tween-two-properties",
							"objectClass": "CueBall",
							"sid": 170699133152916,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"PotBallPositionTween\"",
								"property": "position",
								"end-x": "Hole.X",
								"end-y": "Hole.Y",
								"time": "distance(CueBall.X, CueBall.Y, Hole.X, Hole.Y)/sqrt(CueBall.Physics.VelocityX^2 + CueBall.Physics.VelocityY^2)",
								"ease": "easeoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"id": "set-enabled",
							"objectClass": "CueBall",
							"sid": 110781357549505,
							"behaviorType": "Physics",
							"parameters": {
								"mode": "disabled"
							}
						},
						{
							"type": "comment",
							"text": "After the cue ball has matched the hole position, destroy it using a shrink animation and end the frame. Whoever potted the cue ball loses."
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 174555272239995
						},
						{
							"id": "tween-two-properties",
							"objectClass": "CueBall",
							"sid": 164225776556896,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"PotBallSizeTween\"",
								"property": "size",
								"end-x": "0",
								"end-y": "0",
								"time": "0.5",
								"ease": "easeinoutsine",
								"destroy-on-complete": "yes",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						}
					],
					"sid": 751949235340727,
					"children": [
						{
							"eventType": "comment",
							"text": "If the Cue ball is potted during the normal game loop, the current player loses the frame immediately."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 777115019916298,
									"parameters": {
										"value": "currentPlayer = \"red\" | currentPlayer = \"yellow\""
									}
								}
							],
							"actions": [
								{
									"callFunction": "endGame",
									"sid": 647223486156124,
									"parameters": [
										"\"Cue ball potted.\" & newline & \"Player \" & (currentPlayer = \"red\" ? \"yellow\" : \"red\") & \" wins!\""
									]
								}
							],
							"sid": 777286260056986
						},
						{
							"eventType": "comment",
							"text": "Same happens during the break."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 592363779549756
								}
							],
							"actions": [
								{
									"callFunction": "endGame",
									"sid": 296403579885026,
									"parameters": [
										"\"Cue ball potted.\" & newline & \"Current player loses!\""
									]
								}
							],
							"sid": 723478780060603
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Stop cue ball if overall velocity is less than or equal to MIN_BALL_VELOCITY."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-velocity",
							"objectClass": "CueBall",
							"sid": 725814501690778,
							"behaviorType": "Physics",
							"parameters": {
								"which": "overall-velocity",
								"comparison": 3,
								"value": "MIN_BALL_VELOCITY"
							}
						}
					],
					"actions": [
						{
							"id": "set-velocity",
							"objectClass": "CueBall",
							"sid": 804900966914943,
							"behaviorType": "Physics",
							"parameters": {
								"x-component": "0",
								"y-component": "0"
							}
						},
						{
							"id": "set-angular-velocity",
							"objectClass": "CueBall",
							"sid": 167347372604052,
							"behaviorType": "Physics",
							"parameters": {
								"angular-velocity": "0"
							}
						}
					],
					"sid": 940061999111967
				}
			],
			"sid": 171744680162340
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Turn",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "variable",
					"name": "ballsMoved",
					"type": "number",
					"initialValue": "0",
					"comment": "Number of balls that moved since the last check",
					"isStatic": false,
					"isConstant": false,
					"sid": 803484517110653
				},
				{
					"eventType": "comment",
					"text": "Game checks for a new turn periodically, if the game is not over."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-timer",
							"objectClass": "GameManager",
							"sid": 420152952649078,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"AnalyzeMovement\""
							}
						},
						{
							"id": "is-boolean-instance-variable-set",
							"objectClass": "GameManager",
							"sid": 876626490710787,
							"parameters": {
								"instance-variable": "canAnalyzeMovement"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 173504508006360,
							"parameters": {
								"value": "currentPlayer <> \"gameOver\""
							}
						},
						{
							"id": "is-boolean-instance-variable-set",
							"objectClass": "Stick",
							"sid": 541514726235500,
							"parameters": {
								"instance-variable": "canCharge"
							},
							"isInverted": true
						}
					],
					"actions": [],
					"sid": 793585912420197,
					"children": [
						{
							"eventType": "comment",
							"text": "For every ball, check if it is still moving. If so, add to ballsMoved and update its old position to reflect the current one. Otherwise, stop it completely."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 351133184640548,
									"parameters": {
										"object": "Ball"
									}
								}
							],
							"actions": [],
							"sid": 248320065355187,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "evaluate-expression",
											"objectClass": "System",
											"sid": 915939958970391,
											"parameters": {
												"value": "(Ball.oldX <> Ball.X) | (Ball.oldY <> Ball.Y)"
											}
										},
										{
											"id": "is-any-playing",
											"objectClass": "Ball",
											"sid": 267909837650256,
											"behaviorType": "Tween",
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "add-to-eventvar",
											"objectClass": "System",
											"sid": 586323011856830,
											"parameters": {
												"variable": "ballsMoved",
												"value": "1"
											}
										},
										{
											"id": "set-instvar-value",
											"objectClass": "Ball",
											"sid": 431752373288107,
											"parameters": {
												"instance-variable": "oldX",
												"value": "Self.X"
											}
										},
										{
											"id": "set-instvar-value",
											"objectClass": "Ball",
											"sid": 814852360561241,
											"parameters": {
												"instance-variable": "oldY",
												"value": "Self.Y"
											}
										}
									],
									"sid": 877265971355359
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 390212299569418
										}
									],
									"actions": [
										{
											"id": "set-velocity",
											"objectClass": "Ball",
											"sid": 281346367463100,
											"behaviorType": "Physics",
											"parameters": {
												"x-component": "0",
												"y-component": "0"
											}
										}
									],
									"sid": 103172203610374
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 644860426093258,
									"parameters": {
										"value": "(CueBall.oldX <> CueBall.X) | (CueBall.oldY <> CueBall.Y)"
									}
								},
								{
									"id": "is-any-playing",
									"objectClass": "CueBall",
									"sid": 582797132837951,
									"behaviorType": "Tween",
									"isInverted": true
								}
							],
							"actions": [
								{
									"id": "add-to-eventvar",
									"objectClass": "System",
									"sid": 743562067203672,
									"parameters": {
										"variable": "ballsMoved",
										"value": "1"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "CueBall",
									"sid": 596901186416541,
									"parameters": {
										"instance-variable": "oldX",
										"value": "Self.X"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "CueBall",
									"sid": 713184354333949,
									"parameters": {
										"instance-variable": "oldY",
										"value": "Self.Y"
									}
								}
							],
							"sid": 927144912998797
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 712332546673191
								}
							],
							"actions": [
								{
									"id": "set-velocity",
									"objectClass": "CueBall",
									"sid": 106755529536161,
									"behaviorType": "Physics",
									"parameters": {
										"x-component": "0",
										"y-component": "0"
									}
								}
							],
							"sid": 472266340935920
						},
						{
							"eventType": "comment",
							"text": "If no ball has moved and the Cue ball has been hit, start a new turn."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 392065827901538,
									"parameters": {
										"value": "ballsMoved = 0"
									}
								},
								{
									"id": "compare-boolean-eventvar",
									"objectClass": "System",
									"sid": 411442822583027,
									"parameters": {
										"variable": "cueHit"
									}
								}
							],
							"actions": [
								{
									"id": "signal",
									"objectClass": "System",
									"sid": 725945762549238,
									"parameters": {
										"tag": "\"NewTurn\""
									}
								}
							],
							"sid": 739300774176228
						}
					]
				}
			],
			"sid": 854406603776439
		}
	],
	"sid": 837926549655207
}