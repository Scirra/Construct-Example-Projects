{
	"name": "MainCode",
	"events": [
		{
			"eventType": "comment",
			"text": "Made by Viridino Studios (@ViridinoStudios)\n\nMateus Ferreira - Programmer\nTwitter: @BonzerKitten\nE-mail: ferreiramoreiramateus@gmail.com\n\nWesley Andrade - Artist\nTwitter: @andrart7\nE-mail: wesleymatos1989@gmail.com\n\nMade with the support of our patrons on https://www.patreon.com/viridinostudios and our good friends at https://www.construct.net."
		},
		{
			"eventType": "comment",
			"text": "How long it takes for an enemy to be spawned."
		},
		{
			"eventType": "variable",
			"name": "SpawnTime",
			"type": "number",
			"initialValue": "1.25",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 526658891172343
		},
		{
			"eventType": "comment",
			"text": "How hard the game is. This affects both the heath and movement speed of all enemies."
		},
		{
			"eventType": "variable",
			"name": "DificultyMultiplier",
			"type": "number",
			"initialValue": "1",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 420954071163804
		},
		{
			"eventType": "comment",
			"text": "How much money the player has."
		},
		{
			"eventType": "variable",
			"name": "Money",
			"type": "number",
			"initialValue": "500",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 904927286669553
		},
		{
			"eventType": "comment",
			"text": "Which tower type the player bought and will be placed next."
		},
		{
			"eventType": "variable",
			"name": "NextTowerType",
			"type": "number",
			"initialValue": "-1",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 126563894404446
		},
		{
			"eventType": "comment",
			"text": "How many enemies were defeated in combat."
		},
		{
			"eventType": "variable",
			"name": "DefeatedEnemies",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 796168516580299
		},
		{
			"eventType": "comment",
			"text": "Setup the game by refreshing the UI elements and starting the spawn timer."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-start-of-layout",
					"objectClass": "System",
					"sid": 161472830673614
				}
			],
			"actions": [
				{
					"callFunction": "RefreshUI",
					"sid": 482149148286358
				},
				{
					"id": "start-timer",
					"objectClass": "GameManager",
					"sid": 450131784045621,
					"behaviorType": "Timer",
					"parameters": {
						"duration": "7",
						"type": "once",
						"tag": "\"Spawn\""
					}
				}
			],
			"sid": 132447019664360,
			"children": [
				{
					"eventType": "comment",
					"text": "Wait a few seconds before destroying the instructions text, so the player has enough time to read it."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "pick-by-comparison",
							"objectClass": "System",
							"sid": 877371176367881,
							"parameters": {
								"object": "Text",
								"expression": "Text.ID",
								"comparison": 0,
								"value": "\"Instructions\""
							}
						}
					],
					"actions": [
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 647133584460107,
							"parameters": {
								"seconds": "7"
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "Text",
							"sid": 141100448414207,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"SelfDestroy\"",
								"property": "offsetX",
								"end-value": "-188",
								"time": "1.5",
								"ease": "easeinsine",
								"destroy-on-complete": "yes",
								"loop": "no",
								"ping-pong": "no"
							}
						}
					],
					"sid": 568882331281354
				}
			]
		},
		{
			"eventType": "comment",
			"text": "Once the spawn timer is over, restart it and spawn a new enemy."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-timer",
					"objectClass": "GameManager",
					"sid": 995031429841683,
					"behaviorType": "Timer",
					"parameters": {
						"tag": "\"Spawn\""
					}
				}
			],
			"actions": [
				{
					"id": "start-timer",
					"objectClass": "GameManager",
					"sid": 121920929071230,
					"behaviorType": "Timer",
					"parameters": {
						"duration": "SpawnTime",
						"type": "once",
						"tag": "\"Spawn\""
					}
				},
				{
					"type": "comment",
					"text": "Slightly reduce the spawn time, while also increasing the difficulty multiplier, making the game harder over time."
				},
				{
					"id": "set-eventvar-value",
					"objectClass": "System",
					"sid": 259342181651845,
					"parameters": {
						"variable": "SpawnTime",
						"value": "clamp(SpawnTime - 0.0025, 0.25, Infinity)"
					}
				},
				{
					"id": "set-eventvar-value",
					"objectClass": "System",
					"sid": 962414084847506,
					"parameters": {
						"variable": "DificultyMultiplier",
						"value": "DificultyMultiplier + 0.005"
					}
				},
				{
					"type": "comment",
					"text": "Spawn a new enemy."
				},
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 243798266241598,
					"parameters": {
						"object-to-create": "Enemy",
						"layer": "\"World\"",
						"x": "EnemySpawner.X",
						"y": "EnemySpawner.Y",
						"create-hierarchy": false
					}
				},
				{
					"type": "comment",
					"text": "Choose a random enemy type between skeleton and goblin."
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Enemy",
					"sid": 289798328627680,
					"parameters": {
						"instance-variable": "EnemyType",
						"value": "choose(\"Skeleton\", \"Goblin\")"
					}
				}
			],
			"sid": 392972820317584,
			"children": [
				{
					"eventType": "comment",
					"text": "If the enemy type is set to skeleton, adjust the enemy properties to match the skeleton standards."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 162447744002938,
							"parameters": {
								"value": "Enemy.EnemyType = \"Skeleton\""
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Enemy",
							"sid": 196128657135300,
							"parameters": {
								"instance-variable": "HeathPoints",
								"value": "5 * DificultyMultiplier"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Enemy",
							"sid": 259069977806652,
							"parameters": {
								"instance-variable": "MovementSpeed",
								"value": "0.75 * DificultyMultiplier"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Enemy",
							"sid": 715510819615970,
							"parameters": {
								"instance-variable": "MonetaryValue",
								"value": "ceil(10 * DificultyMultiplier)"
							}
						}
					],
					"sid": 161259633942732
				},
				{
					"eventType": "comment",
					"text": "However, if the enemy type is set to goblin, adjust the enemy properties to match the goblin standards."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 116372873331554
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 126569659974490,
							"parameters": {
								"value": "Enemy.EnemyType = \"Goblin\""
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Enemy",
							"sid": 172345430442600,
							"parameters": {
								"instance-variable": "HeathPoints",
								"value": "10 * DificultyMultiplier"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Enemy",
							"sid": 333208415435488,
							"parameters": {
								"instance-variable": "MovementSpeed",
								"value": "0.5 * DificultyMultiplier"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Enemy",
							"sid": 644979234746784,
							"parameters": {
								"instance-variable": "MonetaryValue",
								"value": "ceil(15 * DificultyMultiplier)"
							}
						}
					],
					"sid": 109505274893644
				}
			]
		},
		{
			"eventType": "comment",
			"text": "Once the cooldown timer of a tower is over, recharge it, allowing it shoot again."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-timer",
					"objectClass": "Tower",
					"sid": 740048039768280,
					"behaviorType": "Timer",
					"parameters": {
						"tag": "\"Cooldown\""
					}
				},
				{
					"id": "for-each",
					"objectClass": "System",
					"sid": 823040173021347,
					"parameters": {
						"object": "Tower"
					}
				}
			],
			"actions": [
				{
					"id": "set-boolean-instvar",
					"objectClass": "Tower",
					"sid": 601873200765038,
					"parameters": {
						"instance-variable": "Charged",
						"value": "true"
					}
				}
			],
			"sid": 831149462296803
		},
		{
			"eventType": "comment",
			"text": "Constantly move all enemies forward, while also updating their animations to match the movement direction."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "for-each",
					"objectClass": "System",
					"sid": 934638403159599,
					"parameters": {
						"object": "Enemy"
					}
				}
			],
			"actions": [],
			"sid": 651347729431005,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "pick-by-comparison",
							"objectClass": "System",
							"sid": 160778099491450,
							"parameters": {
								"object": "Path",
								"expression": "Path.Index",
								"comparison": 0,
								"value": "Enemy.TargetIndex"
							}
						}
					],
					"actions": [
						{
							"id": "move-at-angle",
							"objectClass": "Enemy",
							"sid": 763874899572914,
							"parameters": {
								"angle": "angle(Enemy.X, Enemy.Y, Path.X, Path.Y)",
								"distance": "clamp(Self.MovementSpeed * 60 * dt, 0, distance(Enemy.X, Enemy.Y, Path.X, Path.Y))"
							}
						},
						{
							"id": "set-animation",
							"objectClass": "Enemy",
							"sid": 808749851729332,
							"parameters": {
								"animation": "Self.EnemyType&round(((angle(Enemy.X, Enemy.Y, Path.X, Path.Y) + 360) % 360) / 90) * 90",
								"from": "beginning"
							}
						}
					],
					"sid": 558136870830714,
					"children": [
						{
							"eventType": "comment",
							"text": "If an enemy reaches a target, increase the target index, making them move to the next one in line."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 129529707858990,
									"parameters": {
										"value": "Enemy.X = Path.X & Enemy.Y = Path.Y"
									}
								}
							],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "Enemy",
									"sid": 611651626381053,
									"parameters": {
										"instance-variable": "TargetIndex",
										"value": "Self.TargetIndex + 1"
									}
								}
							],
							"sid": 173112623983030
						}
					]
				}
			]
		},
		{
			"eventType": "comment",
			"text": "If a tower is charged and close enough to an enemy, shoot towards it."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "for-each",
					"objectClass": "System",
					"sid": 363284608864545,
					"parameters": {
						"object": "Tower"
					}
				}
			],
			"actions": [],
			"sid": 921442715163022,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "pick-nearestfurthest",
							"objectClass": "Enemy",
							"sid": 728611001282734,
							"parameters": {
								"which": "nearest",
								"x": "Tower.X",
								"y": "Tower.Y"
							}
						}
					],
					"actions": [],
					"sid": 557187611580306,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 501910983368015,
									"parameters": {
										"value": "Tower.Charged = 1 & distance(Tower.X, Tower.Y, Enemy.X, Enemy.Y) <= Tower.SightRange"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Start a cooldown, so the tower doesn't shoot constantly."
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "Tower",
									"sid": 404456892350556,
									"parameters": {
										"instance-variable": "Charged",
										"value": "false"
									}
								},
								{
									"id": "start-timer",
									"objectClass": "Tower",
									"sid": 882637479241841,
									"behaviorType": "Timer",
									"parameters": {
										"duration": "Self.CooldownTimer",
										"type": "once",
										"tag": "\"Cooldown\""
									}
								},
								{
									"type": "comment",
									"text": "Also restart the tower animation."
								},
								{
									"id": "start-animation",
									"objectClass": "Tower",
									"sid": 694099550328132,
									"parameters": {
										"from": "beginning"
									}
								}
							],
							"sid": 498017458633758,
							"children": [
								{
									"eventType": "comment",
									"text": "If the tower is a type 0 or 2, simply load the tower properties into the projectile."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "evaluate-expression",
											"objectClass": "System",
											"sid": 514810769303314,
											"parameters": {
												"value": "Tower.TowerType = 0 | Tower.TowerType = 2"
											}
										}
									],
									"actions": [
										{
											"id": "create-object",
											"objectClass": "System",
											"sid": 916224973916105,
											"parameters": {
												"object-to-create": "Projectile",
												"layer": "\"Towers\"",
												"x": "Tower.ImagePointX(\"GunTip\")",
												"y": "Tower.ImagePointY(\"GunTip\")",
												"create-hierarchy": false
											}
										},
										{
											"id": "set-angle-of-motion",
											"objectClass": "Projectile",
											"sid": 842915258759946,
											"behaviorType": "Bullet",
											"parameters": {
												"angle": "angle(Self.X, Self.Y, Enemy.X, Enemy.Y)"
											}
										},
										{
											"id": "set-instvar-value",
											"objectClass": "Projectile",
											"sid": 425033061318803,
											"parameters": {
												"instance-variable": "Damage",
												"value": "Tower.ProjectileDamage"
											}
										},
										{
											"id": "set-instvar-value",
											"objectClass": "Projectile",
											"sid": 180189405976192,
											"parameters": {
												"instance-variable": "Piercing",
												"value": "Tower.PiercingRounds"
											}
										},
										{
											"id": "set-instvar-value",
											"objectClass": "Projectile",
											"sid": 357528144521634,
											"parameters": {
												"instance-variable": "MaxDistance",
												"value": "Tower.SightRange"
											}
										}
									],
									"sid": 868727264050996
								},
								{
									"eventType": "comment",
									"text": "However, if the tower is a type 1, shoot multiple projectiles in 8 directions."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 426347982181075
										},
										{
											"id": "evaluate-expression",
											"objectClass": "System",
											"sid": 898149635359731,
											"parameters": {
												"value": "Tower.TowerType = 1"
											}
										}
									],
									"actions": [],
									"sid": 875573015223799,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "repeat",
													"objectClass": "System",
													"sid": 344790604599669,
													"parameters": {
														"count": "8"
													}
												}
											],
											"actions": [
												{
													"id": "create-object",
													"objectClass": "System",
													"sid": 127174811150583,
													"parameters": {
														"object-to-create": "Projectile",
														"layer": "\"Towers\"",
														"x": "Tower.ImagePointX(\"GunTip\")",
														"y": "Tower.ImagePointY(\"GunTip\")",
														"create-hierarchy": false
													}
												},
												{
													"id": "set-angle-of-motion",
													"objectClass": "Projectile",
													"sid": 840922070065776,
													"behaviorType": "Bullet",
													"parameters": {
														"angle": "45 * loopindex"
													}
												},
												{
													"id": "set-instvar-value",
													"objectClass": "Projectile",
													"sid": 581412970875394,
													"parameters": {
														"instance-variable": "Damage",
														"value": "Tower.ProjectileDamage"
													}
												},
												{
													"id": "set-instvar-value",
													"objectClass": "Projectile",
													"sid": 944678059275656,
													"parameters": {
														"instance-variable": "Piercing",
														"value": "Tower.PiercingRounds"
													}
												},
												{
													"id": "set-instvar-value",
													"objectClass": "Projectile",
													"sid": 965656225798418,
													"parameters": {
														"instance-variable": "MaxDistance",
														"value": "Tower.SightRange"
													}
												}
											],
											"sid": 708186919257856
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"eventType": "comment",
			"text": "If a projectile surpasses its max distance value, stop and destroy it with a tween animation."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "compare-distance-travelled",
					"objectClass": "Projectile",
					"sid": 399033025160152,
					"behaviorType": "Bullet",
					"parameters": {
						"comparison": 5,
						"distance": "Self.MaxDistance"
					}
				},
				{
					"id": "for-each",
					"objectClass": "System",
					"sid": 201267948253749,
					"parameters": {
						"object": "Projectile"
					}
				}
			],
			"actions": [],
			"sid": 647090120706153,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-enabled",
							"objectClass": "Projectile",
							"sid": 653552932783380,
							"behaviorType": "Bullet"
						}
					],
					"actions": [
						{
							"id": "set-enabled",
							"objectClass": "Projectile",
							"sid": 621933000340452,
							"behaviorType": "Bullet",
							"parameters": {
								"state": "disabled"
							}
						},
						{
							"id": "set-collisions-enabled",
							"objectClass": "Projectile",
							"sid": 249558097717497,
							"parameters": {
								"collisions": "disabled"
							}
						},
						{
							"id": "tween-two-properties",
							"objectClass": "Projectile",
							"sid": 163393045131312,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"SelfDestroy\"",
								"property": "size",
								"end-x": "0",
								"end-y": "0",
								"time": "0.5",
								"ease": "noease",
								"destroy-on-complete": "yes",
								"loop": "no",
								"ping-pong": "no"
							}
						}
					],
					"sid": 618163745075063
				}
			]
		},
		{
			"eventType": "comment",
			"text": "If the player touches a tower thumbnail, check if it's able to buy it."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-touched-object",
					"objectClass": "Touch",
					"sid": 406333870905664,
					"parameters": {
						"object": "TowerThumbnail"
					}
				}
			],
			"actions": [],
			"sid": 476283674298687,
			"children": [
				{
					"eventType": "comment",
					"text": "The player need to have enough money to buy the tower and enough free building spots to place it in the map."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 369851350492431,
							"parameters": {
								"value": "NextTowerType = -1 & Money >= TowerThumbnail.TowerPrice & Functions.FreeBuildingSpots >= 1"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Move the cursor on top of the thumbnail."
						},
						{
							"id": "set-y",
							"objectClass": "Cursor",
							"sid": 848512586695915,
							"parameters": {
								"y": "TowerThumbnail.Y"
							}
						},
						{
							"type": "comment",
							"text": "Update the variables and refresh the UI to match them."
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 337741010958055,
							"parameters": {
								"variable": "Money",
								"value": "Money - TowerThumbnail.TowerPrice"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 343897370123782,
							"parameters": {
								"variable": "NextTowerType",
								"value": "TowerThumbnail.TowerType"
							}
						},
						{
							"callFunction": "RefreshUI",
							"sid": 848727990918610
						}
					],
					"sid": 639405976019716,
					"children": [
						{
							"eventType": "comment",
							"text": "Make all tower thumbnail black and white, so the player don't try to buy any other tower before placing the current one."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-all",
									"objectClass": "System",
									"sid": 186554501321114,
									"parameters": {
										"object": "TowerThumbnail"
									}
								}
							],
							"actions": [
								{
									"id": "set-effect-parameter",
									"objectClass": "TowerThumbnail",
									"sid": 437015752831625,
									"parameters": {
										"effect": "\"AdjustHSL\"",
										"parameter-index": "1",
										"value": "0"
									}
								}
							],
							"sid": 590998127031473
						},
						{
							"eventType": "comment",
							"text": "Display all free building spots in the map. by making them visible."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-by-comparison",
									"objectClass": "System",
									"sid": 336667417595839,
									"parameters": {
										"object": "BuildingSpot",
										"expression": "BuildingSpot.IsOccupied",
										"comparison": 0,
										"value": "0"
									}
								}
							],
							"actions": [
								{
									"id": "set-visible",
									"objectClass": "BuildingSpot",
									"sid": 684068918840564,
									"parameters": {
										"visibility": "visible"
									}
								}
							],
							"sid": 642367496892424
						}
					]
				}
			]
		},
		{
			"eventType": "comment",
			"text": "If the player touches a building spot, check if it has a tower to place on top of it."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-touched-object",
					"objectClass": "Touch",
					"sid": 386311700756399,
					"parameters": {
						"object": "BuildingSpot"
					}
				}
			],
			"actions": [],
			"sid": 487395363891385,
			"children": [
				{
					"eventType": "comment",
					"text": "The spot needs to be free and the player needs to have bought a tower."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 654598448593228,
							"parameters": {
								"value": "BuildingSpot.IsOccupied = 0 & NextTowerType <> -1"
							}
						}
					],
					"actions": [
						{
							"id": "set-boolean-instvar",
							"objectClass": "BuildingSpot",
							"sid": 513329834964429,
							"parameters": {
								"instance-variable": "IsOccupied",
								"value": "true"
							}
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 325332213261823,
							"parameters": {
								"object-to-create": "Tower",
								"layer": "\"Towers\"",
								"x": "BuildingSpot.X",
								"y": "BuildingSpot.Y",
								"create-hierarchy": false
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Tower",
							"sid": 773035779808840,
							"parameters": {
								"instance-variable": "TowerType",
								"value": "NextTowerType"
							}
						},
						{
							"id": "set-animation",
							"objectClass": "Tower",
							"sid": 206741724963022,
							"parameters": {
								"animation": "\"Tower\"&Self.TowerType",
								"from": "beginning"
							}
						},
						{
							"id": "set-animation-frame",
							"objectClass": "Tower",
							"sid": 959507400960220,
							"parameters": {
								"frame-number": "Self.AnimationFrameCount - 1"
							}
						},
						{
							"id": "set-width",
							"objectClass": "Tower",
							"sid": 287551210131124,
							"parameters": {
								"width": "0"
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "Tower",
							"sid": 987061251010316,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"\"",
								"property": "offsetWidth",
								"end-value": "Self.ImageWidth",
								"time": "0.25",
								"ease": "easeoutback",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no"
							}
						},
						{
							"id": "add-child",
							"objectClass": "BuildingSpot",
							"sid": 583591928597378,
							"parameters": {
								"child": "Tower",
								"transform-x": true,
								"transform-y": true,
								"transform-w": false,
								"transform-h": false,
								"transform-a": false,
								"transform-z-elevation": false,
								"destroy-with-parent": true
							}
						}
					],
					"sid": 207469140374716,
					"children": [
						{
							"eventType": "comment",
							"text": "Adjust the settings for a type 0 tower."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 450119197518443,
									"parameters": {
										"value": "NextTowerType = 0"
									}
								}
							],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 206358043814968,
									"parameters": {
										"instance-variable": "CooldownTimer",
										"value": "0.5"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 619035679169082,
									"parameters": {
										"instance-variable": "SightRange",
										"value": "48"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 728010663389923,
									"parameters": {
										"instance-variable": "ProjectileDamage",
										"value": "1"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 985391330147957,
									"parameters": {
										"instance-variable": "SellingPrice",
										"value": "100 * 0.8"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 224815137910399,
									"parameters": {
										"instance-variable": "PiercingRounds",
										"value": "0"
									}
								}
							],
							"sid": 358504965997349
						},
						{
							"eventType": "comment",
							"text": "Adjust the settings for a type 1 tower."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 734481092958610
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 527823435808176,
									"parameters": {
										"value": "NextTowerType = 1"
									}
								}
							],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 138598782726497,
									"parameters": {
										"instance-variable": "CooldownTimer",
										"value": "0.75"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 974934397878928,
									"parameters": {
										"instance-variable": "SightRange",
										"value": "32"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 194655484376497,
									"parameters": {
										"instance-variable": "ProjectileDamage",
										"value": "1"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 666637867197180,
									"parameters": {
										"instance-variable": "SellingPrice",
										"value": "600 * 0.8"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 712189781468271,
									"parameters": {
										"instance-variable": "PiercingRounds",
										"value": "0"
									}
								}
							],
							"sid": 473490635516332
						},
						{
							"eventType": "comment",
							"text": "Adjust the settings for a type 2 tower."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 356913601979554
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 855018925672069,
									"parameters": {
										"value": "NextTowerType = 2"
									}
								}
							],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 331329863542213,
									"parameters": {
										"instance-variable": "CooldownTimer",
										"value": "1"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 498906860506418,
									"parameters": {
										"instance-variable": "SightRange",
										"value": "80"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 168045574241191,
									"parameters": {
										"instance-variable": "ProjectileDamage",
										"value": "2"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 464583107781295,
									"parameters": {
										"instance-variable": "SellingPrice",
										"value": "250 * 0.8"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Tower",
									"sid": 818576162091494,
									"parameters": {
										"instance-variable": "PiercingRounds",
										"value": "1"
									}
								}
							],
							"sid": 601280794923597
						},
						{
							"eventType": "comment",
							"text": "Hide the cursor, by moving it outside of the screen."
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "set-y",
									"objectClass": "Cursor",
									"sid": 887274668107147,
									"parameters": {
										"y": "-20"
									}
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 282193742832683,
									"parameters": {
										"variable": "NextTowerType",
										"value": "-1"
									}
								}
							],
							"sid": 944013709983873
						},
						{
							"eventType": "comment",
							"text": "Make all building spots invisible again."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-all",
									"objectClass": "System",
									"sid": 166102331642331,
									"parameters": {
										"object": "BuildingSpot"
									}
								}
							],
							"actions": [
								{
									"id": "set-visible",
									"objectClass": "BuildingSpot",
									"sid": 943292652318091,
									"parameters": {
										"visibility": "invisible"
									}
								}
							],
							"sid": 183873292955564
						},
						{
							"eventType": "comment",
							"text": "Make all tower thumbnail colored again."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-all",
									"objectClass": "System",
									"sid": 778660830601390,
									"parameters": {
										"object": "TowerThumbnail"
									}
								}
							],
							"actions": [
								{
									"id": "set-effect-parameter",
									"objectClass": "TowerThumbnail",
									"sid": 946686990206654,
									"parameters": {
										"effect": "\"AdjustHSL\"",
										"parameter-index": "1",
										"value": "100"
									}
								}
							],
							"sid": 631668797147511
						}
					]
				},
				{
					"eventType": "comment",
					"text": "However, if the player doesn't have a tower to build, sell the touched tower and free the spot below it."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 682828456691192
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 178056737175155,
							"parameters": {
								"value": "NextTowerType = -1"
							}
						}
					],
					"actions": [],
					"sid": 340011351651296,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-children",
									"objectClass": "BuildingSpot",
									"sid": 864788298137134,
									"parameters": {
										"child": "Tower",
										"which": "own"
									}
								}
							],
							"actions": [
								{
									"id": "set-boolean-instvar",
									"objectClass": "BuildingSpot",
									"sid": 642809447915956,
									"parameters": {
										"instance-variable": "IsOccupied",
										"value": "false"
									}
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 946324139360654,
									"parameters": {
										"variable": "Money",
										"value": "Money + Tower.SellingPrice"
									}
								},
								{
									"id": "destroy",
									"objectClass": "Tower",
									"sid": 717472763901011
								},
								{
									"type": "comment",
									"text": "Also refresh the UI to match the new money value."
								},
								{
									"callFunction": "RefreshUI",
									"sid": 810317853301635
								}
							],
							"sid": 472478138456767
						}
					]
				}
			]
		},
		{
			"eventType": "comment",
			"text": "If a projectile collides with an enemy, reduce the enemy's heath and play a flash animation, indicating it has been damaged."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-collision-with-another-object",
					"objectClass": "Projectile",
					"sid": 198164568012743,
					"parameters": {
						"object": "Enemy"
					}
				}
			],
			"actions": [
				{
					"id": "set-instvar-value",
					"objectClass": "Enemy",
					"sid": 820293215875744,
					"parameters": {
						"instance-variable": "HeathPoints",
						"value": "clamp(Self.HeathPoints - Projectile.Damage, 0, Infinity)"
					}
				},
				{
					"id": "tween-value",
					"objectClass": "Enemy",
					"sid": 149939474547443,
					"behaviorType": "Tween",
					"parameters": {
						"tags": "\"Flash\"",
						"start-value": "150",
						"end-value": "100",
						"time": "0.25",
						"ease": "noease",
						"destroy-on-complete": "no",
						"loop": "no",
						"ping-pong": "no"
					}
				}
			],
			"sid": 989288682081047,
			"children": [
				{
					"eventType": "comment",
					"text": "If the projectile isn't piercing, destroy it."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 511429652861421,
							"parameters": {
								"value": "Projectile.Piercing = 0"
							}
						}
					],
					"actions": [
						{
							"id": "destroy",
							"objectClass": "Projectile",
							"sid": 644649918408693
						}
					],
					"sid": 991114621374706
				},
				{
					"eventType": "comment",
					"text": "If the enemy's heath reaches zero after the attack, reward the player with money, increase the amount of defeated enemies and destroy the enemy."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 273101971252181,
							"parameters": {
								"value": "Enemy.HeathPoints = 0"
							}
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 340100280912364,
							"parameters": {
								"variable": "Money",
								"value": "Money + Enemy.MonetaryValue"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 679322762264514,
							"parameters": {
								"variable": "DefeatedEnemies",
								"value": "DefeatedEnemies + 1"
							}
						},
						{
							"callFunction": "RefreshUI",
							"sid": 153375085502867
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 349333557827665,
							"parameters": {
								"object-to-create": "Explosion",
								"layer": "\"Towers\"",
								"x": "Enemy.X",
								"y": "Enemy.Y",
								"create-hierarchy": false
							}
						},
						{
							"id": "destroy",
							"objectClass": "Enemy",
							"sid": 805769380595799
						}
					],
					"sid": 862511772097587
				}
			]
		},
		{
			"eventType": "comment",
			"text": "Constantly update the HSL effect on an enemy if it's playing a flash animation."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "is-playing",
					"objectClass": "Enemy",
					"sid": 898462382799751,
					"behaviorType": "Tween",
					"parameters": {
						"tags": "\"Flash\""
					}
				}
			],
			"actions": [
				{
					"id": "set-effect-parameter",
					"objectClass": "Enemy",
					"sid": 673296766306589,
					"parameters": {
						"effect": "\"AdjustHSL\"",
						"parameter-index": "2",
						"value": "Self.Tween.Value(\"Flash\")"
					}
				}
			],
			"sid": 893393720457485
		},
		{
			"eventType": "comment",
			"text": "Once an explosion has finished its animation, destroy it, so it doesn't keep consuming memory in the layout."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-animation-finished",
					"objectClass": "Explosion",
					"sid": 807440058593527,
					"parameters": {
						"animation": "\"Default\""
					}
				}
			],
			"actions": [
				{
					"id": "destroy",
					"objectClass": "Explosion",
					"sid": 641091418363106
				}
			],
			"sid": 450668831351872
		},
		{
			"eventType": "comment",
			"text": "If an enemy collides with the player base, reduce the player base heath and destroy the enemy."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-collision-with-another-object",
					"objectClass": "Enemy",
					"sid": 833038579872688,
					"parameters": {
						"object": "PlayerBase"
					}
				}
			],
			"actions": [
				{
					"id": "set-instvar-value",
					"objectClass": "PlayerBase",
					"sid": 829242965131639,
					"parameters": {
						"instance-variable": "HeathPoints",
						"value": "clamp(Self.HeathPoints - 1, 0, Infinity)"
					}
				},
				{
					"callFunction": "RefreshUI",
					"sid": 134072429863478
				},
				{
					"id": "destroy",
					"objectClass": "Enemy",
					"sid": 950104237644763
				}
			],
			"sid": 220360625752294,
			"children": [
				{
					"eventType": "comment",
					"text": "If the the player base reaches zero after the attack, reset the game completely."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 561586971629649,
							"parameters": {
								"value": "PlayerBase.HeathPoints = 0"
							}
						}
					],
					"actions": [
						{
							"id": "reset-global-variables",
							"objectClass": "System",
							"sid": 636674961782592
						},
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 665265386478152
						}
					],
					"sid": 335886660443809
				}
			]
		},
		{
			"eventType": "comment",
			"text": "Constantly update the Z order of all enemies and towers, so they always look properly aligned."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "every-tick",
					"objectClass": "System",
					"sid": 821987526662439
				}
			],
			"actions": [
				{
					"type": "comment",
					"text": "Sort enemy Z order."
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Enemy",
					"sid": 145422233384979,
					"parameters": {
						"instance-variable": "ZOrder",
						"value": "Self.Y"
					}
				},
				{
					"id": "sort-z-order",
					"objectClass": "System",
					"sid": 419465429952514,
					"parameters": {
						"object": "Enemy",
						"instance-variable": {
							"name": "ZOrder",
							"objectClass": "Enemy"
						}
					}
				},
				{
					"type": "comment",
					"text": "Sort tower Z order."
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Tower",
					"sid": 945256439240645,
					"parameters": {
						"instance-variable": "ZOrder",
						"value": "Self.Y"
					}
				},
				{
					"id": "sort-z-order",
					"objectClass": "System",
					"sid": 669533245036314,
					"parameters": {
						"object": "Tower",
						"instance-variable": {
							"name": "ZOrder",
							"objectClass": "Tower"
						}
					}
				}
			],
			"sid": 744007101233205
		},
		{
			"eventType": "comment",
			"text": "Update the look of each UI element in the game, so they match the internal variables."
		},
		{
			"functionName": "RefreshUI",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Update the heath bar width."
				},
				{
					"id": "set-width",
					"objectClass": "Hearts",
					"sid": 828293428152915,
					"parameters": {
						"width": "8 * PlayerBase.HeathPoints"
					}
				}
			],
			"sid": 524532786947915,
			"children": [
				{
					"eventType": "comment",
					"text": "Update the amount of money."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "pick-by-comparison",
							"objectClass": "System",
							"sid": 334238640736451,
							"parameters": {
								"object": "Text",
								"expression": "Text.ID",
								"comparison": 0,
								"value": "\"Money\""
							}
						}
					],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "Text",
							"sid": 933924164208312,
							"parameters": {
								"text": "\"$\"&Money"
							}
						}
					],
					"sid": 243651965981868
				},
				{
					"eventType": "comment",
					"text": "Update the amount of defeated enemies."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "pick-by-comparison",
							"objectClass": "System",
							"sid": 838897408845362,
							"parameters": {
								"object": "Text",
								"expression": "Text.ID",
								"comparison": 0,
								"value": "\"Counter\""
							}
						}
					],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "Text",
							"sid": 303146025722626,
							"parameters": {
								"text": "\"Score: \"&zeropad(DefeatedEnemies, 5)"
							}
						}
					],
					"sid": 798438620417378
				}
			]
		},
		{
			"eventType": "comment",
			"text": "Round a number and make it multiple of another number."
		},
		{
			"functionName": "MakeMultipleOf",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "number",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "RoundNumber",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 102418758172171
				},
				{
					"name": "MultipleOf",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 833216537846034
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-function-return-value",
					"objectClass": "Functions",
					"sid": 119808321870048,
					"parameters": {
						"value": "round(Functions.ConvertAngle(RoundNumber) / MultipleOf) * MultipleOf"
					}
				}
			],
			"sid": 998962782725880
		},
		{
			"eventType": "comment",
			"text": "Convert an angle from runtime standards (-180 to 180) to editor standards (0 to 360)."
		},
		{
			"functionName": "ConvertAngle",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "number",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "AngleToConvert",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 599142348584806
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "set-function-return-value",
					"objectClass": "Functions",
					"sid": 593940790144635,
					"parameters": {
						"value": "(AngleToConvert + 360) % 360"
					}
				}
			],
			"sid": 979007612776016
		},
		{
			"eventType": "comment",
			"text": "Count how many building spots are free."
		},
		{
			"functionName": "FreeBuildingSpots",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "number",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [
				{
					"id": "pick-by-comparison",
					"objectClass": "System",
					"sid": 753251128086831,
					"parameters": {
						"object": "BuildingSpot",
						"expression": "BuildingSpot.IsOccupied",
						"comparison": 0,
						"value": "0"
					}
				}
			],
			"actions": [
				{
					"id": "set-function-return-value",
					"objectClass": "Functions",
					"sid": 842833487343771,
					"parameters": {
						"value": "BuildingSpot.PickedCount"
					}
				}
			],
			"sid": 715839339879356
		},
		{
			"eventType": "comment",
			"text": "Restart the game for testing purposes only."
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-key-pressed",
					"objectClass": "Keyboard",
					"sid": 112285712708932,
					"parameters": {
						"key": 82
					}
				}
			],
			"actions": [
				{
					"id": "reset-global-variables",
					"objectClass": "System",
					"sid": 238026734923498
				},
				{
					"id": "restart-layout",
					"objectClass": "System",
					"sid": 918347129750698
				}
			],
			"sid": 257947917112063
		}
	],
	"sid": 763710247436322
}