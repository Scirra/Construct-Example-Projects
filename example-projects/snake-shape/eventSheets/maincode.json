{
	"name": "MainCode",
	"events": [
		{
			"eventType": "comment",
			"text": "Made by Viridino Studios (@ViridinoStudios)\n\nMateus Ferreira - Programmer\nTwitter: @BonzerKitten\nE-mail: ferreiramoreiramateus@gmail.com\n\nWesley Andrade - Artist\nTwitter: @andrart7\nE-mail: wesleymatos1989@gmail.com\n\nMade with the support of patrons on https://www.patreon.com/viridinostudios"
		},
		{
			"eventType": "comment",
			"text": "Project settings."
		},
		{
			"eventType": "variable",
			"name": "TARGETFRAMERATE",
			"type": "number",
			"initialValue": "60",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 894623938936660
		},
		{
			"eventType": "variable",
			"name": "DEFAULTLAYOUTSCALE",
			"type": "number",
			"initialValue": "1",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 494857002453059
		},
		{
			"eventType": "comment",
			"text": "How long it takes for the snake to move to the next position."
		},
		{
			"eventType": "variable",
			"name": "SNAKEMOVEMENTDURATION",
			"type": "number",
			"initialValue": "0.1",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 880941258516303
		},
		{
			"eventType": "comment",
			"text": "How long it takes for the snake to fall."
		},
		{
			"eventType": "variable",
			"name": "SNAKEFALLDURATION",
			"type": "number",
			"initialValue": "0.1",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 212524876247355
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Camera",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Adjust both Scroll X and Scroll Y to match the player position."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 550248479068991
						}
					],
					"actions": [
						{
							"id": "scroll-to-y",
							"objectClass": "System",
							"sid": 500588556703859,
							"parameters": {
								"y": "LayoutHeight / 2"
							}
						}
					],
					"sid": 917215441096627,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-by-comparison",
									"objectClass": "System",
									"sid": 435049468055752,
									"parameters": {
										"object": "PlayerSegment",
										"expression": "PlayerSegment.ScrollTo",
										"comparison": 0,
										"value": "1"
									}
								}
							],
							"actions": [
								{
									"id": "scroll-to-x",
									"objectClass": "System",
									"sid": 714466153294871,
									"parameters": {
										"x": "PlayerSegment.X"
									}
								}
							],
							"sid": 437463501910684
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Update only the Scroll X to match the player position, so it becomes a horizontal scrolling game."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 805607858916227
						}
					],
					"actions": [],
					"sid": 810323658653166,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-by-comparison",
									"objectClass": "System",
									"sid": 603687116136821,
									"parameters": {
										"object": "PlayerSegment",
										"expression": "PlayerSegment.ScrollTo",
										"comparison": 0,
										"value": "1"
									}
								}
							],
							"actions": [
								{
									"id": "scroll-to-x",
									"objectClass": "System",
									"sid": 323426017852192,
									"parameters": {
										"x": "lerp(scrollx, PlayerSegment.X, 0.1)"
									}
								}
							],
							"sid": 809559589928599
						}
					]
				}
			],
			"sid": 521821433694553
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "GroundCollision",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Spawn ground collision objects whenever there's a ground tile."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 925543812275026
						}
					],
					"actions": [],
					"sid": 561333325599939,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 779012092423513,
									"parameters": {
										"name": "\"Y\"",
										"start-index": "0",
										"end-index": "39"
									}
								}
							],
							"actions": [],
							"sid": 345787167243426,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for",
											"objectClass": "System",
											"sid": 534351737683133,
											"parameters": {
												"name": "\"X\"",
												"start-index": "0",
												"end-index": "39"
											}
										}
									],
									"actions": [],
									"sid": 218870843374857,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-tile-at",
													"objectClass": "Ground",
													"sid": 458812922348733,
													"parameters": {
														"tile-x": "loopindex(\"X\")",
														"tile-y": "loopindex(\"Y\")",
														"comparison": 1,
														"tile": "-1"
													}
												}
											],
											"actions": [
												{
													"id": "create-object",
													"objectClass": "System",
													"sid": 312404180247533,
													"parameters": {
														"object-to-create": "GroundCollision",
														"layer": "\"World\"",
														"x": "Ground.TileToPositionX(loopindex(\"X\"))",
														"y": "Ground.TileToPositionY(loopindex(\"Y\"))",
														"create-hierarchy": false
													}
												}
											],
											"sid": 964125741267049
										}
									]
								}
							]
						}
					]
				}
			],
			"sid": 359127205630052
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "ScrollingBackground",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "variable",
					"name": "HORIZONTALSPEED",
					"type": "number",
					"initialValue": "0.1",
					"comment": "",
					"isStatic": true,
					"isConstant": true,
					"sid": 295725849617470
				},
				{
					"eventType": "variable",
					"name": "VERTICALSPEED",
					"type": "number",
					"initialValue": "0.1",
					"comment": "",
					"isStatic": true,
					"isConstant": true,
					"sid": 161118114143665
				},
				{
					"eventType": "comment",
					"text": "Constantly offset the background image."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 421042503822650
						}
					],
					"actions": [
						{
							"id": "set-image-offset-x",
							"objectClass": "Background",
							"sid": 784200028996513,
							"parameters": {
								"offset-x": "Self.ImageOffsetX + HORIZONTALSPEED * TARGETFRAMERATE * dt"
							}
						},
						{
							"id": "set-image-offset-y",
							"objectClass": "Background",
							"sid": 729570821810038,
							"parameters": {
								"offset-y": "Self.ImageOffsetY + VERTICALSPEED * TARGETFRAMERATE * dt"
							}
						}
					],
					"sid": 541061525943059
				}
			],
			"sid": 394766018973985
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Player",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Randomize the player's animation frames to make it more dynamic."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-created",
							"objectClass": "PlayerSegment",
							"sid": 898923753480703
						}
					],
					"actions": [
						{
							"id": "set-animation-frame",
							"objectClass": "PlayerSegment",
							"sid": 460955725965782,
							"parameters": {
								"frame-number": "floor(random(0, Self.AnimationFrameCount))"
							}
						}
					],
					"sid": 355281923523461
				},
				{
					"eventType": "comment",
					"text": "Iterate through all player instances to make sure the last segment has no collision, so the \"head\" replace its position in case it's necessary."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 762144035867086
						}
					],
					"actions": [],
					"sid": 343263957255802,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each-ordered",
									"objectClass": "System",
									"sid": 697204939787326,
									"parameters": {
										"object": "PlayerSegment",
										"expression": "PlayerSegment.SegmentIndex",
										"order": "ascending"
									}
								}
							],
							"actions": [],
							"sid": 441781324117982,
							"children": [
								{
									"eventType": "comment",
									"text": "Disable last segment collision."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-two-values",
											"objectClass": "System",
											"sid": 144404481706394,
											"parameters": {
												"first-value": "PlayerSegment.SegmentIndex",
												"comparison": 0,
												"second-value": "PlayerSegment.Count - 1"
											}
										}
									],
									"actions": [
										{
											"id": "set-collisions-enabled",
											"objectClass": "PlayerSegment",
											"sid": 234683243021485,
											"parameters": {
												"collisions": "disabled"
											}
										}
									],
									"sid": 219041922106750
								},
								{
									"eventType": "comment",
									"text": "Enable collision for the other segments."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 575946377544423
										},
										{
											"id": "compare-two-values",
											"objectClass": "System",
											"sid": 356397198437355,
											"parameters": {
												"first-value": "PlayerSegment.SegmentIndex",
												"comparison": 1,
												"second-value": "PlayerSegment.Count - 1"
											}
										}
									],
									"actions": [
										{
											"id": "set-collisions-enabled",
											"objectClass": "PlayerSegment",
											"sid": 469925716909374,
											"parameters": {
												"collisions": "enabled"
											}
										}
									],
									"sid": 530604859782627
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Initial fall animation."
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"callFunction": "ApplyGravity",
									"sid": 222971580244825
								}
							],
							"sid": 747553616902784
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Prevent the player from moving while already performing other actions."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-timer-running",
							"objectClass": "GameManager",
							"sid": 667072422044890,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"MovingCooldown\""
							},
							"isInverted": true
						},
						{
							"id": "is-timer-running",
							"objectClass": "GameManager",
							"sid": 539554775194860,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"FallingCooldown\""
							},
							"isInverted": true
						},
						{
							"id": "is-timer-running",
							"objectClass": "GameManager",
							"sid": 658573139055381,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"EndingCooldown\""
							},
							"isInverted": true
						}
					],
					"actions": [],
					"sid": 983084295872060,
					"children": [
						{
							"eventType": "comment",
							"text": "Move left (180 degrees)."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-key-pressed",
									"objectClass": "Keyboard",
									"sid": 766835271725874,
									"parameters": {
										"key": 37
									}
								},
								{
									"id": "on-button-pressed",
									"objectClass": "Gamepad",
									"sid": 524333673756527,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-left"
									}
								}
							],
							"actions": [
								{
									"callFunction": "MoveAtAngle",
									"sid": 934080976303664,
									"parameters": [
										"180"
									]
								}
							],
							"sid": 927587660836799,
							"isOrBlock": true
						},
						{
							"eventType": "comment",
							"text": "Move right (0 degrees)."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-key-pressed",
									"objectClass": "Keyboard",
									"sid": 570507846442807,
									"parameters": {
										"key": 39
									}
								},
								{
									"id": "on-button-pressed",
									"objectClass": "Gamepad",
									"sid": 507562350489762,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-right"
									}
								}
							],
							"actions": [
								{
									"callFunction": "MoveAtAngle",
									"sid": 770805843747246,
									"parameters": [
										"0"
									]
								}
							],
							"sid": 925159841086457,
							"isOrBlock": true
						},
						{
							"eventType": "comment",
							"text": "Move up (270 degrees)."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-key-pressed",
									"objectClass": "Keyboard",
									"sid": 368329251603137,
									"parameters": {
										"key": 38
									}
								},
								{
									"id": "on-button-pressed",
									"objectClass": "Gamepad",
									"sid": 244136522095000,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-up"
									}
								}
							],
							"actions": [
								{
									"callFunction": "MoveAtAngle",
									"sid": 142813461461817,
									"parameters": [
										"270"
									]
								}
							],
							"sid": 182519124985638,
							"isOrBlock": true
						},
						{
							"eventType": "comment",
							"text": "Move down (90 degrees)."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-key-pressed",
									"objectClass": "Keyboard",
									"sid": 904840119316353,
									"parameters": {
										"key": 40
									}
								},
								{
									"id": "on-button-pressed",
									"objectClass": "Gamepad",
									"sid": 984640225242677,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-down"
									}
								}
							],
							"actions": [
								{
									"callFunction": "MoveAtAngle",
									"sid": 800251490635079,
									"parameters": [
										"90"
									]
								}
							],
							"sid": 378223739796167,
							"isOrBlock": true
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Move the player at an specific angle."
				},
				{
					"functionName": "MoveAtAngle",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "Direction",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 992955236894713
						}
					],
					"eventType": "function-block",
					"conditions": [],
					"actions": [],
					"sid": 382339357839114,
					"children": [
						{
							"eventType": "comment",
							"text": "Store all snake segments previous positions inside an array."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each-ordered",
									"objectClass": "System",
									"sid": 904105630801452,
									"parameters": {
										"object": "PlayerSegment",
										"expression": "PlayerSegment.SegmentIndex",
										"order": "ascending"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Store X."
								},
								{
									"id": "set-at-xy",
									"objectClass": "PlayerPositions",
									"sid": 703241018654764,
									"parameters": {
										"x": "loopindex",
										"y": "0",
										"value": "PlayerSegment.X"
									}
								},
								{
									"type": "comment",
									"text": "Store Y."
								},
								{
									"id": "set-at-xy",
									"objectClass": "PlayerPositions",
									"sid": 337490007631257,
									"parameters": {
										"x": "loopindex",
										"y": "1",
										"value": "PlayerSegment.Y"
									}
								}
							],
							"sid": 237525543401480
						},
						{
							"eventType": "comment",
							"text": "Pick the \"head\" of the player."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-by-comparison",
									"objectClass": "System",
									"sid": 650327358378795,
									"parameters": {
										"object": "PlayerSegment",
										"expression": "PlayerSegment.SegmentIndex",
										"comparison": 0,
										"value": "0"
									}
								}
							],
							"actions": [],
							"sid": 124358086737823,
							"children": [
								{
									"eventType": "comment",
									"text": "Check if there are no solid object ahead and move towards such position."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-overlapping-at-offset",
											"objectClass": "PlayerSegment",
											"sid": 571006778210526,
											"parameters": {
												"object": "SolidObjects",
												"offset-x": "cos(Direction) * 16",
												"offset-y": "sin(Direction) * 16"
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "tween-two-properties",
											"objectClass": "PlayerSegment",
											"sid": 583585662940929,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"Move\"",
												"property": "position",
												"end-x": "Self.X + cos(Direction) * 16",
												"end-y": "Self.Y + sin(Direction) * 16",
												"time": "SNAKEMOVEMENTDURATION",
												"ease": "easeinsine",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no"
											}
										},
										{
											"id": "start-timer",
											"objectClass": "GameManager",
											"sid": 189201119671144,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "SNAKEMOVEMENTDURATION",
												"type": "once",
												"tag": "\"MovingCooldown\""
											}
										}
									],
									"sid": 303700071511815,
									"children": [
										{
											"eventType": "comment",
											"text": "Reset picking."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "pick-all",
													"objectClass": "System",
													"sid": 914498575151421,
													"parameters": {
														"object": "PlayerSegment"
													}
												}
											],
											"actions": [],
											"sid": 569268265322347,
											"children": [
												{
													"eventType": "comment",
													"text": "Move each player segment to the one that was previously ahead of it, by using an offset version of the array content."
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "for-each-ordered",
															"objectClass": "System",
															"sid": 202409364392577,
															"parameters": {
																"object": "PlayerSegment",
																"expression": "PlayerSegment.SegmentIndex",
																"order": "ascending"
															}
														}
													],
													"actions": [],
													"sid": 262594963994485,
													"children": [
														{
															"eventType": "block",
															"conditions": [
																{
																	"id": "compare-two-values",
																	"objectClass": "System",
																	"sid": 939362165330728,
																	"parameters": {
																		"first-value": "PlayerSegment.SegmentIndex",
																		"comparison": 1,
																		"second-value": "0"
																	}
																}
															],
															"actions": [
																{
																	"id": "tween-two-properties",
																	"objectClass": "PlayerSegment",
																	"sid": 706578912728540,
																	"behaviorType": "Tween",
																	"parameters": {
																		"tags": "\"Move\"",
																		"property": "position",
																		"end-x": "PlayerPositions.At(PlayerSegment.SegmentIndex - 1, 0)",
																		"end-y": "PlayerPositions.At(PlayerSegment.SegmentIndex - 1, 1)",
																		"time": "SNAKEMOVEMENTDURATION",
																		"ease": "easeinsine",
																		"destroy-on-complete": "no",
																		"loop": "no",
																		"ping-pong": "no"
																	}
																}
															],
															"sid": 949128548819644
														}
													]
												}
											]
										}
									]
								}
							]
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Apply gravity to all player segments as soon as they stop moving and paint surrounding tiles with slime."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-timer",
							"objectClass": "GameManager",
							"sid": 618683106719115,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"MovingCooldown\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "SplashSlime",
							"sid": 669778988914941
						},
						{
							"callFunction": "ApplyGravity",
							"sid": 687780926839330
						}
					],
					"sid": 423249522973200
				},
				{
					"eventType": "comment",
					"text": "Move all player segments down if there's nothing below any of the segments."
				},
				{
					"functionName": "ApplyGravity",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [],
					"eventType": "function-block",
					"conditions": [],
					"actions": [],
					"sid": 401138321479135,
					"children": [
						{
							"eventType": "variable",
							"name": "MinDistance",
							"type": "number",
							"initialValue": "1024",
							"comment": "",
							"isStatic": false,
							"isConstant": false,
							"sid": 811827912287971
						},
						{
							"eventType": "comment",
							"text": "Iterate through all player segments to check which one has the smallest distance towards the ground and store such distance in a local variable."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each-ordered",
									"objectClass": "System",
									"sid": 610007712166443,
									"parameters": {
										"object": "PlayerSegment",
										"expression": "PlayerSegment.SegmentIndex",
										"order": "ascending"
									}
								}
							],
							"actions": [
								{
									"id": "cast-ray",
									"objectClass": "PlayerSegment",
									"sid": 647425683726099,
									"behaviorType": "LineOfSight",
									"parameters": {
										"from-x": "Self.X",
										"from-y": "Self.Y",
										"to-x": "Self.X",
										"to-y": "Self.Y + Self.LineOfSight.Range",
										"use-collision-cells": true
									}
								}
							],
							"sid": 892582977404191,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "ray-intersected",
											"objectClass": "PlayerSegment",
											"sid": 812321833928407,
											"behaviorType": "LineOfSight"
										},
										{
											"id": "compare-two-values",
											"objectClass": "System",
											"sid": 501510814150147,
											"parameters": {
												"first-value": "PlayerSegment.LineOfSight.HitDistance",
												"comparison": 2,
												"second-value": "MinDistance"
											}
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 153323307680818,
											"parameters": {
												"variable": "MinDistance",
												"value": "round(PlayerSegment.LineOfSight.HitDistance - 8)"
											}
										}
									],
									"sid": 325698689222549
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Move all player segments according to the minimum distance if its higher than zero."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 381999736010211,
									"parameters": {
										"first-value": "MinDistance",
										"comparison": 4,
										"second-value": "0"
									}
								}
							],
							"actions": [],
							"sid": 727438924691829,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for-each-ordered",
											"objectClass": "System",
											"sid": 951854061741575,
											"parameters": {
												"object": "PlayerSegment",
												"expression": "PlayerSegment.SegmentIndex",
												"order": "ascending"
											}
										}
									],
									"actions": [
										{
											"id": "tween-one-property",
											"objectClass": "PlayerSegment",
											"sid": 119166815974503,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"DecreaseY\"",
												"property": "offsetY",
												"end-value": "Self.Y + MinDistance",
												"time": "SNAKEFALLDURATION",
												"ease": "easeinsine",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no"
											}
										},
										{
											"id": "start-timer",
											"objectClass": "GameManager",
											"sid": 991627342182963,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "SNAKEFALLDURATION",
												"type": "once",
												"tag": "\"FallingCooldown\""
											}
										}
									],
									"sid": 509732246353986
								}
							]
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Paint surrounding tiles with slime after stopping falling."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-timer",
							"objectClass": "GameManager",
							"sid": 355251593257976,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"FallingCooldown\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "SplashSlime",
							"sid": 168351183288898
						}
					],
					"sid": 703465773728595
				},
				{
					"eventType": "comment",
					"text": "Splash lime on the surround ground tiles, by increasing the tile index."
				},
				{
					"functionName": "SplashSlime",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [],
					"eventType": "function-block",
					"conditions": [],
					"actions": [],
					"sid": 558159894633581,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each-ordered",
									"objectClass": "System",
									"sid": 240822675139737,
									"parameters": {
										"object": "PlayerSegment",
										"expression": "PlayerSegment.SegmentIndex",
										"order": "ascending"
									}
								}
							],
							"actions": [],
							"sid": 625355541975571,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for",
											"objectClass": "System",
											"sid": 651240848699147,
											"parameters": {
												"name": "\"Angle\"",
												"start-index": "0",
												"end-index": "3"
											}
										}
									],
									"actions": [],
									"sid": 384404908981068,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-tile-at",
													"objectClass": "Ground",
													"sid": 353428249978149,
													"parameters": {
														"tile-x": "Ground.PositionToTileX(round(PlayerSegment.X + cos(90 * loopindex(\"Angle\")) * 16))",
														"tile-y": "Ground.PositionToTileY(round(PlayerSegment.Y + sin(90 * loopindex(\"Angle\")) * 16))",
														"comparison": 1,
														"tile": "-1"
													}
												}
											],
											"actions": [
												{
													"id": "set-tile",
													"objectClass": "Ground",
													"sid": 811412030601600,
													"parameters": {
														"tile-x": "Ground.PositionToTileX(round(PlayerSegment.X + cos(90 * loopindex(\"Angle\")) * 16))",
														"tile-y": "Ground.PositionToTileY(round(PlayerSegment.Y + sin(90 * loopindex(\"Angle\")) * 16))",
														"tile": "Ground.TileAt(Ground.PositionToTileX(round(PlayerSegment.X + cos(90 * loopindex(\"Angle\")) * 16)),  Ground.PositionToTileY(round(PlayerSegment.Y + sin(90 * loopindex(\"Angle\")) * 16))) + 49",
														"state": "normal"
													}
												},
												{
													"id": "create-object",
													"objectClass": "System",
													"sid": 937953364358318,
													"parameters": {
														"object-to-create": "SlimeSplash",
														"layer": "\"Effects\"",
														"x": "Ground.TileToPositionX(Ground.PositionToTileX(round(PlayerSegment.X + cos(90 * loopindex(\"Angle\")) * 16)))",
														"y": "Ground.TileToPositionY(Ground.PositionToTileY(round(PlayerSegment.Y + sin(90 * loopindex(\"Angle\")) * 16)))",
														"create-hierarchy": false
													}
												}
											],
											"sid": 365515521855733
										}
									]
								}
							]
						}
					]
				}
			],
			"sid": 252870916358373
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Portal",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Completely disable the player controls and start the level ending animation."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "PlayerSegment",
							"sid": 111798907199284,
							"parameters": {
								"object": "Portal"
							}
						}
					],
					"actions": [
						{
							"id": "start-timer",
							"objectClass": "GameManager",
							"sid": 425728498447618,
							"behaviorType": "Timer",
							"parameters": {
								"duration": "5",
								"type": "once",
								"tag": "\"EndingCooldown\""
							}
						}
					],
					"sid": 578240849986499,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-all",
									"objectClass": "System",
									"sid": 500691775889593,
									"parameters": {
										"object": "PlayerSegment"
									}
								}
							],
							"actions": [],
							"sid": 365868291889615,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for-each-ordered",
											"objectClass": "System",
											"sid": 545149175495451,
											"parameters": {
												"object": "PlayerSegment",
												"expression": "PlayerSegment.SegmentIndex",
												"order": "ascending"
											}
										}
									],
									"actions": [
										{
											"id": "set-collisions-enabled",
											"objectClass": "PlayerSegment",
											"sid": 931066467007396,
											"parameters": {
												"collisions": "disabled"
											}
										},
										{
											"id": "stop-all-tweens",
											"objectClass": "PlayerSegment",
											"sid": 763476038347933,
											"behaviorType": "Tween"
										},
										{
											"id": "wait",
											"objectClass": "System",
											"sid": 467668041393734,
											"parameters": {
												"seconds": "PlayerSegment.SegmentIndex  / 10"
											}
										},
										{
											"id": "tween-two-properties",
											"objectClass": "PlayerSegment",
											"sid": 308928353568982,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"Ending\"",
												"property": "position",
												"end-x": "Portal.X",
												"end-y": "Portal.Y",
												"time": "0.5",
												"ease": "easeinsine",
												"destroy-on-complete": "yes",
												"loop": "no",
												"ping-pong": "no"
											}
										},
										{
											"callFunction": "FlashPlayerSegment",
											"sid": 388490439478038,
											"parameters": [
												"PlayerSegment.UID"
											]
										},
										{
											"callFunction": "ShockPlayerSegment",
											"sid": 727990051891631,
											"parameters": [
												"PlayerSegment.UID",
												"4",
												"16"
											]
										}
									],
									"sid": 463747160490200
								}
							]
						}
					]
				},
				{
					"eventType": "comment",
					"text": "As soon as the player finishes its ending animation, spawn a bunch of shock elements."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-tweens-finished",
							"objectClass": "PlayerSegment",
							"sid": 243662695708492,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"Ending\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "ShockPlayerSegment",
							"sid": 916784175688387,
							"parameters": [
								"PlayerSegment.UID",
								"4",
								"12"
							]
						}
					],
					"sid": 671854496898771
				},
				{
					"eventType": "comment",
					"text": "Spawn a few flash related object son top of a specific player segment."
				},
				{
					"functionName": "FlashPlayerSegment",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "PlayerSegmentUID",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 553426245081555
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-unique-id",
							"objectClass": "PlayerSegment",
							"sid": 182839607741337,
							"parameters": {
								"unique-id": "PlayerSegmentUID"
							}
						}
					],
					"actions": [
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 102521621329689,
							"parameters": {
								"object-to-create": "Flash",
								"layer": "\"World\"",
								"x": "PlayerSegment.X",
								"y": "PlayerSegment.Y",
								"create-hierarchy": false
							}
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 359784548157125,
							"parameters": {
								"object-to-create": "FlashGlow",
								"layer": "\"World\"",
								"x": "PlayerSegment.X",
								"y": "PlayerSegment.Y",
								"create-hierarchy": false
							}
						}
					],
					"sid": 152666546210211
				},
				{
					"eventType": "comment",
					"text": "Spawn a few shock related objects on top of a specific player segment."
				},
				{
					"functionName": "ShockPlayerSegment",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "PlayerSegmentUID",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 563721221739195
						},
						{
							"name": "Rate",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 962752999082579
						},
						{
							"name": "PositionOffset",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 193286352697800
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-unique-id",
							"objectClass": "PlayerSegment",
							"sid": 279026742134174,
							"parameters": {
								"unique-id": "PlayerSegmentUID"
							}
						}
					],
					"actions": [],
					"sid": 547167256144577,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "repeat",
									"objectClass": "System",
									"sid": 755176931552808,
									"parameters": {
										"count": "Rate"
									}
								}
							],
							"actions": [
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 851658684598970,
									"parameters": {
										"object-to-create": "FlashShock",
										"layer": "\"World\"",
										"x": "PlayerSegment.X + random(-PositionOffset, PositionOffset)",
										"y": "PlayerSegment.Y + random(-PositionOffset, PositionOffset)",
										"create-hierarchy": false
									}
								},
								{
									"id": "set-angle",
									"objectClass": "FlashShock",
									"sid": 614569564444208,
									"parameters": {
										"angle": "random(0, 360)"
									}
								},
								{
									"id": "tween-two-properties",
									"objectClass": "FlashShock",
									"sid": 556744249944783,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"DecreaseSize\"",
										"property": "size",
										"end-x": "0",
										"end-y": "Self.Height / 2",
										"time": "0.25",
										"ease": "easeinsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no"
									}
								}
							],
							"sid": 264588274002480
						}
					]
				}
			],
			"sid": 616142001111291
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Spike",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Restart the game."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "PlayerSegment",
							"sid": 567461720609152,
							"parameters": {
								"object": "Spike"
							}
						}
					],
					"actions": [
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 215751707543351
						}
					],
					"sid": 120261177166776
				}
			],
			"sid": 227055195979784
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Lava",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Spawn a sequence of distortion mask on top of the lava glow, so it can make the rest of the layout look very hot."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 382701488352636
						}
					],
					"actions": [],
					"sid": 679707284914676,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 423878727078848,
									"parameters": {
										"name": "\"X\"",
										"start-index": "0",
										"end-index": "(LayoutWidth / 16) - 1"
									}
								}
							],
							"actions": [
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 367011151428895,
									"parameters": {
										"object-to-create": "DistortionMask",
										"layer": "\"World\"",
										"x": "16 * loopindex(\"X\")",
										"y": "LavaGlow.Y",
										"create-hierarchy": false
									}
								}
							],
							"sid": 698852962561849
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Store the lava glow initial Y position."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-created",
							"objectClass": "LavaGlow",
							"sid": 543128481226024
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "LavaGlow",
							"sid": 218916560082263,
							"parameters": {
								"instance-variable": "InitialY",
								"value": "Self.Y"
							}
						}
					],
					"sid": 628947333484742
				},
				{
					"eventType": "comment",
					"text": "Store the lava particles initial Y position."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-created",
							"objectClass": "LavaParticles",
							"sid": 270799140286443
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "LavaParticles",
							"sid": 185096505921749,
							"parameters": {
								"instance-variable": "InitialY",
								"value": "Self.Y"
							}
						}
					],
					"sid": 259702401863444
				},
				{
					"eventType": "comment",
					"text": "Update the offset of all lava related objects, so they can match each other."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 911995379905395
						}
					],
					"actions": [
						{
							"id": "set-image-offset-x",
							"objectClass": "Lava",
							"sid": 175754333534836,
							"parameters": {
								"offset-x": "Self.ImageOffsetX + 0.05 * TARGETFRAMERATE * dt"
							}
						},
						{
							"id": "set-image-offset-y",
							"objectClass": "Lava",
							"sid": 345899988042243,
							"parameters": {
								"offset-y": "GameManager.Sine.Value"
							}
						},
						{
							"id": "set-y",
							"objectClass": "LavaGlow",
							"sid": 686522520668149,
							"parameters": {
								"y": "Self.InitialY + GameManager.Sine.Value"
							}
						},
						{
							"id": "set-y",
							"objectClass": "LavaParticles",
							"sid": 803756743956732,
							"parameters": {
								"y": "Self.InitialY + GameManager.Sine.Value"
							}
						}
					],
					"sid": 504419748433115
				},
				{
					"eventType": "comment",
					"text": "Spawn a lava bubble on to of the lava every now and then."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-x-seconds",
							"objectClass": "System",
							"sid": 496938751277724,
							"parameters": {
								"interval-seconds": "0.25"
							}
						}
					],
					"actions": [
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 524459310476688,
							"parameters": {
								"object-to-create": "LavaBubble",
								"layer": "\"World\"",
								"x": "random(LavaBubble.ImageWidth / 2, LayoutWidth - LavaBubble.ImageWidth / 2)",
								"y": "LavaGlow.Y",
								"create-hierarchy": false
							}
						},
						{
							"id": "add-child",
							"objectClass": "LavaGlow",
							"sid": 855368014065940,
							"parameters": {
								"child": "LavaBubble",
								"transform-x": false,
								"transform-y": true,
								"transform-w": false,
								"transform-h": false,
								"transform-a": false,
								"transform-z-elevation": false,
								"destroy-with-parent": false
							}
						}
					],
					"sid": 943282904772784
				}
			],
			"sid": 849478762573155
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Effects",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Update the pixellate effect to match the current pixel density of the window."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 339979710232757
						}
					],
					"actions": [
						{
							"id": "set-layer-effect-parameter",
							"objectClass": "System",
							"sid": 449755414826477,
							"parameters": {
								"layer": "\"Effects\"",
								"effect": "\"Pixellate\"",
								"parameter-index": "0",
								"value": "PlatformInfo.CanvasDeviceWidth / OriginalViewportWidth"
							}
						}
					],
					"sid": 741909252942703
				}
			],
			"sid": 937549322246397
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "DebugTools",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Restart the game."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 239540811420392,
							"parameters": {
								"key": 82
							}
						},
						{
							"id": "on-button-pressed",
							"objectClass": "Gamepad",
							"sid": 167541536019091,
							"parameters": {
								"gamepad": "0",
								"button": "start-menu"
							}
						}
					],
					"actions": [
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 622169263699332
						}
					],
					"sid": 996999277608450,
					"isOrBlock": true
				},
				{
					"eventType": "comment",
					"text": "Close the game."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 831963697061084,
							"parameters": {
								"key": 27
							}
						}
					],
					"actions": [
						{
							"id": "close",
							"objectClass": "Browser",
							"sid": 613694157077686
						}
					],
					"sid": 145759697744500
				}
			],
			"sid": 891348349026316
		}
	],
	"sid": 991608621108283
}