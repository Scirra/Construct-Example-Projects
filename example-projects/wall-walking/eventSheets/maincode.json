{
	"name": "MainCode",
	"events": [
		{
			"eventType": "comment",
			"text": "Made by Viridino Studios (@ViridinoStudios)\n\nMateus Ferreira - Programmer\nTwitter: @BonzerKitten\nE-mail: ferreiramoreiramateus@gmail.com\n\nWesley Andrade - Artist\nTwitter: @andrart7\nE-mail: wesleymatos1989@gmail.com\n\nMade with the support of patrons on https://www.patreon.com/viridinostudios"
		},
		{
			"eventType": "comment",
			"text": "Player input references."
		},
		{
			"eventType": "variable",
			"name": "InputLeft",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": true,
			"isConstant": false,
			"sid": 986600857993775
		},
		{
			"eventType": "variable",
			"name": "InputRight",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": true,
			"isConstant": false,
			"sid": 394955464569560
		},
		{
			"eventType": "variable",
			"name": "InputUp",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": true,
			"isConstant": false,
			"sid": 859845132156215
		},
		{
			"eventType": "variable",
			"name": "InputDown",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": true,
			"isConstant": false,
			"sid": 622325455361523
		},
		{
			"eventType": "variable",
			"name": "HorizontalAxis",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": true,
			"isConstant": false,
			"sid": 433221872596504
		},
		{
			"eventType": "variable",
			"name": "VerticalAxis",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": true,
			"isConstant": false,
			"sid": 837524433984311
		},
		{
			"eventType": "variable",
			"name": "AxisAngle",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": true,
			"isConstant": false,
			"sid": 711433829481144
		},
		{
			"eventType": "variable",
			"name": "NormalizedDirection",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 324681987107585
		},
		{
			"eventType": "variable",
			"name": "DirectionAngle",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 593414174502915
		},
		{
			"eventType": "comment",
			"text": "How offset the axis angle can be before while still being accepted as \"true\" for any comparison."
		},
		{
			"eventType": "variable",
			"name": "INPUTTHRESHOLD",
			"type": "number",
			"initialValue": "0.5",
			"comment": "",
			"isStatic": true,
			"isConstant": true,
			"sid": 101498859941910
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Player",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "group",
					"disabled": false,
					"title": "PlayerSetup",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Reset all global variables to make sure nothing from previous sessions will interfere the game."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-start-of-layout",
									"objectClass": "System",
									"sid": 796671218886728
								}
							],
							"actions": [
								{
									"id": "reset-global-variables",
									"objectClass": "System",
									"sid": 927961188957356
								}
							],
							"sid": 717612525165036
						},
						{
							"eventType": "comment",
							"text": "Setup the player by adding its graphics as a child of the collider."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-created",
									"objectClass": "PlayerGraphics",
									"sid": 594730415360274
								}
							],
							"actions": [
								{
									"id": "set-position-to-another-object",
									"objectClass": "PlayerGraphics",
									"sid": 841884366138315,
									"parameters": {
										"object": "PlayerCollision",
										"image-point-optional": "0"
									}
								},
								{
									"id": "add-child",
									"objectClass": "PlayerCollision",
									"sid": 940127808645992,
									"parameters": {
										"child": "PlayerGraphics",
										"transform-x": true,
										"transform-y": true,
										"transform-w": false,
										"transform-h": false,
										"transform-a": true,
										"transform-z-elevation": false,
										"destroy-with-parent": true
									}
								}
							],
							"sid": 960983322737064
						}
					],
					"sid": 784603836528212
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "PlayerControls",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Receive and store input from the player to be used later in many situations."
						},
						{
							"eventType": "comment",
							"text": "Toggle input left."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 940876619458367,
									"parameters": {
										"key": 37
									}
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 485439395839532,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-left"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 375328707736439,
									"parameters": {
										"variable": "InputLeft",
										"value": "1"
									}
								}
							],
							"sid": 264402595788968,
							"isOrBlock": true
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 620453169729022
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 128963562955258,
									"parameters": {
										"variable": "InputLeft",
										"value": "0"
									}
								}
							],
							"sid": 126765877129660
						},
						{
							"eventType": "comment",
							"text": "Toggle input right."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 419887578263887,
									"parameters": {
										"key": 39
									}
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 910485628604972,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-right"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 300300955137560,
									"parameters": {
										"variable": "InputRight",
										"value": "1"
									}
								}
							],
							"sid": 600039708179932,
							"isOrBlock": true
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 388116139706485
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 781425706760484,
									"parameters": {
										"variable": "InputRight",
										"value": "0"
									}
								}
							],
							"sid": 253001280827234
						},
						{
							"eventType": "comment",
							"text": "Toggle input up."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 480019407402334,
									"parameters": {
										"key": 38
									}
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 558870211438748,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-up"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 243569615342151,
									"parameters": {
										"variable": "InputUp",
										"value": "1"
									}
								}
							],
							"sid": 692987342524194,
							"isOrBlock": true
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 679789685805931
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 518820768048787,
									"parameters": {
										"variable": "InputUp",
										"value": "0"
									}
								}
							],
							"sid": 230961424757456
						},
						{
							"eventType": "comment",
							"text": "Toggle input down."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 577403778923224,
									"parameters": {
										"key": 40
									}
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 600410881698604,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-down"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 376141515658161,
									"parameters": {
										"variable": "InputDown",
										"value": "1"
									}
								}
							],
							"sid": 919708660602415,
							"isOrBlock": true
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 913518618233236
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 679263746804457,
									"parameters": {
										"variable": "InputDown",
										"value": "0"
									}
								}
							],
							"sid": 516472385474201
						},
						{
							"eventType": "comment",
							"text": "Calculate both axis and looking angle based on the player input."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "every-tick",
									"objectClass": "System",
									"sid": 135435647038745
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 745431537572732,
									"parameters": {
										"variable": "HorizontalAxis",
										"value": "InputRight - InputLeft"
									}
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 268015293779542,
									"parameters": {
										"variable": "VerticalAxis",
										"value": "InputDown - InputUp"
									}
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 303474660478573,
									"parameters": {
										"variable": "AxisAngle",
										"value": "angle(0, 0, HorizontalAxis, VerticalAxis)"
									}
								}
							],
							"sid": 670215684820540
						},
						{
							"eventType": "comment",
							"text": "Make the player jump."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 483631168435843,
									"parameters": {
										"key": 90
									}
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 892685996869684,
									"parameters": {
										"gamepad": "0",
										"button": "button-a"
									}
								}
							],
							"actions": [
								{
									"id": "simulate-control",
									"objectClass": "PlayerCollision",
									"sid": 801526876848270,
									"behaviorType": "Platform",
									"parameters": {
										"control": "jump"
									}
								}
							],
							"sid": 145191292488866,
							"isOrBlock": true
						},
						{
							"eventType": "comment",
							"text": "Only allow the player to move if at least one of the input axis are not equal to zero, so the player don't move by itself while there's no input."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 231200864647576,
									"parameters": {
										"variable": "HorizontalAxis",
										"comparison": 1,
										"value": "0"
									}
								},
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 938956661686486,
									"parameters": {
										"variable": "VerticalAxis",
										"comparison": 1,
										"value": "0"
									}
								}
							],
							"actions": [],
							"sid": 679231493136702,
							"children": [
								{
									"eventType": "comment",
									"text": "Move the player to the left while also mirroring its graphics."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-within-angle",
											"objectClass": "System",
											"sid": 619103995930819,
											"parameters": {
												"angle-1": "PlayerCollision.Angle + 180",
												"within": "InputThreshold",
												"angle-2": "AxisAngle"
											}
										}
									],
									"actions": [
										{
											"id": "simulate-control",
											"objectClass": "PlayerCollision",
											"sid": 661295901103914,
											"behaviorType": "Platform",
											"parameters": {
												"control": "left"
											}
										},
										{
											"id": "set-mirrored",
											"objectClass": "PlayerGraphics",
											"sid": 904953236625546,
											"parameters": {
												"state": "mirrored"
											}
										}
									],
									"sid": 403665042813878
								},
								{
									"eventType": "comment",
									"text": "Move the player to the right while also \"unmirroring\" its graphics."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-within-angle",
											"objectClass": "System",
											"sid": 301167366272393,
											"parameters": {
												"angle-1": "PlayerCollision.Angle",
												"within": "InputThreshold",
												"angle-2": "AxisAngle"
											}
										}
									],
									"actions": [
										{
											"id": "simulate-control",
											"objectClass": "PlayerCollision",
											"sid": 975556862760600,
											"behaviorType": "Platform",
											"parameters": {
												"control": "right"
											}
										},
										{
											"id": "set-mirrored",
											"objectClass": "PlayerGraphics",
											"sid": 566667557848941,
											"parameters": {
												"state": "not-mirrored"
											}
										}
									],
									"sid": 801213958588648
								}
							],
							"isOrBlock": true
						}
					],
					"sid": 284160857497412
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "PlayerAnimations",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Constantly update and store the current player direction, so it can be used later for multiple situations."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 343209589507889,
									"parameters": {
										"first-value": "PlayerGraphics.Count",
										"comparison": 0,
										"second-value": "1"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 561041532961412,
									"parameters": {
										"variable": "NormalizedDirection",
										"value": "sign(PlayerGraphics.Width)"
									}
								}
							],
							"sid": 921578393386537
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 902682120427853
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 911615287705728,
									"parameters": {
										"variable": "NormalizedDirection",
										"value": "0"
									}
								}
							],
							"sid": 194691942641316
						},
						{
							"eventType": "comment",
							"text": "Change the player's animation states depending on what the player is currently doing."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-on-floor",
									"objectClass": "PlayerCollision",
									"sid": 856515258548587,
									"behaviorType": "Platform"
								}
							],
							"actions": [],
							"sid": 389764283885862,
							"children": [
								{
									"eventType": "comment",
									"text": "Walk animation."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-moving",
											"objectClass": "PlayerCollision",
											"sid": 207825930110399,
											"behaviorType": "Platform"
										}
									],
									"actions": [
										{
											"id": "set-animation",
											"objectClass": "PlayerGraphics",
											"sid": 542226283971516,
											"parameters": {
												"animation": "\"Walk\"",
												"from": "beginning"
											}
										}
									],
									"sid": 452766029252684
								},
								{
									"eventType": "comment",
									"text": "Idle animation."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 296767768499252
										}
									],
									"actions": [
										{
											"id": "set-animation",
											"objectClass": "PlayerGraphics",
											"sid": 677910502604886,
											"parameters": {
												"animation": "\"Idle\"",
												"from": "beginning"
											}
										}
									],
									"sid": 207306889735895
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Jump animation."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-jumping",
									"objectClass": "PlayerCollision",
									"sid": 693293609655887,
									"behaviorType": "Platform"
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "PlayerGraphics",
									"sid": 785192486695255,
									"parameters": {
										"animation": "\"Jump\"",
										"from": "beginning"
									}
								}
							],
							"sid": 491575208204455
						},
						{
							"eventType": "comment",
							"text": "Fall animation."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-falling",
									"objectClass": "PlayerCollision",
									"sid": 651001489692675,
									"behaviorType": "Platform"
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "PlayerGraphics",
									"sid": 340677216155089,
									"parameters": {
										"animation": "\"Fall\"",
										"from": "beginning"
									}
								}
							],
							"sid": 163021654061859
						}
					],
					"sid": 921833879566076
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "PlayerParticles",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Leave a small trail of step dust behind the player every 0.1 seconds while moving on the floor."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-moving",
									"objectClass": "PlayerCollision",
									"sid": 921519231278732,
									"behaviorType": "Platform"
								},
								{
									"id": "is-on-floor",
									"objectClass": "PlayerCollision",
									"sid": 357843781803339,
									"behaviorType": "Platform"
								}
							],
							"actions": [],
							"sid": 161109337891487,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "every-x-seconds",
											"objectClass": "System",
											"sid": 127104296297015,
											"parameters": {
												"interval-seconds": "0.1"
											}
										}
									],
									"actions": [
										{
											"id": "spawn-another-object",
											"objectClass": "PlayerGraphics",
											"sid": 433798684727823,
											"parameters": {
												"object": "StepDust",
												"layer": "\"World\"",
												"image-point": "\"FeetCenter\"",
												"create-hierarchy": false
											}
										},
										{
											"id": "set-width",
											"objectClass": "StepDust",
											"sid": 439317865690287,
											"parameters": {
												"width": "Self.Width*NormalizedDirection"
											}
										}
									],
									"sid": 905293210510900
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-animation-finished",
									"objectClass": "StepDust",
									"sid": 397515139767732,
									"parameters": {
										"animation": "\"Default\""
									}
								}
							],
							"actions": [
								{
									"id": "destroy",
									"objectClass": "StepDust",
									"sid": 410729693540828
								}
							],
							"sid": 794294454012742
						},
						{
							"eventType": "comment",
							"text": "Spawn a land dust below the player after each landing."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-landed",
									"objectClass": "PlayerCollision",
									"sid": 444737528343782,
									"behaviorType": "Platform"
								}
							],
							"actions": [
								{
									"id": "spawn-another-object",
									"objectClass": "PlayerGraphics",
									"sid": 122260337794754,
									"parameters": {
										"object": "LandDust",
										"layer": "\"World\"",
										"image-point": "\"FeetCenter\"",
										"create-hierarchy": false
									}
								}
							],
							"sid": 631976253286653
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-animation-finished",
									"objectClass": "LandDust",
									"sid": 273046285726564,
									"parameters": {
										"animation": "\"Default\""
									}
								}
							],
							"actions": [
								{
									"id": "destroy",
									"objectClass": "LandDust",
									"sid": 585352019894422
								}
							],
							"sid": 895107268472256
						},
						{
							"eventType": "comment",
							"text": "Spawn a jump dust below the player after each jump."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-jump",
									"objectClass": "PlayerCollision",
									"sid": 763147363186252,
									"behaviorType": "Platform"
								}
							],
							"actions": [
								{
									"id": "spawn-another-object",
									"objectClass": "PlayerGraphics",
									"sid": 379031977631671,
									"parameters": {
										"object": "JumpDust",
										"layer": "\"World\"",
										"image-point": "\"FeetCenter\"",
										"create-hierarchy": false
									}
								}
							],
							"sid": 533073345691899
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-animation-finished",
									"objectClass": "JumpDust",
									"sid": 616047320829656,
									"parameters": {
										"animation": "\"Default\""
									}
								}
							],
							"actions": [
								{
									"id": "destroy",
									"objectClass": "JumpDust",
									"sid": 597334596771081
								}
							],
							"sid": 861552768202691
						}
					],
					"sid": 121966962983873
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "WallWalking",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "How long it takes to move the player to a different wall."
						},
						{
							"eventType": "variable",
							"name": "ANIMATIONDURATION",
							"type": "number",
							"initialValue": "0.25",
							"comment": "",
							"isStatic": true,
							"isConstant": true,
							"sid": 639696460318580
						},
						{
							"eventType": "comment",
							"text": "The amount of red, green and blue in the wall."
						},
						{
							"eventType": "variable",
							"name": "Red",
							"type": "number",
							"initialValue": "16",
							"comment": "",
							"isStatic": true,
							"isConstant": false,
							"sid": 622752236610845
						},
						{
							"eventType": "variable",
							"name": "Green",
							"type": "number",
							"initialValue": "200",
							"comment": "",
							"isStatic": true,
							"isConstant": false,
							"sid": 152819614040395
						},
						{
							"eventType": "variable",
							"name": "Blue",
							"type": "number",
							"initialValue": "64",
							"comment": "",
							"isStatic": true,
							"isConstant": false,
							"sid": 455335534510000
						},
						{
							"eventType": "comment",
							"text": "update direction angle"
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "every-tick",
									"objectClass": "System",
									"sid": 585883463034346
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 734913436209389,
									"parameters": {
										"variable": "DirectionAngle",
										"value": "PlayerCollision.Angle + angle(0, 0, NormalizedDirection, 0)"
									}
								}
							],
							"sid": 245223892878608
						},
						{
							"eventType": "comment",
							"text": "Change the player's angle of gravity to match the wall in front of him, allowing him to walk on walls. But, only if the player is not moving to a different wall already."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-key-pressed",
									"objectClass": "Keyboard",
									"sid": 371267361844321,
									"parameters": {
										"key": 88
									}
								},
								{
									"id": "on-button-pressed",
									"objectClass": "Gamepad",
									"sid": 219197246745722,
									"parameters": {
										"gamepad": "0",
										"button": "button-b"
									}
								}
							],
							"actions": [],
							"sid": 578164585378973,
							"children": [
								{
									"eventType": "comment",
									"text": "Cast a short ray in front of the player, which will be used to detect walls and how tilted they're in comparison with the ground."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-timer-running",
											"objectClass": "PlayerCollision",
											"sid": 186612560698983,
											"behaviorType": "Timer",
											"parameters": {
												"tag": "\"AnimationDuration\""
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "cast-ray",
											"objectClass": "PlayerCollision",
											"sid": 795178342321479,
											"behaviorType": "LineOfSight",
											"parameters": {
												"from-x": "Self.ImagePointX(\"Center\")",
												"from-y": "Self.ImagePointY(\"Center\")",
												"to-x": "Self.ImagePointX(\"Center\") + cos(DirectionAngle) * Self.LineOfSight.Range",
												"to-y": "Self.ImagePointY(\"Center\") + sin(DirectionAngle) * Self.LineOfSight.Range",
												"use-collision-cells": true
											}
										}
									],
									"sid": 829481974386190,
									"children": [
										{
											"eventType": "comment",
											"text": "If the ray hits a wall, rotate and positionate the player on top of it, while also changing its color palette."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "ray-intersected",
													"objectClass": "PlayerCollision",
													"sid": 500419624217954,
													"behaviorType": "LineOfSight"
												}
											],
											"actions": [
												{
													"type": "comment",
													"text": "Reset both movement vectors."
												},
												{
													"id": "set-vector-x",
													"objectClass": "PlayerCollision",
													"sid": 652030463761886,
													"behaviorType": "Platform",
													"parameters": {
														"vector-x": "0"
													}
												},
												{
													"id": "set-vector-y",
													"objectClass": "PlayerCollision",
													"sid": 992553438906471,
													"behaviorType": "Platform",
													"parameters": {
														"vector-y": "0"
													}
												},
												{
													"type": "comment",
													"text": "Disabled the platform behavior, so it doesn't interfere in the player's movement."
												},
												{
													"id": "set-enabled",
													"objectClass": "PlayerCollision",
													"sid": 549787681236307,
													"behaviorType": "Platform",
													"parameters": {
														"state": "disabled"
													}
												},
												{
													"type": "comment",
													"text": "Update the player's angle and position to match the wall."
												},
												{
													"id": "tween-two-properties",
													"objectClass": "PlayerCollision",
													"sid": 139450175086831,
													"behaviorType": "Tween",
													"parameters": {
														"tags": "\"Position\"",
														"property": "position",
														"end-x": "Self.LineOfSight.HitX",
														"end-y": "Self.LineOfSight.HitY",
														"time": "ANIMATIONDURATION",
														"ease": "default",
														"destroy-on-complete": "no",
														"loop": "no",
														"ping-pong": "no"
													}
												},
												{
													"id": "tween-one-property",
													"objectClass": "PlayerCollision",
													"sid": 598590741624843,
													"behaviorType": "Tween",
													"parameters": {
														"tags": "\"Angle\"",
														"property": "offsetAngle",
														"end-value": "Self.LineOfSight.NormalAngle + 90",
														"time": "ANIMATIONDURATION",
														"ease": "default",
														"destroy-on-complete": "no",
														"loop": "no",
														"ping-pong": "no"
													}
												},
												{
													"type": "comment",
													"text": "Start a timer with the same duration as the rest of the tween animations, so it's easier to know when everything is done."
												},
												{
													"id": "start-timer",
													"objectClass": "PlayerCollision",
													"sid": 577337848014859,
													"behaviorType": "Timer",
													"parameters": {
														"duration": "ANIMATIONDURATION",
														"type": "once",
														"tag": "\"AnimationDuration\""
													}
												},
												{
													"type": "comment",
													"text": "Create a distortion mask that grows over time to warp the area around the player, creating a very interesting looking effect."
												},
												{
													"id": "spawn-another-object",
													"objectClass": "PlayerCollision",
													"sid": 348621674868259,
													"parameters": {
														"object": "DistortionMask",
														"layer": "\"World\"",
														"image-point": "\"Center\"",
														"create-hierarchy": false
													}
												},
												{
													"id": "set-size",
													"objectClass": "DistortionMask",
													"sid": 502153515813791,
													"parameters": {
														"width": "0",
														"height": "0"
													}
												},
												{
													"id": "tween-two-properties",
													"objectClass": "DistortionMask",
													"sid": 161217074941445,
													"behaviorType": "Tween",
													"parameters": {
														"tags": "\"SizeGrow\"",
														"property": "size",
														"end-x": "Self.ImageWidth",
														"end-y": "Self.ImageHeight",
														"time": "ANIMATIONDURATION * 2",
														"ease": "default",
														"destroy-on-complete": "no",
														"loop": "no",
														"ping-pong": "no"
													}
												},
												{
													"id": "set-fade-out-time",
													"objectClass": "DistortionMask",
													"sid": 854408509552668,
													"behaviorType": "Fade",
													"parameters": {
														"fade-out-time": "ANIMATIONDURATION * 2"
													}
												},
												{
													"id": "restart-fade",
													"objectClass": "DistortionMask",
													"sid": 485844820433936,
													"behaviorType": "Fade"
												}
											],
											"sid": 746160088433090,
											"children": [
												{
													"eventType": "comment",
													"text": "Apply a different color palette to the level depending on the wall angle the player is currently walking on."
												},
												{
													"eventType": "comment",
													"text": "Ground (green)."
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "is-within-angle",
															"objectClass": "System",
															"sid": 129215886072953,
															"parameters": {
																"angle-1": "PlayerCollision.LineOfSight.NormalAngle + 90",
																"within": "0.5",
																"angle-2": "0"
															}
														}
													],
													"actions": [
														{
															"callFunction": "ChangeGroundColor",
															"sid": 134059949419446,
															"parameters": [
																"16",
																"200",
																"64"
															]
														}
													],
													"sid": 263487400105285
												},
												{
													"eventType": "comment",
													"text": "Ceiling (red)."
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "is-within-angle",
															"objectClass": "System",
															"sid": 930063643375347,
															"parameters": {
																"angle-1": "PlayerCollision.LineOfSight.NormalAngle + 90",
																"within": "0.5",
																"angle-2": "180"
															}
														}
													],
													"actions": [
														{
															"callFunction": "ChangeGroundColor",
															"sid": 201811232938262,
															"parameters": [
																"210",
																"64",
																"64"
															]
														}
													],
													"sid": 827925737734204
												},
												{
													"eventType": "comment",
													"text": "Left wall (blue)."
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "is-within-angle",
															"objectClass": "System",
															"sid": 883094262115802,
															"parameters": {
																"angle-1": "PlayerCollision.LineOfSight.NormalAngle + 90",
																"within": "0.5",
																"angle-2": "90"
															}
														}
													],
													"actions": [
														{
															"callFunction": "ChangeGroundColor",
															"sid": 559169104774008,
															"parameters": [
																"0",
																"160",
																"200"
															]
														}
													],
													"sid": 662284366349153
												},
												{
													"eventType": "comment",
													"text": "Right wall (yellow)."
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "is-within-angle",
															"objectClass": "System",
															"sid": 866143241410393,
															"parameters": {
																"angle-1": "PlayerCollision.LineOfSight.NormalAngle + 90",
																"within": "0.5",
																"angle-2": "270"
															}
														}
													],
													"actions": [
														{
															"callFunction": "ChangeGroundColor",
															"sid": 627228323641974,
															"parameters": [
																"250",
																"200",
																"0"
															]
														}
													],
													"sid": 346085857363573
												}
											]
										}
									]
								}
							],
							"isOrBlock": true
						},
						{
							"eventType": "comment",
							"text": "Change the level color palette by combing three values (red, green and blue) that will be applied smoothly with a set of tween animations."
						},
						{
							"functionName": "ChangeGroundColor",
							"functionDescription": "",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "NewRed",
									"type": "number",
									"initialValue": "0",
									"comment": "",
									"sid": 643053321004904
								},
								{
									"name": "NewGreen",
									"type": "number",
									"initialValue": "0",
									"comment": "",
									"sid": 834716292582902
								},
								{
									"name": "NewBlue",
									"type": "number",
									"initialValue": "0",
									"comment": "",
									"sid": 616068314088688
								}
							],
							"eventType": "function-block",
							"conditions": [],
							"actions": [
								{
									"id": "tween-value",
									"objectClass": "Ground",
									"sid": 188597228898160,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"Red\"",
										"start-value": "Red",
										"end-value": "NewRed",
										"time": "ANIMATIONDURATION",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no"
									}
								},
								{
									"id": "tween-value",
									"objectClass": "Ground",
									"sid": 136658577355758,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"Green\"",
										"start-value": "Green",
										"end-value": "NewGreen",
										"time": "ANIMATIONDURATION",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no"
									}
								},
								{
									"id": "tween-value",
									"objectClass": "Ground",
									"sid": 292498921962213,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"Blue\"",
										"start-value": "Blue",
										"end-value": "NewBlue",
										"time": "ANIMATIONDURATION",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no"
									}
								}
							],
							"sid": 752310111805322
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-playing",
									"objectClass": "Ground",
									"sid": 212653906714325,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"Red\""
									}
								},
								{
									"id": "is-playing",
									"objectClass": "Ground",
									"sid": 529519331439763,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"Green\""
									}
								},
								{
									"id": "is-playing",
									"objectClass": "Ground",
									"sid": 537767235128632,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"Blue\""
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 448357367476631,
									"parameters": {
										"variable": "Red",
										"value": "Ground.Tween.Value(\"Red\")"
									}
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 886925409315880,
									"parameters": {
										"variable": "Green",
										"value": "Ground.Tween.Value(\"Green\")"
									}
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 869852728260948,
									"parameters": {
										"variable": "Blue",
										"value": "Ground.Tween.Value(\"Blue\")"
									}
								},
								{
									"id": "set-effect-parameter",
									"objectClass": "Ground",
									"sid": 794434290691465,
									"parameters": {
										"effect": "\"ReplaceSolidColor\"",
										"parameter-index": "1",
										"value": "rgbEx255(Red, Green, Blue)"
									}
								}
							],
							"sid": 948298988865456,
							"isOrBlock": true
						},
						{
							"eventType": "comment",
							"text": "Once the animation is complete, give control back to the player and apply the new angle of gravity to it."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "PlayerCollision",
									"sid": 666796006981282,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"AnimationDuration\""
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Re-enable the platform behavior."
								},
								{
									"id": "set-enabled",
									"objectClass": "PlayerCollision",
									"sid": 460951310085752,
									"behaviorType": "Platform",
									"parameters": {
										"state": "enabled"
									}
								},
								{
									"type": "comment",
									"text": "Reset both movement vectors."
								},
								{
									"id": "set-vector-x",
									"objectClass": "PlayerCollision",
									"sid": 604064902128081,
									"behaviorType": "Platform",
									"parameters": {
										"vector-x": "0"
									}
								},
								{
									"id": "set-vector-y",
									"objectClass": "PlayerCollision",
									"sid": 785174219420810,
									"behaviorType": "Platform",
									"parameters": {
										"vector-y": "0"
									}
								},
								{
									"type": "comment",
									"text": "Apply the angle of gravity."
								},
								{
									"id": "set-angle-of-gravity",
									"objectClass": "PlayerCollision",
									"sid": 568311966620116,
									"behaviorType": "Platform",
									"parameters": {
										"angle": "Self.Angle + 90"
									}
								}
							],
							"sid": 782280440033358
						}
					],
					"sid": 314874636339678
				}
			],
			"sid": 438447210557978
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Teleporter",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Setup the teleporter collision by moving it on top of the teleporter platform."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-created",
							"objectClass": "TeleporterCollision",
							"sid": 691960503749229
						}
					],
					"actions": [
						{
							"id": "set-position-to-another-object",
							"objectClass": "TeleporterCollision",
							"sid": 929543292806089,
							"parameters": {
								"object": "TeleporterPlatform",
								"image-point-optional": "\"Collider\""
							}
						}
					],
					"sid": 998371177364058
				},
				{
					"eventType": "comment",
					"text": "If the player collides with the teleporter while it's charged, destroy the player and display a big white flash."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "PlayerCollision",
							"sid": 632223383188225,
							"parameters": {
								"object": "TeleporterCollision"
							}
						},
						{
							"id": "is-boolean-instance-variable-set",
							"objectClass": "TeleporterCollision",
							"sid": 763642753172528,
							"parameters": {
								"instance-variable": "Charged"
							}
						}
					],
					"actions": [
						{
							"id": "set-boolean-instvar",
							"objectClass": "TeleporterCollision",
							"sid": 215487575064132,
							"parameters": {
								"instance-variable": "Charged",
								"value": "false"
							}
						},
						{
							"id": "destroy",
							"objectClass": "PlayerCollision",
							"sid": 738698704844020
						},
						{
							"id": "spawn-another-object",
							"objectClass": "TeleporterPlatform",
							"sid": 413478467066809,
							"parameters": {
								"object": "TeleporterFlash",
								"layer": "\"World\"",
								"image-point": "\"Flash\"",
								"create-hierarchy": false
							}
						}
					],
					"sid": 444812351366441
				},
				{
					"eventType": "comment",
					"text": "Adjust the flash size to make sure it matches the ceiling height."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-created",
							"objectClass": "TeleporterFlash",
							"sid": 475468299004326
						}
					],
					"actions": [
						{
							"id": "set-size",
							"objectClass": "TeleporterFlash",
							"sid": 784168343081722,
							"parameters": {
								"width": "16",
								"height": "0"
							}
						},
						{
							"id": "cast-ray",
							"objectClass": "TeleporterFlash",
							"sid": 494566479424157,
							"behaviorType": "LineOfSight",
							"parameters": {
								"from-x": "Self.X",
								"from-y": "Self.Y",
								"to-x": "Self.X",
								"to-y": "Self.Y-Self.LineOfSight.Range",
								"use-collision-cells": true
							}
						}
					],
					"sid": 984648318403167,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "ray-intersected",
									"objectClass": "TeleporterFlash",
									"sid": 589851470152846,
									"behaviorType": "LineOfSight"
								}
							],
							"actions": [
								{
									"id": "tween-one-property",
									"objectClass": "TeleporterFlash",
									"sid": 760751268097194,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"HeightUp\"",
										"property": "offsetHeight",
										"end-value": "Self.LineOfSight.HitDistance",
										"time": "0.25",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no"
									}
								}
							],
							"sid": 852766279747460
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Destroy the flash after its animation is over."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-tweens-finished",
							"objectClass": "TeleporterFlash",
							"sid": 173939981726896,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"HeightUp\""
							}
						}
					],
					"actions": [
						{
							"id": "tween-one-property",
							"objectClass": "TeleporterFlash",
							"sid": 724912976711776,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"WidthDown\"",
								"property": "offsetWidth",
								"end-value": "0",
								"time": "0.25",
								"ease": "easeinoutsine",
								"destroy-on-complete": "yes",
								"loop": "no",
								"ping-pong": "no"
							}
						}
					],
					"sid": 735183857432216
				}
			],
			"sid": 865963099006963
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Camera",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "How fast the camera will track the player."
				},
				{
					"eventType": "variable",
					"name": "SPEED",
					"type": "number",
					"initialValue": "0.1",
					"comment": "",
					"isStatic": true,
					"isConstant": true,
					"sid": 910891188181431
				},
				{
					"eventType": "comment",
					"text": "Constantly move the camera towards the player position, but using linear interpolation for a very smooth motion."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 742960399605355
						}
					],
					"actions": [
						{
							"id": "set-position",
							"objectClass": "Camera",
							"sid": 805863869767319,
							"parameters": {
								"x": "lerp(Self.X, PlayerCollision.ImagePointX(\"Center\"), SPEED*60*dt)",
								"y": "lerp(Self.Y, PlayerCollision.ImagePointY(\"Center\"), SPEED*60*dt)"
							}
						}
					],
					"sid": 435649057504302
				}
			],
			"sid": 552517355456284
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Spike",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Restart the game if the player collides with a spike, in other words it's game over."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "PlayerCollision",
							"sid": 174515758362378,
							"parameters": {
								"object": "Spike"
							}
						}
					],
					"actions": [
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 699463130295548
						}
					],
					"sid": 358273904108520
				}
			],
			"sid": 269062095261804
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Restart",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Force the game to restart for testing purposes only."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 886860410172297,
							"parameters": {
								"key": 82
							}
						},
						{
							"id": "on-button-pressed",
							"objectClass": "Gamepad",
							"sid": 549166494317235,
							"parameters": {
								"gamepad": "0",
								"button": "start-menu"
							}
						}
					],
					"actions": [
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 259241878741840
						}
					],
					"sid": 261502125594386,
					"isOrBlock": true
				}
			],
			"sid": 876242795795519
		}
	],
	"sid": 703169307524782
}