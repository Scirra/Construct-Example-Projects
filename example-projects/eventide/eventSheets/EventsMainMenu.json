{
	"name": "EventsMainMenu",
	"events": [
		{
			"eventType": "comment",
			"text": "Made by Forsteri Studios\n\nFelipe Vaiano Calderan - Programmer\nX: @fvcalderan\nE-mail: fvcalderan@gmail.com\n\nWesley Andrade - Artist\nX: @andrart7\nE-mail: wesleymatos1989@gmail.com"
		},
		{
			"eventType": "comment",
			"text": "Settings."
		},
		{
			"eventType": "variable",
			"name": "BGM_MENU_VOLUME",
			"type": "number",
			"initialValue": "-5",
			"comment": "BGM volume (if playing).",
			"isStatic": false,
			"isConstant": true,
			"sid": 231661573455909
		},
		{
			"eventType": "variable",
			"name": "SFX_VOLUME",
			"type": "number",
			"initialValue": "-5",
			"comment": "SFX volume (if playing).",
			"isStatic": false,
			"isConstant": true,
			"sid": 919907478075928
		},
		{
			"eventType": "comment",
			"text": "Menu variables."
		},
		{
			"eventType": "variable",
			"name": "menuInputFocus",
			"type": "string",
			"initialValue": "Boot",
			"comment": "Which part of the menu the player is currently controlling.",
			"isStatic": false,
			"isConstant": false,
			"sid": 896718543738012
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Main Menu Tools",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Change description text."
				},
				{
					"functionName": "ChangeDescription",
					"functionDescription": "Change description text",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "text",
							"type": "string",
							"initialValue": "",
							"comment": "Change description to this text",
							"sid": 800423348361463
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 705356557668130,
							"parameters": {
								"object": "TextGeneric",
								"expression": "TextGeneric.TagAt(0) = \"Description\""
							}
						}
					],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "TextGeneric",
							"sid": 353989725102507,
							"parameters": {
								"text": "text"
							}
						}
					],
					"sid": 191150911810235
				},
				{
					"eventType": "comment",
					"text": "Change soul counter text."
				},
				{
					"functionName": "ChangeSoulCounter",
					"functionDescription": "Change soul counter text",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "text",
							"type": "string",
							"initialValue": "",
							"comment": "Change description to this text",
							"sid": 885621710770151
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 620302763159938,
							"parameters": {
								"object": "TextGeneric",
								"expression": "TextGeneric.TagAt(0) = \"Souls\""
							}
						}
					],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "TextGeneric",
							"sid": 641144438682371,
							"parameters": {
								"text": "text"
							}
						}
					],
					"sid": 839689721283330
				}
			],
			"sid": 606886199502804
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Player Profile Setup",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Save player profile."
				},
				{
					"functionName": "SaveProfile",
					"functionDescription": "Save player profile",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": true,
					"functionParameters": [],
					"eventType": "function-block",
					"conditions": [],
					"actions": [
						{
							"id": "set-item",
							"objectClass": "LocalStorage",
							"sid": 705302230873698,
							"parameters": {
								"key": "\"Profile\"",
								"value": "DictProfile.AsJSON"
							}
						}
					],
					"sid": 905130303256570
				},
				{
					"eventType": "comment",
					"text": "Update all UI elements according to profile data."
				},
				{
					"functionName": "updateMenuUI",
					"functionDescription": "Update all UI elements according to profile data",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "moveSelector",
							"type": "boolean",
							"initialValue": "true",
							"comment": "Move button selector.",
							"sid": 818031074870831
						}
					],
					"eventType": "function-block",
					"conditions": [],
					"actions": [
						{
							"callFunction": "ChangeSoulCounter",
							"sid": 584213339196843,
							"parameters": [
								"zeropad(DictProfile.Get(\"Souls\"), 5)"
							]
						}
					],
					"sid": 324235966343075,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-boolean-eventvar",
									"objectClass": "System",
									"sid": 808374673680992,
									"parameters": {
										"variable": "moveSelector"
									}
								}
							],
							"actions": [
								{
									"callFunction": "moveToButton",
									"sid": 141524787790503,
									"parameters": [
										"MenuButtonSelector.currentButton"
									]
								}
							],
							"sid": 372718500161934
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 595984582783143,
									"parameters": {
										"object": "MenuButton"
									}
								},
								{
									"id": "pick-children",
									"objectClass": "MenuButton",
									"sid": 743868452293132,
									"parameters": {
										"child": "MenuButtonLevel",
										"which": "own"
									}
								}
							],
							"actions": [
								{
									"id": "set-animation-frame",
									"objectClass": "MenuButtonLevel",
									"sid": 483287958930723,
									"parameters": {
										"frame-number": "int(DictProfile.Get(MenuButton.TagAt(0)))"
									}
								}
							],
							"sid": 731037740155194
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 910207703311580,
									"parameters": {
										"object": "MenuButton",
										"expression": "MenuButton.TagAt(0) = \"ToggleMute\""
									}
								}
							],
							"actions": [
								{
									"id": "set-animation-frame",
									"objectClass": "MenuButton",
									"sid": 884063599303316,
									"parameters": {
										"frame-number": "DictProfile.Get(\"Sound\")"
									}
								}
							],
							"sid": 509771258342829
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Start player profile setup process."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 663817342308626
						}
					],
					"actions": [
						{
							"id": "check-item-exists",
							"objectClass": "LocalStorage",
							"sid": 825906074919165,
							"parameters": {
								"key": "\"Profile\""
							}
						}
					],
					"sid": 755264847978678
				},
				{
					"eventType": "comment",
					"text": "If the player already has a profile, load it."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-item-exists",
							"objectClass": "LocalStorage",
							"sid": 484133021769861,
							"parameters": {
								"key": "\"Profile\""
							}
						}
					],
					"actions": [
						{
							"id": "get-item",
							"objectClass": "LocalStorage",
							"sid": 144658624600000,
							"parameters": {
								"key": "\"Profile\""
							}
						}
					],
					"sid": 980824592354084
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-item-get",
							"objectClass": "LocalStorage",
							"sid": 242984271612644,
							"parameters": {
								"key": "\"Profile\""
							}
						}
					],
					"actions": [
						{
							"id": "load",
							"objectClass": "DictProfile",
							"sid": 245250995862964,
							"parameters": {
								"json": "LocalStorage.ItemValue"
							}
						},
						{
							"callFunction": "updateMenuUI",
							"sid": 785471937741475,
							"parameters": [
								false
							]
						}
					],
					"sid": 711116654105328
				},
				{
					"eventType": "comment",
					"text": "Otherwise, create a new profile."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-item-missing",
							"objectClass": "LocalStorage",
							"sid": 645808766949699,
							"parameters": {
								"key": "\"Profile\""
							}
						}
					],
					"actions": [
						{
							"id": "request-project-file",
							"objectClass": "AJAX",
							"sid": 561646905206400,
							"parameters": {
								"tag": "\"DefaultProfile\"",
								"file": "DefaultProfile.json"
							}
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 969210680450204
						},
						{
							"id": "load",
							"objectClass": "DictProfile",
							"sid": 755724068705722,
							"parameters": {
								"json": "AJAX.LastData"
							}
						},
						{
							"callFunction": "SaveProfile",
							"sid": 754396049479154
						},
						{
							"callFunction": "updateMenuUI",
							"sid": 872686505824692,
							"parameters": [
								false
							]
						}
					],
					"sid": 474571724023730
				}
			],
			"sid": 707056824999900
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Title Screen",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Setup title screen."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 520310440562361
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Preload music."
						},
						{
							"id": "preload",
							"objectClass": "Audio",
							"sid": 428366189669578,
							"parameters": {
								"audio-file": "elevatorshaft"
							}
						},
						{
							"id": "preload",
							"objectClass": "Audio",
							"sid": 259223428519817,
							"parameters": {
								"audio-file": "hallowquest"
							}
						},
						{
							"type": "comment",
							"text": "Set starting camera position."
						},
						{
							"id": "set-position",
							"objectClass": "MenuCam",
							"sid": 218394022175618,
							"parameters": {
								"x": "LayoutHeight/2",
								"y": "LayoutWidth/2"
							}
						},
						{
							"type": "comment",
							"text": "Make \"Press SPACE\" text flash."
						},
						{
							"id": "flash",
							"objectClass": "TextPressSpace",
							"sid": 870537195405636,
							"behaviorType": "Flash",
							"parameters": {
								"on-time": "0.3",
								"off-time": "0.2",
								"duration": "Infinity"
							}
						},
						{
							"type": "comment",
							"text": "Generate a random scenario for the menu."
						},
						{
							"callFunction": "genRandomScenario",
							"sid": 480115040637893,
							"parameters": [
								true
							]
						},
						{
							"type": "comment",
							"text": "Write title."
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 524566912348916,
							"parameters": {
								"seconds": "1.0"
							}
						},
						{
							"id": "typewriter-text",
							"objectClass": "TextTitle",
							"sid": 635625499232474,
							"parameters": {
								"text": "\"EVENTIDE\"",
								"duration": "0.5"
							}
						},
						{
							"id": "typewriter-text",
							"objectClass": "TextTitleShadow",
							"sid": 361212441833590,
							"parameters": {
								"text": "\"EVENTIDE\"",
								"duration": "0.5"
							}
						},
						{
							"type": "comment",
							"text": "Hide fader."
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 699379748909924,
							"parameters": {
								"seconds": "1.0"
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "Fader",
							"sid": 844326304213547,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"HideFader\"",
								"property": "offsetOpacity",
								"end-value": "0",
								"time": "1",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 915166995691501
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 788387505453740,
							"parameters": {
								"variable": "menuInputFocus",
								"value": "\"Title\""
							}
						}
					],
					"sid": 864498051610483
				},
				{
					"eventType": "comment",
					"text": "Go to main menu."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 454985686621251,
							"parameters": {
								"key": 32
							}
						},
						{
							"id": "on-button-pressed",
							"objectClass": "Gamepad",
							"sid": 361213427705509,
							"parameters": {
								"gamepad": "0",
								"button": "button-a"
							}
						}
					],
					"actions": [],
					"sid": 746500392488484,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 769475739690782,
									"parameters": {
										"value": "menuInputFocus = \"Title\""
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Change input focus to menuTransition."
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 997601261975954,
									"parameters": {
										"variable": "menuInputFocus",
										"value": "\"menuTransition\""
									}
								},
								{
									"type": "comment",
									"text": "Play accept audio."
								},
								{
									"id": "play",
									"objectClass": "Audio",
									"sid": 124699847259007,
									"parameters": {
										"audio-file": "menu_accept",
										"loop": "not-looping",
										"volume": "DictProfile.Get(\"Sound\") = 1 ? SFX_VOLUME : -Infinity",
										"stereo-pan": "0",
										"tag-optional": "\"sfx\""
									}
								},
								{
									"type": "comment",
									"text": "Start playing main menu theme."
								},
								{
									"id": "play",
									"objectClass": "Audio",
									"sid": 754545940447544,
									"parameters": {
										"audio-file": "elevatorshaft",
										"loop": "looping",
										"volume": "-Infinity",
										"stereo-pan": "0",
										"tag-optional": "\"bgm\""
									}
								},
								{
									"id": "fade-volume",
									"objectClass": "Audio",
									"sid": 197173177034718,
									"parameters": {
										"tag": "\"bgm\"",
										"db": "DictProfile.Get(\"Sound\") = 1 ? BGM_MENU_VOLUME : -Infinity",
										"duration": "1",
										"ending": "keep-playing"
									}
								},
								{
									"type": "comment",
									"text": "Hide title and press SPACE."
								},
								{
									"id": "tween-one-property",
									"objectClass": "TextPressSpace",
									"sid": 427180923882939,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"HidePressSpaceText\"",
										"property": "offsetOpacity",
										"end-value": "0",
										"time": "0.25",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "TextTitle",
									"sid": 242596322392762,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"HideTitleText\"",
										"property": "offsetOpacity",
										"end-value": "0",
										"time": "0.25",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"type": "comment",
									"text": "Move title up, and change layer."
								},
								{
									"id": "wait-for-previous-actions",
									"objectClass": "System",
									"sid": 133524099533626
								},
								{
									"id": "set-y",
									"objectClass": "TextTitle",
									"sid": 446500722006052,
									"parameters": {
										"y": "160"
									}
								},
								{
									"id": "move-to-layer",
									"objectClass": "TextTitleShadow",
									"sid": 164818387877836,
									"parameters": {
										"layer": "\"Menu\""
									}
								},
								{
									"id": "move-to-layer",
									"objectClass": "TextTitle",
									"sid": 861142634138159,
									"parameters": {
										"layer": "\"Menu\""
									}
								},
								{
									"type": "comment",
									"text": "Show menu items."
								},
								{
									"id": "tween-one-property",
									"objectClass": "MenuButton",
									"sid": 606777606751083,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ShowMenuButtons\"",
										"property": "offsetOpacity",
										"end-value": "100",
										"time": "0.25",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "MenuButtonSelector",
									"sid": 765587896701362,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ShowMenuButtons\"",
										"property": "offsetOpacity",
										"end-value": "100",
										"time": "0.25",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "TextGeneric",
									"sid": 102427665225899,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ShowDescriptionText\"",
										"property": "offsetOpacity",
										"end-value": "100",
										"time": "0.25",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "TextTitle",
									"sid": 276331844751403,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ShowTitleText\"",
										"property": "offsetOpacity",
										"end-value": "100",
										"time": "0.25",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"type": "comment",
									"text": "Change input focus to the main menu."
								},
								{
									"id": "wait-for-previous-actions",
									"objectClass": "System",
									"sid": 842652929181439
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 433831820985869,
									"parameters": {
										"variable": "menuInputFocus",
										"value": "\"Menu\""
									}
								}
							],
							"sid": 441114004377721
						}
					],
					"isOrBlock": true
				}
			],
			"sid": 646732213765499
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Main Menu",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "variable",
					"name": "resetProgress",
					"type": "number",
					"initialValue": "0",
					"comment": "Reset progress fill",
					"isStatic": true,
					"isConstant": false,
					"sid": 692950093533168
				},
				{
					"eventType": "comment",
					"text": "Move selection to a given button."
				},
				{
					"functionName": "moveToButton",
					"functionDescription": "Move selection to a given button",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "button",
							"type": "string",
							"initialValue": "",
							"comment": "Button to move to",
							"sid": 174205352233078
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 720313889601620,
							"parameters": {
								"object": "MenuButton",
								"expression": "MenuButton.TagAt(0) = button"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Update selector."
						},
						{
							"id": "set-position-to-another-object",
							"objectClass": "MenuButtonSelector",
							"sid": 442729011862569,
							"parameters": {
								"object": "MenuButton",
								"image-point-optional": "0"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "MenuButtonSelector",
							"sid": 835697620138997,
							"parameters": {
								"instance-variable": "currentButton",
								"value": "button"
							}
						},
						{
							"type": "comment",
							"text": "Play change audio."
						},
						{
							"id": "play",
							"objectClass": "Audio",
							"sid": 412949438373896,
							"parameters": {
								"audio-file": "menu_change",
								"loop": "not-looping",
								"volume": "DictProfile.Get(\"Sound\") = 1 ? SFX_VOLUME : -Infinity",
								"stereo-pan": "0",
								"tag-optional": "\"sfx\""
							}
						}
					],
					"sid": 148025226912658,
					"children": [
						{
							"eventType": "comment",
							"text": "Show soul cost depending on the level."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "MenuButton",
									"sid": 240581288725336,
									"parameters": {
										"instance-variable": "soulCost",
										"comparison": 1,
										"value": "-1"
									}
								}
							],
							"actions": [],
							"sid": 549747924423966,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "evaluate-expression",
											"objectClass": "System",
											"sid": 886882352036450,
											"parameters": {
												"value": "DictProfile.Get(button) = 3"
											}
										}
									],
									"actions": [
										{
											"callFunction": "ChangeDescription",
											"sid": 127329257244997,
											"parameters": [
												"MenuButton.upgradedDesc"
											]
										}
									],
									"sid": 229268651356991
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 855480508739261
										}
									],
									"actions": [
										{
											"callFunction": "ChangeDescription",
											"sid": 208613237712912,
											"parameters": [
												"replace(MenuButton.description, \"###\", str(MenuButton.soulCost * (1 + int(DictProfile.Get(button)))))"
											]
										}
									],
									"sid": 453579927532966
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Ignore soul cost."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 440288938886416
								}
							],
							"actions": [
								{
									"callFunction": "ChangeDescription",
									"sid": 516667458478041,
									"parameters": [
										"MenuButton.description"
									]
								}
							],
							"sid": 220987012381090
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Setup starting opacities."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 775164168960478
						}
					],
					"actions": [
						{
							"id": "set-opacity",
							"objectClass": "MenuButton",
							"sid": 795154422374303,
							"parameters": {
								"opacity": "0"
							}
						},
						{
							"id": "set-opacity",
							"objectClass": "MenuButtonSelector",
							"sid": 835863088521404,
							"parameters": {
								"opacity": "0"
							}
						},
						{
							"id": "set-opacity",
							"objectClass": "TextGeneric",
							"sid": 199546181108664,
							"parameters": {
								"opacity": "0"
							}
						}
					],
					"sid": 459995554721401
				},
				{
					"eventType": "comment",
					"text": "Change selection (keyboard)."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-any-key-pressed",
							"objectClass": "Keyboard",
							"sid": 255012301901854
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 817950742052392,
							"parameters": {
								"value": "menuInputFocus = \"Menu\""
							}
						},
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 573367326998756,
							"parameters": {
								"object": "MenuButton",
								"expression": "MenuButton.TagAt(0) = MenuButtonSelector.currentButton"
							}
						}
					],
					"actions": [],
					"sid": 778146669457005,
					"children": [
						{
							"eventType": "comment",
							"text": "Left."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 884056293690484,
									"parameters": {
										"key": 37
									}
								}
							],
							"actions": [
								{
									"callFunction": "moveToButton",
									"sid": 475057085912690,
									"parameters": [
										"MenuButton.leftPress"
									]
								}
							],
							"sid": 262823035834852
						},
						{
							"eventType": "comment",
							"text": "Right."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 790531120930945
								},
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 922925640821273,
									"parameters": {
										"key": 39
									}
								}
							],
							"actions": [
								{
									"callFunction": "moveToButton",
									"sid": 361292282676354,
									"parameters": [
										"MenuButton.rightPress"
									]
								}
							],
							"sid": 965897351773023
						},
						{
							"eventType": "comment",
							"text": "Up."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 879832008129894
								},
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 296988818101216,
									"parameters": {
										"key": 38
									}
								}
							],
							"actions": [
								{
									"callFunction": "moveToButton",
									"sid": 655129908503958,
									"parameters": [
										"MenuButton.upPress"
									]
								}
							],
							"sid": 666774004821685
						},
						{
							"eventType": "comment",
							"text": "Down."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 197309509110246
								},
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 585290287458560,
									"parameters": {
										"key": 40
									}
								}
							],
							"actions": [
								{
									"callFunction": "moveToButton",
									"sid": 345739093101866,
									"parameters": [
										"MenuButton.downPress"
									]
								}
							],
							"sid": 703618602261534
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Change selection (gamepad)."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-any-button-pressed",
							"objectClass": "Gamepad",
							"sid": 690529435418415,
							"parameters": {
								"gamepad": "0"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 849718285341453,
							"parameters": {
								"value": "menuInputFocus = \"Menu\""
							}
						},
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 376250870091559,
							"parameters": {
								"object": "MenuButton",
								"expression": "MenuButton.TagAt(0) = MenuButtonSelector.currentButton"
							}
						}
					],
					"actions": [],
					"sid": 568970372355360,
					"children": [
						{
							"eventType": "comment",
							"text": "Left."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 184599088400838,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-left"
									}
								}
							],
							"actions": [
								{
									"callFunction": "moveToButton",
									"sid": 180942045884231,
									"parameters": [
										"MenuButton.leftPress"
									]
								}
							],
							"sid": 246157484779401
						},
						{
							"eventType": "comment",
							"text": "Right."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 310135325565771
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 306243506073792,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-right"
									}
								}
							],
							"actions": [
								{
									"callFunction": "moveToButton",
									"sid": 983631199842162,
									"parameters": [
										"MenuButton.rightPress"
									]
								}
							],
							"sid": 425340241411267
						},
						{
							"eventType": "comment",
							"text": "Up."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 128506672317715
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 841816330148943,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-up"
									}
								}
							],
							"actions": [
								{
									"callFunction": "moveToButton",
									"sid": 111923897842892,
									"parameters": [
										"MenuButton.upPress"
									]
								}
							],
							"sid": 575162355761669
						},
						{
							"eventType": "comment",
							"text": "Down."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 122346196084155
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 436301924915590,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-down"
									}
								}
							],
							"actions": [
								{
									"callFunction": "moveToButton",
									"sid": 542637959744923,
									"parameters": [
										"MenuButton.downPress"
									]
								}
							],
							"sid": 803084948033312
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Select."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 616856173315438,
							"parameters": {
								"key": 32
							}
						},
						{
							"id": "on-button-pressed",
							"objectClass": "Gamepad",
							"sid": 509411240876585,
							"parameters": {
								"gamepad": "0",
								"button": "button-a"
							}
						}
					],
					"actions": [],
					"sid": 931525370152316,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 363281777492266,
									"parameters": {
										"value": "menuInputFocus = \"Menu\""
									}
								}
							],
							"actions": [],
							"sid": 812235113739429,
							"children": [
								{
									"eventType": "comment",
									"text": "Start game."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "MenuButtonSelector",
											"sid": 308519391996303,
											"parameters": {
												"instance-variable": "currentButton",
												"comparison": 0,
												"value": "\"StartGame\""
											}
										}
									],
									"actions": [
										{
											"type": "comment",
											"text": "Play accept audio."
										},
										{
											"id": "play",
											"objectClass": "Audio",
											"sid": 899552777251343,
											"parameters": {
												"audio-file": "menu_accept",
												"loop": "not-looping",
												"volume": "DictProfile.Get(\"Sound\") = 1 ? SFX_VOLUME : -Infinity",
												"stereo-pan": "0",
												"tag-optional": "\"sfx\""
											}
										},
										{
											"type": "comment",
											"text": "Change input focus."
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 428542250387361,
											"parameters": {
												"variable": "menuInputFocus",
												"value": "\"Starting\""
											}
										},
										{
											"type": "comment",
											"text": "Fade out menu music."
										},
										{
											"id": "fade-volume",
											"objectClass": "Audio",
											"sid": 711441191313140,
											"parameters": {
												"tag": "\"bgm\"",
												"db": "-Infinity",
												"duration": "1",
												"ending": "stop"
											}
										},
										{
											"type": "comment",
											"text": "Hide menu."
										},
										{
											"id": "tween-one-property",
											"objectClass": "Fader",
											"sid": 432285362139588,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"ShowFader\"",
												"property": "offsetOpacity",
												"end-value": "100",
												"time": "1",
												"ease": "easeinoutsine",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										},
										{
											"type": "comment",
											"text": "Start the game."
										},
										{
											"id": "wait-for-previous-actions",
											"objectClass": "System",
											"sid": 114436999877853
										},
										{
											"id": "go-to-layout",
											"objectClass": "System",
											"sid": 919475661774166,
											"parameters": {
												"layout": "Game"
											}
										}
									],
									"sid": 689070925016607
								},
								{
									"eventType": "comment",
									"text": "Toggle mute."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 318122250715778
										},
										{
											"id": "compare-instance-variable",
											"objectClass": "MenuButtonSelector",
											"sid": 526227929872414,
											"parameters": {
												"instance-variable": "currentButton",
												"comparison": 0,
												"value": "\"ToggleMute\""
											}
										},
										{
											"id": "pick-by-evaluate",
											"objectClass": "System",
											"sid": 733077686306481,
											"parameters": {
												"object": "MenuButton",
												"expression": "MenuButton.TagAt(0) = \"ToggleMute\""
											}
										}
									],
									"actions": [],
									"sid": 109060892327588,
									"children": [
										{
											"eventType": "comment",
											"text": "Unmute."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-value",
													"objectClass": "DictProfile",
													"sid": 569012004332031,
													"parameters": {
														"key": "\"Sound\"",
														"comparison": 0,
														"value": "0"
													}
												}
											],
											"actions": [
												{
													"id": "set-key",
													"objectClass": "DictProfile",
													"sid": 991482110908651,
													"parameters": {
														"key": "\"Sound\"",
														"value": "1"
													}
												},
												{
													"id": "set-animation-frame",
													"objectClass": "MenuButton",
													"sid": 511467728769647,
													"parameters": {
														"frame-number": "1"
													}
												},
												{
													"id": "fade-volume",
													"objectClass": "Audio",
													"sid": 674180625660530,
													"parameters": {
														"tag": "\"bgm\"",
														"db": "BGM_MENU_VOLUME",
														"duration": "0.1",
														"ending": "keep-playing"
													}
												},
												{
													"callFunction": "SaveProfile",
													"sid": 737309793937618
												}
											],
											"sid": 909549304005532
										},
										{
											"eventType": "comment",
											"text": "Mute."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "else",
													"objectClass": "System",
													"sid": 266919408469303
												},
												{
													"id": "compare-value",
													"objectClass": "DictProfile",
													"sid": 979952553209872,
													"parameters": {
														"key": "\"Sound\"",
														"comparison": 0,
														"value": "1"
													}
												}
											],
											"actions": [
												{
													"id": "set-key",
													"objectClass": "DictProfile",
													"sid": 392126470495929,
													"parameters": {
														"key": "\"Sound\"",
														"value": "0"
													}
												},
												{
													"id": "set-animation-frame",
													"objectClass": "MenuButton",
													"sid": 448883728503275,
													"parameters": {
														"frame-number": "0"
													}
												},
												{
													"id": "fade-volume",
													"objectClass": "Audio",
													"sid": 957955664221185,
													"parameters": {
														"tag": "\"bgm\"",
														"db": "-Infinity",
														"duration": "0.1",
														"ending": "keep-playing"
													}
												},
												{
													"callFunction": "SaveProfile",
													"sid": 744318597814735
												}
											],
											"sid": 946613798621868
										}
									]
								},
								{
									"eventType": "comment",
									"text": "Upgrade skill."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 925924961305166
										},
										{
											"id": "compare-instance-variable",
											"objectClass": "MenuButtonSelector",
											"sid": 459507600553114,
											"parameters": {
												"instance-variable": "currentButton",
												"comparison": 1,
												"value": "\"ResetProgress\""
											}
										},
										{
											"id": "compare-instance-variable",
											"objectClass": "MenuButtonSelector",
											"sid": 110494554401845,
											"parameters": {
												"instance-variable": "currentButton",
												"comparison": 1,
												"value": "\"ToggleMute\""
											}
										}
									],
									"actions": [],
									"sid": 722738804777826,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "pick-by-evaluate",
													"objectClass": "System",
													"sid": 301438573403208,
													"parameters": {
														"object": "MenuButton",
														"expression": "MenuButton.TagAt(0) = MenuButtonSelector.currentButton"
													}
												},
												{
													"id": "pick-children",
													"objectClass": "MenuButton",
													"sid": 150081500773760,
													"parameters": {
														"child": "MenuButtonLevel",
														"which": "own"
													}
												}
											],
											"actions": [],
											"sid": 683366841583258,
											"children": [
												{
													"eventType": "comment",
													"text": "Player can upgrade the skill."
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "evaluate-expression",
															"objectClass": "System",
															"sid": 792741604749370,
															"parameters": {
																"value": "int(DictProfile.Get(\"Souls\")) >= MenuButton.soulCost"
															}
														},
														{
															"id": "evaluate-expression",
															"objectClass": "System",
															"sid": 398417723096031,
															"parameters": {
																"value": "int(DictProfile.Get(MenuButtonSelector.currentButton)) < 3"
															}
														}
													],
													"actions": [
														{
															"type": "comment",
															"text": "Play accept audio."
														},
														{
															"id": "play",
															"objectClass": "Audio",
															"sid": 111845110188659,
															"parameters": {
																"audio-file": "menu_accept",
																"loop": "not-looping",
																"volume": "DictProfile.Get(\"Sound\") = 1 ? SFX_VOLUME : -Infinity",
																"stereo-pan": "0",
																"tag-optional": "\"sfx\""
															}
														},
														{
															"type": "comment",
															"text": "Deduct the upgrade's soul cost from the player's soul balance."
														},
														{
															"id": "set-key",
															"objectClass": "DictProfile",
															"sid": 816113029251502,
															"parameters": {
																"key": "\"Souls\"",
																"value": "int(Self.Get(\"Souls\")) - MenuButton.soulCost * (1 + int(Self.Get(MenuButtonSelector.currentButton)))"
															}
														},
														{
															"type": "comment",
															"text": "Increase skill level."
														},
														{
															"id": "set-key",
															"objectClass": "DictProfile",
															"sid": 257172684927045,
															"parameters": {
																"key": "MenuButtonSelector.currentButton",
																"value": "int(Self.Get(MenuButtonSelector.currentButton)) + 1"
															}
														},
														{
															"type": "comment",
															"text": "Save profile and update UI."
														},
														{
															"callFunction": "SaveProfile",
															"sid": 143900668941629
														},
														{
															"callFunction": "updateMenuUI",
															"sid": 660732696581491,
															"parameters": [
																true
															]
														}
													],
													"sid": 706220602513639
												},
												{
													"eventType": "comment",
													"text": "Player cannot upgrade the skill."
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "else",
															"objectClass": "System",
															"sid": 672948192306845
														}
													],
													"actions": [
														{
															"type": "comment",
															"text": "Play cancel audio."
														},
														{
															"id": "play",
															"objectClass": "Audio",
															"sid": 612462324128006,
															"parameters": {
																"audio-file": "menu_cancel",
																"loop": "not-looping",
																"volume": "DictProfile.Get(\"Sound\") = 1 ? SFX_VOLUME : -Infinity",
																"stereo-pan": "0",
																"tag-optional": "\"sfx\""
															}
														}
													],
													"sid": 268851231375602
												}
											]
										}
									]
								}
							]
						}
					],
					"isOrBlock": true
				},
				{
					"eventType": "comment",
					"text": "If the player holds space over MenuButton long enough, reset the progress."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 868969935771714,
							"parameters": {
								"key": 32
							}
						},
						{
							"id": "is-button-down",
							"objectClass": "Gamepad",
							"sid": 671885751796071,
							"parameters": {
								"gamepad": "0",
								"button": "button-a"
							}
						}
					],
					"actions": [],
					"sid": 643827644665593,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 737299060392086,
									"parameters": {
										"value": "menuInputFocus = \"Menu\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "MenuButtonSelector",
									"sid": 637545190935388,
									"parameters": {
										"instance-variable": "currentButton",
										"comparison": 0,
										"value": "\"ResetProgress\""
									}
								},
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 131745105494659,
									"parameters": {
										"object": "MenuButton",
										"expression": "MenuButton.TagAt(0) = \"ResetProgress\""
									}
								}
							],
							"actions": [
								{
									"id": "add-to-eventvar",
									"objectClass": "System",
									"sid": 934372584253819,
									"parameters": {
										"variable": "resetProgress",
										"value": "5 * dt"
									}
								},
								{
									"id": "set-animation-frame",
									"objectClass": "MenuButton",
									"sid": 165478487154656,
									"parameters": {
										"frame-number": "floor(resetProgress)"
									}
								}
							],
							"sid": 987968116940423,
							"children": [
								{
									"eventType": "comment",
									"text": "Reset progress data."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-animation-frame",
											"objectClass": "MenuButton",
											"sid": 393668317489794,
											"parameters": {
												"comparison": 0,
												"number": "11"
											}
										},
										{
											"id": "trigger-once-while-true",
											"objectClass": "System",
											"sid": 829729050420702
										}
									],
									"actions": [
										{
											"type": "comment",
											"text": "Change input focus."
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 870947879569627,
											"parameters": {
												"variable": "menuInputFocus",
												"value": "\"ResetProgress\""
											}
										},
										{
											"type": "comment",
											"text": "Play accept audio."
										},
										{
											"id": "play",
											"objectClass": "Audio",
											"sid": 173664771015965,
											"parameters": {
												"audio-file": "menu_accept",
												"loop": "not-looping",
												"volume": "DictProfile.Get(\"Sound\") = 1 ? SFX_VOLUME : -Infinity",
												"stereo-pan": "0",
												"tag-optional": "\"sfx\""
											}
										},
										{
											"type": "comment",
											"text": "Reset button animation."
										},
										{
											"id": "set-animation-frame",
											"objectClass": "MenuButton",
											"sid": 798111706442482,
											"parameters": {
												"frame-number": "0"
											}
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 847828428222860,
											"parameters": {
												"variable": "resetProgress",
												"value": "0"
											}
										},
										{
											"type": "comment",
											"text": "Clear storage."
										},
										{
											"id": "clear-storage",
											"objectClass": "LocalStorage",
											"sid": 337148817840317
										},
										{
											"type": "comment",
											"text": "Fade out menu music."
										},
										{
											"id": "fade-volume",
											"objectClass": "Audio",
											"sid": 260960188547605,
											"parameters": {
												"tag": "\"bgm\"",
												"db": "-Infinity",
												"duration": "1",
												"ending": "stop"
											}
										},
										{
											"type": "comment",
											"text": "Hide menu."
										},
										{
											"id": "tween-one-property",
											"objectClass": "Fader",
											"sid": 427512650329178,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"ShowFader\"",
												"property": "offsetOpacity",
												"end-value": "100",
												"time": "0.25",
												"ease": "easeinoutsine",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										},
										{
											"type": "comment",
											"text": "Restart the main menu layout."
										},
										{
											"id": "wait-for-previous-actions",
											"objectClass": "System",
											"sid": 482048113561033
										},
										{
											"id": "go-to-layout",
											"objectClass": "System",
											"sid": 784148844371549,
											"parameters": {
												"layout": "MainMenu"
											}
										},
										{
											"id": "reset-global-variables",
											"objectClass": "System",
											"sid": 707971114802615,
											"parameters": {
												"reset-static": true
											}
										}
									],
									"sid": 544077753641963
								}
							]
						}
					],
					"isOrBlock": true
				},
				{
					"eventType": "comment",
					"text": "Stop reset process."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 160344306942377
						},
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 437035637516084,
							"parameters": {
								"object": "MenuButton",
								"expression": "MenuButton.TagAt(0) = \"ResetProgress\""
							}
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 340481580654732,
							"parameters": {
								"variable": "resetProgress",
								"value": "0"
							}
						},
						{
							"id": "set-animation-frame",
							"objectClass": "MenuButton",
							"sid": 236347695811849,
							"parameters": {
								"frame-number": "0"
							}
						}
					],
					"sid": 750799836159451
				}
			],
			"sid": 618904946514205
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Title Screen / Main Menu camera",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "variable",
					"name": "camX",
					"type": "number",
					"initialValue": "0",
					"comment": "Camera X.",
					"isStatic": false,
					"isConstant": false,
					"sid": 668113583277097
				},
				{
					"eventType": "variable",
					"name": "camY",
					"type": "number",
					"initialValue": "0",
					"comment": "Camera Y.",
					"isStatic": false,
					"isConstant": false,
					"sid": 387035627149844
				},
				{
					"eventType": "comment",
					"text": "Update camera position."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 428772057638744
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 431317257745071,
							"parameters": {
								"variable": "camX",
								"value": "MenuCam.X"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 968584341703331,
							"parameters": {
								"variable": "camY",
								"value": "MenuCam.Y"
							}
						},
						{
							"id": "look-at-position",
							"objectClass": "3DCamera",
							"sid": 735238585683326,
							"parameters": {
								"cam-x": "lerp(3DCamera.CameraX, camX, CAMERA_SPEED * dt)",
								"cam-y": "lerp(3DCamera.CameraY, camY + 448, CAMERA_SPEED  * dt)",
								"cam-z": "lerp(3DCamera.CameraZ, CAMERA_Z, CAMERA_SPEED  * dt)",
								"look-x": "lerp(3DCamera.LookX, camX, CAMERA_SPEED  * dt)",
								"look-y": "lerp(3DCamera.LookY, camY, CAMERA_SPEED  * dt)",
								"look-z": "MenuCam.ZElevation",
								"up-x": "0",
								"up-y": "0",
								"up-z": "1"
							}
						},
						{
							"id": "set-position",
							"objectClass": "MenuCam",
							"sid": 433419870963922,
							"parameters": {
								"x": "LayoutWidth/2 + cos(MenuCam.currPos) * 4096",
								"y": "LayoutHeight/2 + sin(MenuCam.currPos) * 4096"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "MenuCam",
							"sid": 187256065691976,
							"parameters": {
								"instance-variable": "currPos",
								"value": "Self.currPos = 359 ? 0 : Self.currPos + 1 * dt"
							}
						}
					],
					"sid": 109097658199638
				}
			],
			"sid": 781314125542924
		}
	],
	"sid": 387880604404454
}