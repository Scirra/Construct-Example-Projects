{
	"name": "MainCode",
	"events": [
		{
			"eventType": "comment",
			"text": "Made by Viridino Studios (@ViridinoStudios)\n\nMateus Ferreira - Programmer\nTwitter: @BonzerKitten\nE-mail: ferreiramoreiramateus@gmail.com\n\nWesley Andrade - Artist\nTwitter: @andrart7\nE-mail: wesleymatos1989@gmail.com\n\nMade with the support of patrons on https://www.patreon.com/viridinostudios"
		},
		{
			"eventType": "comment",
			"text": "How fast each room will move towards the camera."
		},
		{
			"eventType": "variable",
			"name": "WALLSPEED",
			"type": "number",
			"initialValue": "0.35",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 729737093221570
		},
		{
			"eventType": "comment",
			"text": "How long each room will be."
		},
		{
			"eventType": "variable",
			"name": "ROOMHEIGHT",
			"type": "number",
			"initialValue": "64",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 984097923356864
		},
		{
			"eventType": "comment",
			"text": "How many rooms will be displayed at the same time, before the games starts to \"recycle\" them."
		},
		{
			"eventType": "variable",
			"name": "ROOMSPERLEVEL",
			"type": "number",
			"initialValue": "16",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 869947726801853
		},
		{
			"eventType": "comment",
			"text": "How fast the wind particles will move towards the camera."
		},
		{
			"eventType": "variable",
			"name": "WINDSPEED",
			"type": "number",
			"initialValue": "4",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 356885459626760
		},
		{
			"eventType": "comment",
			"text": "The current level/score of the player."
		},
		{
			"eventType": "variable",
			"name": "CurrentLevel",
			"type": "number",
			"initialValue": "1",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 724897130643293
		},
		{
			"eventType": "comment",
			"text": "Whether or not the player is alive."
		},
		{
			"eventType": "variable",
			"name": "Alive",
			"type": "boolean",
			"initialValue": "true",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 727155291734196
		},
		{
			"eventType": "comment",
			"text": "Whether or not the screen was touched at least one time."
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Controls",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Whether or not the player is pressing left."
				},
				{
					"eventType": "variable",
					"name": "InputLeft",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 485552327737571
				},
				{
					"eventType": "comment",
					"text": "Whether or not the player is pressing right."
				},
				{
					"eventType": "variable",
					"name": "InputRight",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 685385085672322
				},
				{
					"eventType": "comment",
					"text": "Whether or not the player is pressing up."
				},
				{
					"eventType": "variable",
					"name": "InputUp",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 104292455921210
				},
				{
					"eventType": "comment",
					"text": "Whether or not the player is pressing down."
				},
				{
					"eventType": "variable",
					"name": "InputDown",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 839725765894065
				},
				{
					"eventType": "comment",
					"text": "Vector calculated based on the horizontal input from the player (left and right)."
				},
				{
					"eventType": "variable",
					"name": "HorizontalAxis",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 901997363971921
				},
				{
					"eventType": "comment",
					"text": "Vector calculated based on the vertical input from the player (up and down)."
				},
				{
					"eventType": "variable",
					"name": "VerticalAxis",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 556645749342216
				},
				{
					"eventType": "comment",
					"text": "Take input from the keyboard and mouse if the game is not being played on a mobile device."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-on-mobile",
							"objectClass": "PlatformInfo",
							"sid": 319976434714044,
							"isInverted": true
						}
					],
					"actions": [],
					"sid": 845581004521749,
					"children": [
						{
							"eventType": "comment",
							"text": "Toggle the input left from the player."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 524522309603344,
									"parameters": {
										"key": 37
									}
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 316289330056771,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-left"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 518797925239967,
									"parameters": {
										"variable": "InputLeft",
										"value": "1"
									}
								}
							],
							"sid": 597682477756480,
							"isOrBlock": true
						},
						{
							"eventType": "comment",
							"text": "Toggle the input right from the player."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 105681764775625,
									"parameters": {
										"key": 39
									}
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 970330012843496,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-right"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 934274320862869,
									"parameters": {
										"variable": "InputRight",
										"value": "1"
									}
								}
							],
							"sid": 126580264481248,
							"isOrBlock": true
						},
						{
							"eventType": "comment",
							"text": "Toggle the input up from the player."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 632162465898182,
									"parameters": {
										"key": 38
									}
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 721096153934057,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-up"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 628963469872994,
									"parameters": {
										"variable": "InputUp",
										"value": "1"
									}
								}
							],
							"sid": 357130959689846,
							"isOrBlock": true
						},
						{
							"eventType": "comment",
							"text": "Toggle the input down from the player."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "key-is-down",
									"objectClass": "Keyboard",
									"sid": 108242649152791,
									"parameters": {
										"key": 40
									}
								},
								{
									"id": "is-button-down",
									"objectClass": "Gamepad",
									"sid": 509558515696193,
									"parameters": {
										"gamepad": "0",
										"button": "d-pad-down"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 557724854327699,
									"parameters": {
										"variable": "InputDown",
										"value": "1"
									}
								}
							],
							"sid": 402012144014431,
							"isOrBlock": true
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Take input from the gyroscope sensor if the game is being played on a mobile device."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-on-mobile",
							"objectClass": "PlatformInfo",
							"sid": 258377952756873
						}
					],
					"actions": [],
					"sid": 859770355852685,
					"children": [
						{
							"eventType": "comment",
							"text": "Reveal the content from the mobile controls layer, where there's some visual elements to help the player control the main character."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "trigger-once-while-true",
									"objectClass": "System",
									"sid": 549274299085106
								}
							],
							"actions": [
								{
									"id": "set-layer-visible",
									"objectClass": "System",
									"sid": 734904019748096,
									"parameters": {
										"layer": "\"MobileControls\"",
										"visibility": "visible"
									}
								}
							],
							"sid": 397973963068888
						},
						{
							"eventType": "comment",
							"text": "Constantly update position of the player's sight, which is first centered and then moved in all directions based on the gamma and beta values from the gyroscope sensor."
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "set-position",
									"objectClass": "Sight",
									"sid": 887623268272593,
									"parameters": {
										"x": "Center.X + Touch.Gamma",
										"y": "Center.Y + Touch.Beta - 50"
									}
								}
							],
							"sid": 872565989087903
						},
						{
							"eventType": "comment",
							"text": "If the sight is far enough from the center, move the character in the angle between the center and the sight."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 676305127920470,
									"parameters": {
										"first-value": "distance(Sight.X, Sight.Y, Center.X, Center.Y)",
										"comparison": 4,
										"second-value": "15"
									}
								}
							],
							"actions": [
								{
									"id": "set-angle",
									"objectClass": "Arrow",
									"sid": 876809076236333,
									"parameters": {
										"angle": "round(angle(Sight.X, Sight.Y, Center.X, Center.Y) / 90) * 90 + 180"
									}
								},
								{
									"type": "comment",
									"text": "Also make the direction arrow visible, so the player knows where he's moving next."
								},
								{
									"id": "set-visible",
									"objectClass": "Arrow",
									"sid": 350397944714243,
									"parameters": {
										"visibility": "visible"
									}
								}
							],
							"sid": 154213152849094,
							"children": [
								{
									"eventType": "comment",
									"text": "Toggle the input left from the player."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-within-angle",
											"objectClass": "Arrow",
											"sid": 118705983870919,
											"parameters": {
												"within": "0.5",
												"angle": "180"
											}
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 249390737986553,
											"parameters": {
												"variable": "InputLeft",
												"value": "1"
											}
										}
									],
									"sid": 121408372181517
								},
								{
									"eventType": "comment",
									"text": "Toggle the input right from the player."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-within-angle",
											"objectClass": "Arrow",
											"sid": 404765044508003,
											"parameters": {
												"within": "0.5",
												"angle": "0"
											}
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 445010068625375,
											"parameters": {
												"variable": "InputRight",
												"value": "1"
											}
										}
									],
									"sid": 989492355581774
								},
								{
									"eventType": "comment",
									"text": "Toggle the input up from the player."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-within-angle",
											"objectClass": "Arrow",
											"sid": 569977006856573,
											"parameters": {
												"within": "0.5",
												"angle": "-90"
											}
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 817109449712524,
											"parameters": {
												"variable": "InputUp",
												"value": "1"
											}
										}
									],
									"sid": 346114268869163
								},
								{
									"eventType": "comment",
									"text": "Toggle the input down from the player."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-within-angle",
											"objectClass": "Arrow",
											"sid": 833593505068053,
											"parameters": {
												"within": "0.5",
												"angle": "90"
											}
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 394984533020902,
											"parameters": {
												"variable": "InputDown",
												"value": "1"
											}
										}
									],
									"sid": 607368674807259
								}
							]
						},
						{
							"eventType": "comment",
							"text": "However, if the sight is not far enough from the center, hide the direction arrow."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 750790912266459
								}
							],
							"actions": [
								{
									"id": "set-visible",
									"objectClass": "Arrow",
									"sid": 391001117637614,
									"parameters": {
										"visibility": "invisible"
									}
								}
							],
							"sid": 238730428071454
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Constantly calculate both horizontal and vertical axis based on the previously store player input."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 724912151785086
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 200059967134828,
							"parameters": {
								"variable": "HorizontalAxis",
								"value": "InputRight - InputLeft"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 706830306221930,
							"parameters": {
								"variable": "VerticalAxis",
								"value": "InputDown - InputUp"
							}
						}
					],
					"sid": 273831042013930
				},
				{
					"eventType": "comment",
					"text": "Move the player left, right, up and down depending on the value stored in each axis, but only if the player is alive."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-boolean-eventvar",
							"objectClass": "System",
							"sid": 531233988786368,
							"parameters": {
								"variable": "Alive"
							}
						}
					],
					"actions": [],
					"sid": 863712753485040,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 777695634704668,
									"parameters": {
										"variable": "HorizontalAxis",
										"comparison": 0,
										"value": "-1"
									}
								}
							],
							"actions": [
								{
									"id": "simulate-control",
									"objectClass": "Player",
									"sid": 760064592677072,
									"behaviorType": "8Direction",
									"parameters": {
										"control": "left"
									}
								},
								{
									"id": "set-animation",
									"objectClass": "Player",
									"sid": 133374307825625,
									"parameters": {
										"animation": "\"Left\"",
										"from": "beginning"
									}
								},
								{
									"type": "comment",
									"text": "Also change the layout angle slightly for a more cinematic effect."
								},
								{
									"id": "set-layout-angle",
									"objectClass": "System",
									"sid": 614794527609701,
									"parameters": {
										"angle": "anglelerp(LayoutAngle, 5, 0.05 * 60 * dt)"
									}
								}
							],
							"sid": 463422716064404
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 490378976169896,
									"parameters": {
										"variable": "HorizontalAxis",
										"comparison": 0,
										"value": "1"
									}
								}
							],
							"actions": [
								{
									"id": "simulate-control",
									"objectClass": "Player",
									"sid": 301624679890703,
									"behaviorType": "8Direction",
									"parameters": {
										"control": "right"
									}
								},
								{
									"id": "set-animation",
									"objectClass": "Player",
									"sid": 726484616410141,
									"parameters": {
										"animation": "\"Right\"",
										"from": "beginning"
									}
								},
								{
									"type": "comment",
									"text": "Also change the layout angle slightly for a more cinematic effect."
								},
								{
									"id": "set-layout-angle",
									"objectClass": "System",
									"sid": 109216879111893,
									"parameters": {
										"angle": "anglelerp(LayoutAngle, -5, 0.05 * 60 * dt)"
									}
								}
							],
							"sid": 735186059679635
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 797698835160890,
									"parameters": {
										"variable": "VerticalAxis",
										"comparison": 0,
										"value": "-1"
									}
								}
							],
							"actions": [
								{
									"id": "simulate-control",
									"objectClass": "Player",
									"sid": 491699993461641,
									"behaviorType": "8Direction",
									"parameters": {
										"control": "up"
									}
								},
								{
									"id": "set-animation",
									"objectClass": "Player",
									"sid": 900933290910673,
									"parameters": {
										"animation": "\"Up\"",
										"from": "beginning"
									}
								}
							],
							"sid": 152464075658743
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 926803743011929,
									"parameters": {
										"variable": "VerticalAxis",
										"comparison": 0,
										"value": "1"
									}
								}
							],
							"actions": [
								{
									"id": "simulate-control",
									"objectClass": "Player",
									"sid": 832003968456520,
									"behaviorType": "8Direction",
									"parameters": {
										"control": "down"
									}
								},
								{
									"id": "set-animation",
									"objectClass": "Player",
									"sid": 270843233546593,
									"parameters": {
										"animation": "\"Down\"",
										"from": "beginning"
									}
								}
							],
							"sid": 535225789273790
						},
						{
							"eventType": "comment",
							"text": "If the player is currently moving, change its animation to match its angle of motion."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-moving",
									"objectClass": "Player",
									"sid": 886298567458566,
									"behaviorType": "8Direction"
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "Player",
									"sid": 988381249267020,
									"parameters": {
										"animation": "str(((round(Self.8Direction.MovingAngle / 90) * 90 )+ 360) % 360)",
										"from": "beginning"
									}
								}
							],
							"sid": 362530061865942
						},
						{
							"eventType": "comment",
							"text": "However, if the player is not moving, display an idle animation."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 445988501106433
								},
								{
									"id": "is-moving",
									"objectClass": "Player",
									"sid": 371541000520715,
									"behaviorType": "8Direction",
									"isInverted": true
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "Player",
									"sid": 600634380485633,
									"parameters": {
										"animation": "\"Idle\"",
										"from": "beginning"
									}
								}
							],
							"sid": 540467532127266
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "set-position",
									"objectClass": "Player",
									"sid": 324880414424576,
									"parameters": {
										"x": "clamp(Self.X, 0, LayoutWidth)",
										"y": "clamp(Self.Y, 0, LayoutHeight)"
									}
								}
							],
							"sid": 259694754692408
						}
					]
				},
				{
					"eventType": "comment",
					"text": "If there's no input from the player, reset the layout angle back to zero."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 775679487608841,
							"parameters": {
								"variable": "HorizontalAxis",
								"comparison": 0,
								"value": "0"
							}
						},
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 183745372606567,
							"parameters": {
								"variable": "VerticalAxis",
								"comparison": 0,
								"value": "0"
							}
						}
					],
					"actions": [
						{
							"id": "set-layout-angle",
							"objectClass": "System",
							"sid": 877935572865916,
							"parameters": {
								"angle": "anglelerp(LayoutAngle, 0, 0.05 * 60 * dt)"
							}
						}
					],
					"sid": 660844053898739
				}
			],
			"sid": 899939564685855
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Scene",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Setup the scene by starting a game loop timer that will be used to move most level related objects."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 378208433709934
						}
					],
					"actions": [
						{
							"id": "start-timer",
							"objectClass": "GameManager",
							"sid": 626999221117572,
							"behaviorType": "Timer",
							"parameters": {
								"duration": "WALLSPEED",
								"type": "regular",
								"tag": "\"GameLoop\""
							}
						}
					],
					"sid": 463102675594741,
					"children": [
						{
							"eventType": "comment",
							"text": "Also create a sequence of rooms, so the level looks like a long tunnel."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 872680476179791,
									"parameters": {
										"name": "\"Room\"",
										"start-index": "1",
										"end-index": "ROOMSPERLEVEL"
									}
								}
							],
							"actions": [
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 693159879236424,
									"parameters": {
										"object-to-create": "Room",
										"layer": "0",
										"x": "128",
										"y": "128",
										"create-hierarchy": false
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "Room",
									"sid": 202060154741293,
									"parameters": {
										"z": "-ROOMHEIGHT * loopindex"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "Room",
									"sid": 927753705684644,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"Move\"",
										"property": "offsetZElevation",
										"end-value": "Self.ZElevation + ROOMHEIGHT",
										"time": "WALLSPEED",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Room",
									"sid": 968299921895627,
									"parameters": {
										"instance-variable": "Index",
										"value": "loopindex(\"Room\")"
									}
								}
							],
							"sid": 162230364193910
						},
						{
							"eventType": "comment",
							"text": "Create a dark fog in the middle of the level, so it's not possible for the player to see where exactly it ends."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 216025302174626,
									"parameters": {
										"name": "\"DarkFog\"",
										"start-index": "1",
										"end-index": "20"
									}
								}
							],
							"actions": [
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 794522622122416,
									"parameters": {
										"object-to-create": "DarkFog",
										"layer": "0",
										"x": "128",
										"y": "128",
										"create-hierarchy": false
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "DarkFog",
									"sid": 887818105249073,
									"parameters": {
										"z": "(-ROOMHEIGHT * 2) - (8 * loopindex(\"DarkFog\"))"
									}
								},
								{
									"id": "set-opacity",
									"objectClass": "DarkFog",
									"sid": 175502045140476,
									"parameters": {
										"opacity": "5 * loopindex(\"DarkFog\")"
									}
								},
								{
									"id": "set-default-color",
									"objectClass": "DarkFog",
									"sid": 454620248878779,
									"parameters": {
										"color": "rgbEx255(0, 0, 0)"
									}
								},
								{
									"id": "set-angle",
									"objectClass": "DarkFog",
									"sid": 853385624519745,
									"parameters": {
										"angle": "90 * loopindex(\"DarkFog\")"
									}
								}
							],
							"sid": 663535536609230
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Constantly offset the dark fog texture, so it look like it's \"alive\"."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 275006958671899
						}
					],
					"actions": [
						{
							"id": "set-image-offset-x",
							"objectClass": "DarkFog",
							"sid": 400830361501812,
							"parameters": {
								"offset-x": "Self.ImageOffsetX + 1 * 60 * dt"
							}
						}
					],
					"sid": 535496132022041
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-tweens-finished",
							"objectClass": "Room",
							"sid": 115195092564677,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"Move\""
							}
						}
					],
					"actions": [],
					"sid": 676197637337333,
					"children": [
						{
							"eventType": "comment",
							"text": "When a room reaches the end of the level, destroy its pillar and move room back to the start, where it will be reused."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-z-elevation",
									"objectClass": "Room",
									"sid": 203501749012759,
									"parameters": {
										"which": "z-elevation",
										"comparison": 0,
										"z-elevation": "0"
									}
								}
							],
							"actions": [],
							"sid": 610956879403022,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "has-children",
											"objectClass": "Room",
											"sid": 853320335905884
										}
									],
									"actions": [],
									"sid": 654888574110726,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "pick-children",
													"objectClass": "Room",
													"sid": 782282852452652,
													"parameters": {
														"child": "Pillar",
														"which": "own"
													}
												}
											],
											"actions": [
												{
													"id": "remove-from-parent",
													"objectClass": "Pillar",
													"sid": 532091037248618
												},
												{
													"id": "tween-one-property",
													"objectClass": "Pillar",
													"sid": 155430743747334,
													"behaviorType": "Tween",
													"parameters": {
														"tags": "\"Move\"",
														"property": "offsetZElevation",
														"end-value": "Self.ZElevation + ROOMHEIGHT",
														"time": "WALLSPEED",
														"ease": "default",
														"destroy-on-complete": "no",
														"loop": "no",
														"ping-pong": "no"
													}
												},
												{
													"id": "tween-one-property",
													"objectClass": "Pillar",
													"sid": 934243993135956,
													"behaviorType": "Tween",
													"parameters": {
														"tags": "\"Fade\"",
														"property": "offsetOpacity",
														"end-value": "0",
														"time": "WALLSPEED / 4",
														"ease": "default",
														"destroy-on-complete": "yes",
														"loop": "no",
														"ping-pong": "no"
													}
												}
											],
											"sid": 457966911437094
										}
									]
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "set-z-elevation",
											"objectClass": "Room",
											"sid": 156249499620514,
											"parameters": {
												"z": "-ROOMHEIGHT * ROOMSPERLEVEL"
											}
										}
									],
									"sid": 670584471360663
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Start a new move animation, so it's always moving towards the camera."
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "tween-one-property",
									"objectClass": "Room",
									"sid": 535084932647934,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"Move\"",
										"property": "offsetZElevation",
										"end-value": "Self.ZElevation + ROOMHEIGHT",
										"time": "WALLSPEED",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no"
									}
								}
							],
							"sid": 775469826842225
						},
						{
							"eventType": "comment",
							"text": "Create a new pillar for the room, with a randomized angle and position."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 417008280392848,
									"parameters": {
										"first-value": "Room.ZElevation",
										"comparison": 0,
										"second-value": "-ROOMHEIGHT * ROOMSPERLEVEL"
									}
								}
							],
							"actions": [
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 239517816081521,
									"parameters": {
										"object-to-create": "Pillar",
										"layer": "\"World\"",
										"x": "LayoutWidth / 2",
										"y": "LayoutHeight / 2",
										"create-hierarchy": false
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "Pillar",
									"sid": 164102999352479,
									"parameters": {
										"z": "Room.ZElevation"
									}
								},
								{
									"id": "add-child",
									"objectClass": "Room",
									"sid": 688426488818441,
									"parameters": {
										"child": "Pillar",
										"transform-x": false,
										"transform-y": false,
										"transform-w": false,
										"transform-h": false,
										"transform-a": false,
										"transform-z-elevation": true,
										"destroy-with-parent": false
									}
								},
								{
									"id": "set-angle",
									"objectClass": "Pillar",
									"sid": 881053929609878,
									"parameters": {
										"angle": "choose(0, 90)"
									}
								},
								{
									"id": "move-at-angle",
									"objectClass": "Pillar",
									"sid": 260142911493160,
									"parameters": {
										"angle": "Self.Angle + 90",
										"distance": "random(-112, 112)"
									}
								}
							],
							"sid": 368081032187974
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Increase the level after each room and display it in the HUD."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-timer",
							"objectClass": "GameManager",
							"sid": 240535977236520,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"GameLoop\""
							}
						}
					],
					"actions": [
						{
							"id": "add-to-eventvar",
							"objectClass": "System",
							"sid": 604299619604200,
							"parameters": {
								"variable": "CurrentLevel",
								"value": "1"
							}
						},
						{
							"id": "set-text",
							"objectClass": "TextFont",
							"sid": 708600524874274,
							"parameters": {
								"text": "zeropad(CurrentLevel, 3)"
							}
						}
					],
					"sid": 869248858663025
				}
			],
			"sid": 766171204205812
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Collision",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Constantly check if the player is overlapping a pillar in all axis, including the Z one for depth."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 558899987229608
						}
					],
					"actions": [],
					"sid": 613705406664652,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 141209838426272,
									"parameters": {
										"object": "Pillar"
									}
								}
							],
							"actions": [],
							"sid": 788705684653218,
							"children": [
								{
									"eventType": "comment",
									"text": "If the player collides with a pillar, stop all game elements and display a death animation where the barrel explodes into multiple pieces."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-overlapping-another-object",
											"objectClass": "Player",
											"sid": 717713785281264,
											"parameters": {
												"object": "Pillar"
											}
										},
										{
											"id": "is-between-values",
											"objectClass": "System",
											"sid": 566258192294635,
											"parameters": {
												"value": "Player.ZElevation",
												"lower-bound": "Pillar.ZElevation",
												"upper-bound": "Pillar.ZElevation + Pillar.ZHeight"
											}
										},
										{
											"id": "compare-boolean-eventvar",
											"objectClass": "System",
											"sid": 953806158557013,
											"parameters": {
												"variable": "Alive"
											}
										}
									],
									"actions": [
										{
											"id": "set-boolean-eventvar",
											"objectClass": "System",
											"sid": 578107982209308,
											"parameters": {
												"variable": "Alive",
												"value": "false"
											}
										},
										{
											"id": "stop-all-tweens",
											"objectClass": "Pillar",
											"sid": 579575063716909,
											"behaviorType": "Tween"
										},
										{
											"id": "stop-all-tweens",
											"objectClass": "Room",
											"sid": 142749593834244,
											"behaviorType": "Tween"
										},
										{
											"id": "stop-timer",
											"objectClass": "GameManager",
											"sid": 664759027576091,
											"behaviorType": "Timer",
											"parameters": {
												"tag": "\"GameLoop\""
											}
										},
										{
											"id": "set-enabled",
											"objectClass": "Player",
											"sid": 289996915111072,
											"behaviorType": "8Direction",
											"parameters": {
												"state": "disabled"
											}
										},
										{
											"id": "set-animation",
											"objectClass": "Player",
											"sid": 174677419619304,
											"parameters": {
												"animation": "\"Dead\"",
												"from": "beginning"
											}
										},
										{
											"type": "comment",
											"text": "Display a texture full of cracks on the pillar's front face, it look like the impact broke it."
										},
										{
											"id": "set-face-object",
											"objectClass": "Pillar",
											"sid": 709169018086229,
											"parameters": {
												"face": "front",
												"object": "BrokenPillar"
											}
										},
										{
											"type": "comment",
											"text": "Also restart the game after two seconds, so there's enough time for the death animation to be displayed."
										},
										{
											"id": "start-timer",
											"objectClass": "GameManager",
											"sid": 749005528806398,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "2",
												"type": "once",
												"tag": "\"Restart\""
											}
										}
									],
									"sid": 868087034490686,
									"children": [
										{
											"eventType": "comment",
											"text": "All pieces are slightly randomized, by changing their angle of motion, moving speed and rotation speed."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "repeat",
													"objectClass": "System",
													"sid": 907415304801124,
													"parameters": {
														"count": "8"
													}
												}
											],
											"actions": [
												{
													"id": "spawn-another-object",
													"objectClass": "Player",
													"sid": 727424363265720,
													"parameters": {
														"object": "Plank",
														"layer": "\"Player\"",
														"image-point": "0",
														"create-hierarchy": false
													}
												},
												{
													"id": "set-angle-of-motion",
													"objectClass": "Plank",
													"sid": 338998190811843,
													"behaviorType": "Bullet",
													"parameters": {
														"angle": "random(270 - 60, 270 + 60)"
													}
												},
												{
													"id": "set-speed",
													"objectClass": "Plank",
													"sid": 475780685449545,
													"behaviorType": "Bullet",
													"parameters": {
														"speed": "random(128, 256)"
													}
												},
												{
													"id": "set-speed",
													"objectClass": "Plank",
													"sid": 185340139256842,
													"behaviorType": "Rotate",
													"parameters": {
														"speed": "random(-360, 360)"
													}
												},
												{
													"id": "move-to-object",
													"objectClass": "Plank",
													"sid": 474960520236598,
													"parameters": {
														"where": "behind",
														"object": "Player"
													}
												}
											],
											"sid": 477273802978497
										}
									]
								}
							]
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Once the restart timer is over, restart the game completely."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-timer",
							"objectClass": "GameManager",
							"sid": 799864965190292,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"Restart\""
							}
						}
					],
					"actions": [
						{
							"callFunction": "RestartGame",
							"sid": 102610931312161
						}
					],
					"sid": 525436709071729
				}
			],
			"sid": 494077455140452
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Wind",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Margin between the walls and each dust particle."
				},
				{
					"eventType": "variable",
					"name": "DUSTMARGIN",
					"type": "number",
					"initialValue": "4",
					"comment": "",
					"isStatic": true,
					"isConstant": true,
					"sid": 698273607861482
				},
				{
					"eventType": "comment",
					"text": "Create a dust particle at the end of the tunnel."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-x-seconds",
							"objectClass": "System",
							"sid": 907688870087703,
							"parameters": {
								"interval-seconds": "0.1"
							}
						}
					],
					"actions": [
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 365923825865777,
							"parameters": {
								"object-to-create": "Dust",
								"layer": "\"World\"",
								"x": "random(DUSTMARGIN, LayoutWidth - DUSTMARGIN)",
								"y": "random(DUSTMARGIN, LayoutHeight - DUSTMARGIN)",
								"create-hierarchy": false
							}
						},
						{
							"id": "set-z-elevation",
							"objectClass": "Dust",
							"sid": 825944568249138,
							"parameters": {
								"z": "-ROOMHEIGHT * ROOMSPERLEVEL"
							}
						}
					],
					"sid": 306651191170942
				},
				{
					"eventType": "comment",
					"text": "Margin between the walls and each skull."
				},
				{
					"eventType": "variable",
					"name": "SKULLSMARGIN",
					"type": "number",
					"initialValue": "32",
					"comment": "",
					"isStatic": true,
					"isConstant": true,
					"sid": 881328017726165
				},
				{
					"eventType": "comment",
					"text": "Create a skull that is attached to light at the end of the tunnel."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-x-seconds",
							"objectClass": "System",
							"sid": 119492567832079,
							"parameters": {
								"interval-seconds": "1"
							}
						}
					],
					"actions": [
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 214806693615190,
							"parameters": {
								"object-to-create": "Light",
								"layer": "\"World\"",
								"x": "random(SKULLSMARGIN, LayoutWidth - SKULLSMARGIN)",
								"y": "random(SKULLSMARGIN, LayoutHeight - SKULLSMARGIN)",
								"create-hierarchy": false
							}
						},
						{
							"id": "set-z-elevation",
							"objectClass": "Light",
							"sid": 298157140073641,
							"parameters": {
								"z": "-ROOMHEIGHT * ROOMSPERLEVEL"
							}
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 590222524429110,
							"parameters": {
								"object-to-create": "Skull",
								"layer": "\"World\"",
								"x": "Light.X",
								"y": "Light.Y",
								"create-hierarchy": false
							}
						},
						{
							"id": "set-z-elevation",
							"objectClass": "Skull",
							"sid": 339955170575870,
							"parameters": {
								"z": "-ROOMHEIGHT * ROOMSPERLEVEL"
							}
						},
						{
							"id": "add-child",
							"objectClass": "Skull",
							"sid": 415775316873661,
							"parameters": {
								"child": "Light",
								"transform-x": true,
								"transform-y": true,
								"transform-w": false,
								"transform-h": false,
								"transform-a": false,
								"transform-z-elevation": true,
								"destroy-with-parent": true
							}
						}
					],
					"sid": 695503317529286
				},
				{
					"eventType": "comment",
					"text": "Leave a bunch of slightly randomized jet fire particles behind the player barrel, but only while it's alive."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-boolean-eventvar",
							"objectClass": "System",
							"sid": 819840926450523,
							"parameters": {
								"variable": "Alive"
							}
						}
					],
					"actions": [],
					"sid": 706580423142061,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "every-x-seconds",
									"objectClass": "System",
									"sid": 844941708344178,
									"parameters": {
										"interval-seconds": "0.025"
									}
								}
							],
							"actions": [
								{
									"id": "spawn-another-object",
									"objectClass": "Player",
									"sid": 623205837022771,
									"parameters": {
										"object": "JetFire",
										"layer": "\"Player\"",
										"image-point": "0",
										"create-hierarchy": false
									}
								},
								{
									"id": "set-opacity",
									"objectClass": "JetFire",
									"sid": 976936279327313,
									"parameters": {
										"opacity": "0"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "JetFire",
									"sid": 885437164845188,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"FadeIn\"",
										"property": "offsetOpacity",
										"end-value": "100",
										"time": "0.1",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no"
									}
								},
								{
									"id": "set-size",
									"objectClass": "JetFire",
									"sid": 210449073745974,
									"parameters": {
										"width": "Self.Width + random(-4, 4)",
										"height": "Self.Height + random(-4, 4)"
									}
								}
							],
							"sid": 205009595239873
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Once a jet fire has finished its fade in animation, shrink it until it disappears."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-tweens-finished",
							"objectClass": "JetFire",
							"sid": 954993508996160,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"FadeIn\""
							}
						}
					],
					"actions": [
						{
							"id": "tween-two-properties",
							"objectClass": "JetFire",
							"sid": 953031132650728,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"SelfDestroy\"",
								"property": "size",
								"end-x": "0",
								"end-y": "0",
								"time": "0.15",
								"ease": "default",
								"destroy-on-complete": "yes",
								"loop": "no",
								"ping-pong": "no"
							}
						}
					],
					"sid": 748082388217211
				},
				{
					"eventType": "comment",
					"text": "Constantly move flying objects towards the camera, which will be destroyed when being too high."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 364205877043313
						}
					],
					"actions": [
						{
							"id": "set-z-elevation",
							"objectClass": "Flying",
							"sid": 697664867327032,
							"parameters": {
								"z": "Self.ZElevation + WINDSPEED * 60 * dt"
							}
						}
					],
					"sid": 920836209410607,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-z-elevation",
									"objectClass": "Flying",
									"sid": 462506246548426,
									"parameters": {
										"which": "z-elevation",
										"comparison": 5,
										"z-elevation": "64"
									}
								}
							],
							"actions": [
								{
									"id": "destroy",
									"objectClass": "Flying",
									"sid": 368193171430234
								}
							],
							"sid": 287358717782568
						}
					]
				}
			],
			"sid": 609042730295955
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Restart",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Restart the game for testing purposes."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 600455948401330,
							"parameters": {
								"key": 82
							}
						},
						{
							"id": "on-button-pressed",
							"objectClass": "Gamepad",
							"sid": 869097782014925,
							"parameters": {
								"gamepad": "0",
								"button": "start-menu"
							}
						}
					],
					"actions": [
						{
							"callFunction": "RestartGame",
							"sid": 135603393550632
						}
					],
					"sid": 269696636325603,
					"isOrBlock": true
				},
				{
					"eventType": "comment",
					"text": "Restart the game, but first reset the layout and all global variables, so there are no traces from previous sessions."
				},
				{
					"functionName": "RestartGame",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [],
					"eventType": "function-block",
					"conditions": [],
					"actions": [
						{
							"id": "set-layout-angle",
							"objectClass": "System",
							"sid": 166776562322073,
							"parameters": {
								"angle": "0"
							}
						},
						{
							"id": "reset-global-variables",
							"objectClass": "System",
							"sid": 878494093489601
						},
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 140296937883483
						}
					],
					"sid": 600484080616784
				}
			],
			"sid": 577418369707853
		}
	],
	"sid": 402004443649615
}