{
	"name": "MainCode",
	"events": [
		{
			"eventType": "comment",
			"text": "Made by Viridino Studios (@ViridinoStudios)\n\nMateus Ferreira - Programmer\nTwitter: @BonzerKitten\nE-mail: ferreiramoreiramateus@gmail.com\n\nWesley Andrade - Artist\nTwitter: @andrart7\nE-mail: wesleymatos1989@gmail.com\n\nMade with the support of patrons on https://www.patreon.com/viridinostudios"
		},
		{
			"eventType": "variable",
			"name": "PlayerDirection",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 160210955497828
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Player",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "group",
					"disabled": false,
					"title": "PlayerSetup",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Reset all global variables to make sure nothing from previous sessions will interfere the game."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-start-of-layout",
									"objectClass": "System",
									"sid": 796671218886728
								}
							],
							"actions": [
								{
									"id": "reset-global-variables",
									"objectClass": "System",
									"sid": 927961188957356,
									"parameters": {
										"reset-static": false
									}
								}
							],
							"sid": 717612525165036
						},
						{
							"eventType": "comment",
							"text": "Setup the player by adding its graphics as a child of the collider."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-created",
									"objectClass": "PlayerGraphics",
									"sid": 594730415360274
								}
							],
							"actions": [
								{
									"id": "set-position-to-another-object",
									"objectClass": "PlayerGraphics",
									"sid": 841884366138315,
									"parameters": {
										"object": "PlayerCollision",
										"image-point-optional": "0"
									}
								},
								{
									"id": "add-child",
									"objectClass": "PlayerCollision",
									"sid": 939307407835321,
									"parameters": {
										"child": "PlayerGraphics",
										"transform-x": true,
										"transform-y": true,
										"transform-w": false,
										"transform-h": false,
										"transform-a": false,
										"transform-o": false,
										"transform-z-elevation": false,
										"transform-visibility": false,
										"destroy-with-parent": true
									}
								}
							],
							"sid": 960983322737064
						},
						{
							"eventType": "comment",
							"text": "Constantly update and store the current player direction, so it can be used later for multiple situations."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 289626576519842,
									"parameters": {
										"first-value": "PlayerGraphics.Count",
										"comparison": 0,
										"second-value": "1"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 169784902340293,
									"parameters": {
										"variable": "PlayerDirection",
										"value": "sign(PlayerGraphics.Width)"
									}
								}
							],
							"sid": 478589958460144
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 344464537936998
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 725092179223972,
									"parameters": {
										"variable": "PlayerDirection",
										"value": "0"
									}
								}
							],
							"sid": 964949139436688
						}
					],
					"sid": 784603836528212
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "PlayerControls",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Only allow the the player to be controller if the animation state is set to zero, which means it's currently performing a sword attack or a shield bash."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "PlayerCollision",
									"sid": 475867262694410,
									"parameters": {
										"instance-variable": "AnimationState",
										"comparison": 0,
										"value": "0"
									}
								}
							],
							"actions": [],
							"sid": 704107519043488,
							"children": [
								{
									"eventType": "comment",
									"text": "Move the player to the left while also mirroring its graphics."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "key-is-down",
											"objectClass": "Keyboard",
											"sid": 472196552826405,
											"parameters": {
												"key": 37
											}
										},
										{
											"id": "is-button-down",
											"objectClass": "Gamepad",
											"sid": 318035243518184,
											"parameters": {
												"gamepad": "0",
												"button": "d-pad-left"
											}
										}
									],
									"actions": [
										{
											"id": "simulate-control",
											"objectClass": "PlayerCollision",
											"sid": 145117159134019,
											"behaviorType": "Platform",
											"parameters": {
												"control": "left"
											}
										},
										{
											"id": "set-mirrored",
											"objectClass": "PlayerGraphics",
											"sid": 446404989093262,
											"parameters": {
												"state": "mirrored"
											}
										}
									],
									"sid": 791869818850232,
									"isOrBlock": true
								},
								{
									"eventType": "comment",
									"text": "Move the player to the right while also \"unmirroring\" its graphics."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "key-is-down",
											"objectClass": "Keyboard",
											"sid": 244575050708298,
											"parameters": {
												"key": 39
											}
										},
										{
											"id": "is-button-down",
											"objectClass": "Gamepad",
											"sid": 750294980707974,
											"parameters": {
												"gamepad": "0",
												"button": "d-pad-right"
											}
										}
									],
									"actions": [
										{
											"id": "simulate-control",
											"objectClass": "PlayerCollision",
											"sid": 999501730902601,
											"behaviorType": "Platform",
											"parameters": {
												"control": "right"
											}
										},
										{
											"id": "set-mirrored",
											"objectClass": "PlayerGraphics",
											"sid": 559164273452861,
											"parameters": {
												"state": "not-mirrored"
											}
										}
									],
									"sid": 278841320416831,
									"isOrBlock": true
								},
								{
									"eventType": "comment",
									"text": "Make the player jump."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "key-is-down",
											"objectClass": "Keyboard",
											"sid": 486653425041526,
											"parameters": {
												"key": 90
											}
										},
										{
											"id": "is-button-down",
											"objectClass": "Gamepad",
											"sid": 112174172028568,
											"parameters": {
												"gamepad": "0",
												"button": "button-a"
											}
										}
									],
									"actions": [
										{
											"id": "simulate-control",
											"objectClass": "PlayerCollision",
											"sid": 141784798777932,
											"behaviorType": "Platform",
											"parameters": {
												"control": "jump"
											}
										}
									],
									"sid": 907095893826795,
									"isOrBlock": true
								}
							]
						}
					],
					"sid": 284160857497412
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "PlayerAnimations",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "PlayerCollision",
									"sid": 308719804032649,
									"parameters": {
										"instance-variable": "AnimationState",
										"comparison": 0,
										"value": "0"
									}
								}
							],
							"actions": [],
							"sid": 663965398650769,
							"children": [
								{
									"eventType": "comment",
									"text": "Change the player's animation states depending on what the player is currently doing."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-on-floor",
											"objectClass": "PlayerCollision",
											"sid": 715752787715104,
											"behaviorType": "Platform"
										}
									],
									"actions": [],
									"sid": 339876809714591,
									"children": [
										{
											"eventType": "comment",
											"text": "Walk animation."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "is-moving",
													"objectClass": "PlayerCollision",
													"sid": 165527992073922,
													"behaviorType": "Platform"
												}
											],
											"actions": [
												{
													"id": "set-animation",
													"objectClass": "PlayerGraphics",
													"sid": 699741653423935,
													"parameters": {
														"animation": "\"Walk\"",
														"from": "beginning"
													}
												}
											],
											"sid": 941975645329028
										},
										{
											"eventType": "comment",
											"text": "Idle animation."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "else",
													"objectClass": "System",
													"sid": 582609374391094
												}
											],
											"actions": [
												{
													"id": "set-animation",
													"objectClass": "PlayerGraphics",
													"sid": 613209738719712,
													"parameters": {
														"animation": "\"Idle\"",
														"from": "beginning"
													}
												}
											],
											"sid": 346233446649663
										}
									]
								},
								{
									"eventType": "comment",
									"text": "Jump animation."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-jumping",
											"objectClass": "PlayerCollision",
											"sid": 667613943759726,
											"behaviorType": "Platform"
										}
									],
									"actions": [
										{
											"id": "set-animation",
											"objectClass": "PlayerGraphics",
											"sid": 147487775573083,
											"parameters": {
												"animation": "\"Jump\"",
												"from": "beginning"
											}
										}
									],
									"sid": 745608428074989
								},
								{
									"eventType": "comment",
									"text": "Fall animation."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-falling",
											"objectClass": "PlayerCollision",
											"sid": 514102591134905,
											"behaviorType": "Platform"
										}
									],
									"actions": [
										{
											"id": "set-animation",
											"objectClass": "PlayerGraphics",
											"sid": 947507013441965,
											"parameters": {
												"animation": "\"Fall\"",
												"from": "beginning"
											}
										}
									],
									"sid": 261825487983702
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Reset animation state after the player is done with shield bashing or attacking."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "PlayerCollision",
									"sid": 666787257242408,
									"parameters": {
										"instance-variable": "AnimationState",
										"comparison": 0,
										"value": "1"
									}
								}
							],
							"actions": [],
							"sid": 193840931342522,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "on-animation-finished",
											"objectClass": "PlayerGraphics",
											"sid": 660495843536795,
											"parameters": {
												"animation": "\"ShieldBash\""
											}
										}
									],
									"actions": [
										{
											"id": "set-instvar-value",
											"objectClass": "PlayerCollision",
											"sid": 214747425345474,
											"parameters": {
												"instance-variable": "AnimationState",
												"value": "0"
											}
										}
									],
									"sid": 840880024833532
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "PlayerCollision",
									"sid": 865123484007571,
									"parameters": {
										"instance-variable": "AnimationState",
										"comparison": 0,
										"value": "2"
									}
								}
							],
							"actions": [],
							"sid": 712169864306657,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "on-animation-finished",
											"objectClass": "PlayerGraphics",
											"sid": 178232005643826,
											"parameters": {
												"animation": "\"SwordAttack\""
											}
										}
									],
									"actions": [
										{
											"id": "set-instvar-value",
											"objectClass": "PlayerCollision",
											"sid": 255976419909113,
											"parameters": {
												"instance-variable": "AnimationState",
												"value": "0"
											}
										}
									],
									"sid": 253993649585998
								}
							]
						}
					],
					"sid": 921833879566076
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "PlayerParticles",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Leave a small trail of step dust behind the player every 0.1 seconds while moving on the floor."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-moving",
									"objectClass": "PlayerCollision",
									"sid": 463773975665385,
									"behaviorType": "Platform"
								},
								{
									"id": "is-on-floor",
									"objectClass": "PlayerCollision",
									"sid": 383060393704507,
									"behaviorType": "Platform"
								}
							],
							"actions": [],
							"sid": 521940510826457,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "every-x-seconds",
											"objectClass": "System",
											"sid": 254108591978941,
											"parameters": {
												"interval-seconds": "0.1"
											}
										}
									],
									"actions": [
										{
											"id": "spawn-another-object",
											"objectClass": "PlayerGraphics",
											"sid": 226978426828197,
											"parameters": {
												"object": "StepDust",
												"layer": "\"World\"",
												"image-point": "\"FeetCenter\"",
												"create-hierarchy": false,
												"template-name": "\"\""
											}
										},
										{
											"id": "set-width",
											"objectClass": "StepDust",
											"sid": 805112612424629,
											"parameters": {
												"width": "Self.Width*PlayerDirection"
											}
										}
									],
									"sid": 893563852312136
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-animation-finished",
									"objectClass": "StepDust",
									"sid": 443964818959479,
									"parameters": {
										"animation": "\"Default\""
									}
								}
							],
							"actions": [
								{
									"id": "destroy",
									"objectClass": "StepDust",
									"sid": 433745691568687
								}
							],
							"sid": 261645271310484
						},
						{
							"eventType": "comment",
							"text": "Spawn a land dust below the player after each landing."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-landed",
									"objectClass": "PlayerCollision",
									"sid": 513471347308033,
									"behaviorType": "Platform"
								}
							],
							"actions": [
								{
									"id": "spawn-another-object",
									"objectClass": "PlayerGraphics",
									"sid": 869546836893335,
									"parameters": {
										"object": "LandDust",
										"layer": "\"World\"",
										"image-point": "\"FeetCenter\"",
										"create-hierarchy": false,
										"template-name": "\"\""
									}
								}
							],
							"sid": 875075074408110
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-animation-finished",
									"objectClass": "LandDust",
									"sid": 971115755149152,
									"parameters": {
										"animation": "\"Default\""
									}
								}
							],
							"actions": [
								{
									"id": "destroy",
									"objectClass": "LandDust",
									"sid": 112490050948336
								}
							],
							"sid": 281393043506154
						},
						{
							"eventType": "comment",
							"text": "Spawn a jump dust below the player after each jump."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-jump",
									"objectClass": "PlayerCollision",
									"sid": 787812836955384,
									"behaviorType": "Platform"
								}
							],
							"actions": [
								{
									"id": "spawn-another-object",
									"objectClass": "PlayerGraphics",
									"sid": 873561206086230,
									"parameters": {
										"object": "JumpDust",
										"layer": "\"World\"",
										"image-point": "\"FeetCenter\"",
										"create-hierarchy": false,
										"template-name": "\"\""
									}
								}
							],
							"sid": 214279439234230
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-animation-finished",
									"objectClass": "JumpDust",
									"sid": 407400319118616,
									"parameters": {
										"animation": "\"Default\""
									}
								}
							],
							"actions": [
								{
									"id": "destroy",
									"objectClass": "JumpDust",
									"sid": 599271824549731
								}
							],
							"sid": 366382635788223
						}
					],
					"sid": 858999474960428
				}
			],
			"sid": 438447210557978
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Particles",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Once a clone is destroyed, leave a blade glow behind."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-destroyed",
							"objectClass": "Clone",
							"sid": 599664952124474
						}
					],
					"actions": [
						{
							"id": "spawn-another-object",
							"objectClass": "Clone",
							"sid": 341684487781439,
							"parameters": {
								"object": "BladeGlow",
								"layer": "\"World\"",
								"image-point": "0",
								"create-hierarchy": false,
								"template-name": "\"\""
							}
						}
					],
					"sid": 699017243428517
				},
				{
					"eventType": "comment",
					"text": "Randomize the blade glow angle for a more dynamic effect."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-created",
							"objectClass": "BladeGlow",
							"sid": 200945815395563
						}
					],
					"actions": [
						{
							"id": "set-angle",
							"objectClass": "BladeGlow",
							"sid": 750221633433735,
							"parameters": {
								"angle": "choose(0, 90, 180, 270)"
							}
						}
					],
					"sid": 328047924781362
				},
				{
					"eventType": "comment",
					"text": "When a particle is done with its animation, destroy it to prevent any sort of CPU overload."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-animation-finished",
							"objectClass": "BladeGlow",
							"sid": 530583584601905,
							"parameters": {
								"animation": "\"Default\""
							}
						}
					],
					"actions": [
						{
							"id": "destroy",
							"objectClass": "BladeGlow",
							"sid": 125668889349841
						}
					],
					"sid": 613881021494447
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-animation-finished",
							"objectClass": "ShieldBash",
							"sid": 455507947013592,
							"parameters": {
								"animation": "\"Default\""
							}
						}
					],
					"actions": [
						{
							"id": "destroy",
							"objectClass": "ShieldBash",
							"sid": 437494835113417
						}
					],
					"sid": 525326701842899
				}
			],
			"sid": 943101734631819
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Camera",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "How fast the camera will track the player."
				},
				{
					"eventType": "variable",
					"name": "SPEED",
					"type": "number",
					"initialValue": "0.1",
					"comment": "",
					"isStatic": true,
					"isConstant": true,
					"sid": 910891188181431
				},
				{
					"eventType": "comment",
					"text": "Constantly move the camera towards the player position, but using linear interpolation for a very smooth motion."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 742960399605355
						}
					],
					"actions": [
						{
							"id": "set-position",
							"objectClass": "Camera",
							"sid": 201411129099622,
							"parameters": {
								"x": "lerp(Self.X, PlayerCollision.ImagePointX(\"Center\"), SPEED*60*dt)",
								"y": "lerp(Self.Y, PlayerCollision.ImagePointY(\"Center\"), SPEED*60*dt)"
							}
						}
					],
					"sid": 435649057504302
				}
			],
			"sid": 552517355456284
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Spike",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Restart the game if the player collides with a spike, in other words it's game over."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "PlayerCollision",
							"sid": 174515758362378,
							"parameters": {
								"object": "HarmfulArea"
							}
						}
					],
					"actions": [
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 699463130295548
						}
					],
					"sid": 358273904108520
				}
			],
			"sid": 269062095261804
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "TimeFreeze",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Whether or not the time freeze skill is charged and ready to be used by the player."
				},
				{
					"eventType": "variable",
					"name": "Charged",
					"type": "boolean",
					"initialValue": "true",
					"comment": "",
					"isStatic": true,
					"isConstant": false,
					"sid": 356284673235815
				},
				{
					"eventType": "comment",
					"text": "How long it takes for a crate to be released after being frozen."
				},
				{
					"eventType": "variable",
					"name": "COOLDOWN",
					"type": "number",
					"initialValue": "4",
					"comment": "",
					"isStatic": true,
					"isConstant": true,
					"sid": 314993104580913
				},
				{
					"eventType": "comment",
					"text": "In how many directions the chains will be sent when a crate is frozen."
				},
				{
					"eventType": "variable",
					"name": "CHAINDIRECTIONS",
					"type": "number",
					"initialValue": "8",
					"comment": "",
					"isStatic": true,
					"isConstant": true,
					"sid": 165804839571262
				},
				{
					"eventType": "comment",
					"text": "How much each chain can vary regarding its angle."
				},
				{
					"eventType": "variable",
					"name": "CHAINRANDOMMAGNITUDE",
					"type": "number",
					"initialValue": "15",
					"comment": "",
					"isStatic": true,
					"isConstant": true,
					"sid": 552606989885786
				},
				{
					"eventType": "comment",
					"text": "Reset the charge state and adjust the physics stepping mode to frame rate independent."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 898094781287383
						}
					],
					"actions": [
						{
							"id": "set-boolean-eventvar",
							"objectClass": "System",
							"sid": 700495467639244,
							"parameters": {
								"variable": "Charged",
								"value": "true"
							}
						}
					],
					"sid": 633500115599547,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-random-instance",
									"objectClass": "System",
									"sid": 725076246082165,
									"parameters": {
										"object": "Crate"
									}
								}
							],
							"actions": [
								{
									"id": "set-stepping-mode",
									"objectClass": "Crate",
									"sid": 612089300090036,
									"behaviorType": "Physics",
									"parameters": {
										"mode": "framerate-independent"
									}
								}
							],
							"sid": 316522204661496
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Setup each arrow on the scene."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-created",
							"objectClass": "Arrow",
							"sid": 882925513149132
						}
					],
					"actions": [
						{
							"id": "set-position-to-another-object",
							"objectClass": "Arrow",
							"sid": 508540169463354,
							"parameters": {
								"object": "Crate",
								"image-point-optional": "0"
							}
						},
						{
							"id": "add-child",
							"objectClass": "Crate",
							"sid": 263716949139438,
							"parameters": {
								"child": "Arrow",
								"transform-x": true,
								"transform-y": true,
								"transform-w": false,
								"transform-h": false,
								"transform-a": false,
								"transform-o": false,
								"transform-z-elevation": false,
								"transform-visibility": false,
								"destroy-with-parent": true
							}
						},
						{
							"callFunction": "UpdateArrow",
							"sid": 166603969117462,
							"parameters": [
								"Crate.UID"
							]
						}
					],
					"sid": 104678974137274
				},
				{
					"eventType": "comment",
					"text": "Shoot a freezing clone forward, but only if the player is charged and is not already performing a sword attack or shield bash."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 126080664369248,
							"parameters": {
								"key": 88
							}
						},
						{
							"id": "on-button-pressed",
							"objectClass": "Gamepad",
							"sid": 794184501126956,
							"parameters": {
								"gamepad": "0",
								"button": "button-b"
							}
						}
					],
					"actions": [],
					"sid": 765163147939429,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-boolean-eventvar",
									"objectClass": "System",
									"sid": 567513281357813,
									"parameters": {
										"variable": "Charged"
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "PlayerCollision",
									"sid": 436844790643109,
									"parameters": {
										"instance-variable": "AnimationState",
										"comparison": 0,
										"value": "0"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Update the player's state."
								},
								{
									"id": "set-boolean-eventvar",
									"objectClass": "System",
									"sid": 667422366569569,
									"parameters": {
										"variable": "Charged",
										"value": "false"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "PlayerCollision",
									"sid": 559566965046410,
									"parameters": {
										"instance-variable": "AnimationState",
										"value": "1"
									}
								},
								{
									"type": "comment",
									"text": "Display the shield bash animation."
								},
								{
									"id": "set-animation",
									"objectClass": "PlayerGraphics",
									"sid": 678662786574334,
									"parameters": {
										"animation": "\"ShieldBash\"",
										"from": "beginning"
									}
								},
								{
									"type": "comment",
									"text": "Spawn freezing clone and make it move forward based on the player direction."
								},
								{
									"id": "spawn-another-object",
									"objectClass": "PlayerGraphics",
									"sid": 539626297547433,
									"parameters": {
										"object": "Clone",
										"layer": "\"World\"",
										"image-point": "\"Clone\"",
										"create-hierarchy": false,
										"template-name": "\"\""
									}
								},
								{
									"id": "set-width",
									"objectClass": "Clone",
									"sid": 110874442222072,
									"parameters": {
										"width": "Self.ImageWidth * PlayerDirection"
									}
								},
								{
									"id": "set-angle-of-motion",
									"objectClass": "Clone",
									"sid": 998877880421377,
									"behaviorType": "Bullet",
									"parameters": {
										"angle": "angle(0, 0, PlayerDirection, 0)"
									}
								},
								{
									"id": "move-to-bottom",
									"objectClass": "Clone",
									"sid": 152139902325565
								},
								{
									"type": "comment",
									"text": "Spawn shield bash flash effect."
								},
								{
									"id": "spawn-another-object",
									"objectClass": "PlayerGraphics",
									"sid": 142361802998996,
									"parameters": {
										"object": "ShieldBash",
										"layer": "\"World\"",
										"image-point": "\"Clone\"",
										"create-hierarchy": false,
										"template-name": "\"\""
									}
								},
								{
									"id": "set-width",
									"objectClass": "ShieldBash",
									"sid": 746491123487943,
									"parameters": {
										"width": "Self.Width * PlayerDirection"
									}
								}
							],
							"sid": 350662447250679
						}
					],
					"isOrBlock": true
				},
				{
					"eventType": "comment",
					"text": "Leave a trail of fading clones behind the main one if there are any in the scene."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 310920177289687,
							"parameters": {
								"first-value": "Clone.Count",
								"comparison": 4,
								"second-value": "0"
							}
						}
					],
					"actions": [],
					"sid": 237707230620706,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "every-x-seconds",
									"objectClass": "System",
									"sid": 768536804253066,
									"parameters": {
										"interval-seconds": "0.1"
									}
								}
							],
							"actions": [
								{
									"id": "spawn-another-object",
									"objectClass": "Clone",
									"sid": 572037793318246,
									"parameters": {
										"object": "CloneTrail",
										"layer": "\"World\"",
										"image-point": "0",
										"create-hierarchy": false,
										"template-name": "\"\""
									}
								},
								{
									"id": "set-width",
									"objectClass": "CloneTrail",
									"sid": 559252246997407,
									"parameters": {
										"width": "Self.ImageWidth * (Clone.Width / abs(Clone.Width))"
									}
								},
								{
									"id": "spawn-another-object",
									"objectClass": "Clone",
									"sid": 665821308384743,
									"parameters": {
										"object": "Glow",
										"layer": "\"World\"",
										"image-point": "0",
										"create-hierarchy": false,
										"template-name": "\"\""
									}
								}
							],
							"sid": 756650151732858
						}
					]
				},
				{
					"eventType": "comment",
					"text": "If the clone collides with the ground, destroy it and reset the player's charge."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-overlapping-another-object",
							"objectClass": "Clone",
							"sid": 894285727013299,
							"parameters": {
								"object": "Ground"
							}
						}
					],
					"actions": [
						{
							"id": "destroy",
							"objectClass": "Clone",
							"sid": 390583205930332
						},
						{
							"id": "set-boolean-eventvar",
							"objectClass": "System",
							"sid": 470075658799983,
							"parameters": {
								"variable": "Charged",
								"value": "true"
							}
						}
					],
					"sid": 674984524411819
				},
				{
					"eventType": "comment",
					"text": "However, if the clone collides with a crate, destroy the clone and freeze the crate for a few seconds."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 114275880451595
						},
						{
							"id": "is-overlapping-another-object",
							"objectClass": "Clone",
							"sid": 670545217352007,
							"parameters": {
								"object": "Crate"
							}
						}
					],
					"actions": [
						{
							"id": "destroy",
							"objectClass": "Clone",
							"sid": 858059879541245
						},
						{
							"type": "comment",
							"text": "Make the crate immovable and start a cooldown timer."
						},
						{
							"id": "set-immovable",
							"objectClass": "Crate",
							"sid": 111182965890743,
							"behaviorType": "Physics",
							"parameters": {
								"setting": "immovable"
							}
						},
						{
							"id": "start-timer",
							"objectClass": "Crate",
							"sid": 486676414317682,
							"behaviorType": "Timer",
							"parameters": {
								"duration": "COOLDOWN",
								"type": "once",
								"tag": "\"FreezeDuration\""
							}
						},
						{
							"id": "tween-value",
							"objectClass": "Crate",
							"sid": 658298051593897,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"Luminosity\"",
								"start-value": "100",
								"end-value": "130",
								"time": "0.25",
								"ease": "default",
								"destroy-on-complete": "no",
								"loop": "yes",
								"ping-pong": "yes",
								"repeat-count": "1"
							}
						},
						{
							"type": "comment",
							"text": "Shake the screen slightly for a more impactful effect."
						},
						{
							"callFunction": "ShakeScreen",
							"sid": 229547389500796,
							"parameters": [
								"1.05",
								"0.25"
							]
						}
					],
					"sid": 926895063935763,
					"children": [
						{
							"eventType": "comment",
							"text": "Cast rays in eight different directions with small angle variations."
						},
						{
							"eventType": "variable",
							"name": "CurrentAngle",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"isStatic": false,
							"isConstant": false,
							"sid": 697561963906952
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "repeat",
									"objectClass": "System",
									"sid": 551189089040035,
									"parameters": {
										"count": "CHAINDIRECTIONS"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 282171232419626,
									"parameters": {
										"variable": "CurrentAngle",
										"value": "random(-CHAINRANDOMMAGNITUDE, CHAINRANDOMMAGNITUDE) + (360 / CHAINDIRECTIONS) * loopindex"
									}
								},
								{
									"id": "cast-ray",
									"objectClass": "Crate",
									"sid": 246886819825067,
									"behaviorType": "LineOfSight",
									"parameters": {
										"from-x": "Self.X",
										"from-y": "Self.Y",
										"to-x": "Self.X + cos(CurrentAngle) * Self.LineOfSight.Range",
										"to-y": "Self.Y + sin(CurrentAngle) * Self.LineOfSight.Range",
										"use-collision-cells": true
									}
								}
							],
							"sid": 890251420590085,
							"children": [
								{
									"eventType": "comment",
									"text": "Spawn a long chain to visually hold the crate in place."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "ray-intersected",
											"objectClass": "Crate",
											"sid": 176594261640020,
											"behaviorType": "LineOfSight"
										}
									],
									"actions": [
										{
											"id": "create-object",
											"objectClass": "System",
											"sid": 181174406845062,
											"parameters": {
												"object-to-create": "Chain",
												"layer": "\"World\"",
												"x": "Crate.LineOfSight.HitX",
												"y": "Crate.LineOfSight.HitY",
												"create-hierarchy": false,
												"template-name": "\"\""
											}
										},
										{
											"id": "move-to-bottom",
											"objectClass": "Chain",
											"sid": 523959794314469
										},
										{
											"id": "set-angle",
											"objectClass": "Chain",
											"sid": 953381835226767,
											"parameters": {
												"angle": "angle(Self.X, Self.Y, Crate.X, Crate.Y)"
											}
										},
										{
											"id": "tween-two-properties",
											"objectClass": "Chain",
											"sid": 832091822571963,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"WidthGrow\"",
												"property": "size",
												"end-x": "distance(Self.X, Self.Y, Crate.X, Crate.Y)",
												"end-y": "Self.ImageHeight",
												"time": "random(0.1, 0.25)",
												"ease": "default",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										},
										{
											"type": "comment",
											"text": "Store the crate UID in each chain, so they can be easily destroyed later."
										},
										{
											"id": "set-instvar-value",
											"objectClass": "Chain",
											"sid": 700077452483706,
											"parameters": {
												"instance-variable": "UIDofParent",
												"value": "Crate.UID"
											}
										}
									],
									"sid": 197319944779477
								}
							]
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Update the crate HSL effect in order to make it flash while being frozen."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-playing",
							"objectClass": "Crate",
							"sid": 659675387293083,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"Luminosity\""
							}
						}
					],
					"actions": [
						{
							"id": "set-effect-parameter",
							"objectClass": "Crate",
							"sid": 905983117947003,
							"parameters": {
								"effect": "\"AdjustHSL\"",
								"parameter-index": "2",
								"value": "Self.Tween.Value(\"Luminosity\")"
							}
						}
					],
					"sid": 918437034260848
				},
				{
					"eventType": "comment",
					"text": "Offset the chain texture horizontally to create a more \"organic\", making the chains look alive."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 302480385255678,
							"parameters": {
								"first-value": "Chain.Count",
								"comparison": 4,
								"second-value": "0"
							}
						}
					],
					"actions": [],
					"sid": 243317543530636,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 996901069176358,
									"parameters": {
										"object": "Chain"
									}
								}
							],
							"actions": [
								{
									"id": "set-image-offset-x",
									"objectClass": "Chain",
									"sid": 909650905302726,
									"parameters": {
										"offset-x": "Self.ImageOffsetX + 0.1 * 60 * dt"
									}
								}
							],
							"sid": 374605668332205
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Once the crate cooldown is over, launch it in the air based on its previously taken hits."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-timer",
							"objectClass": "Crate",
							"sid": 585525489530735,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"FreezeDuration\""
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Set state."
						},
						{
							"id": "set-boolean-eventvar",
							"objectClass": "System",
							"sid": 838528753321342,
							"parameters": {
								"variable": "Charged",
								"value": "true"
							}
						},
						{
							"type": "comment",
							"text": "Store initial position in a couple of local variables."
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Crate",
							"sid": 744482598341902,
							"parameters": {
								"instance-variable": "LastX",
								"value": "Self.X"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Crate",
							"sid": 600466965892957,
							"parameters": {
								"instance-variable": "LastY",
								"value": "Self.Y"
							}
						},
						{
							"type": "comment",
							"text": "Revert all the changes previously made to the crate, so it can move again."
						},
						{
							"id": "set-immovable",
							"objectClass": "Crate",
							"sid": 952529311581598,
							"behaviorType": "Physics",
							"parameters": {
								"setting": "movable"
							}
						},
						{
							"id": "apply-force-at-angle",
							"objectClass": "Crate",
							"sid": 599065711596914,
							"behaviorType": "Physics",
							"parameters": {
								"force": "Self.Hits * 50",
								"angle": "Self.ForceAngle",
								"image-point": "0"
							}
						},
						{
							"id": "stop-tweens",
							"objectClass": "Crate",
							"sid": 553414199138256,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"Luminosity\""
							}
						},
						{
							"id": "tween-value",
							"objectClass": "Crate",
							"sid": 919309634946934,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"Luminosity\"",
								"start-value": "130",
								"end-value": "100",
								"time": "0.5",
								"ease": "default",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"type": "comment",
							"text": "Trail effect duration."
						},
						{
							"id": "start-timer",
							"objectClass": "Crate",
							"sid": 631498252888619,
							"behaviorType": "Timer",
							"parameters": {
								"duration": "2",
								"type": "once",
								"tag": "\"Trail\""
							}
						},
						{
							"type": "comment",
							"text": "Reset the crate local variables and update the arrow."
						},
						{
							"callFunction": "ResetCrate",
							"sid": 276661175325590,
							"parameters": [
								"Crate.UID"
							]
						},
						{
							"callFunction": "UpdateArrow",
							"sid": 493093500080683,
							"parameters": [
								"Crate.UID"
							]
						},
						{
							"type": "comment",
							"text": "Shake the screen slightly for a more impactful effect."
						},
						{
							"callFunction": "ShakeScreen",
							"sid": 204021692623498,
							"parameters": [
								"1.1",
								"0.5"
							]
						}
					],
					"sid": 992710449907816,
					"children": [
						{
							"eventType": "comment",
							"text": "Spawn a bunch of smaller chain pieces to create the illusion of breaking the bigger ones. The amount of smaller chains (loop size) is defined by the width of each bigger chain."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 790297830411243,
									"parameters": {
										"object": "Chain"
									}
								}
							],
							"actions": [],
							"sid": 623742427564794,
							"children": [
								{
									"eventType": "variable",
									"name": "LoopSize",
									"type": "number",
									"initialValue": "0",
									"comment": "",
									"isStatic": false,
									"isConstant": false,
									"sid": 462074821740432
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 308311001759183,
											"parameters": {
												"variable": "LoopSize",
												"value": "floor(Chain.Width / 16)"
											}
										}
									],
									"sid": 919020721435646
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "repeat",
											"objectClass": "System",
											"sid": 374610651623209,
											"parameters": {
												"count": "LoopSize"
											}
										}
									],
									"actions": [
										{
											"id": "create-object",
											"objectClass": "System",
											"sid": 606963345294048,
											"parameters": {
												"object-to-create": "BrokenChain",
												"layer": "\"World\"",
												"x": "Chain.X + cos(Chain.Angle) * loopindex * (Chain.Width / LoopSize)",
												"y": "Chain.Y + sin(Chain.Angle) * loopindex * (Chain.Width / LoopSize)",
												"create-hierarchy": false,
												"template-name": "\"\""
											}
										},
										{
											"type": "comment",
											"text": "Randomize a few properties, like rotation speed, angle of motion, etc."
										},
										{
											"id": "set-angle",
											"objectClass": "BrokenChain",
											"sid": 180073453510584,
											"parameters": {
												"angle": "Chain.Angle + random(-15, 15)"
											}
										},
										{
											"id": "set-speed",
											"objectClass": "BrokenChain",
											"sid": 265432551524537,
											"behaviorType": "Rotate",
											"parameters": {
												"speed": "random(-180, 180)"
											}
										},
										{
											"id": "set-angle-of-motion",
											"objectClass": "BrokenChain",
											"sid": 426896804004079,
											"behaviorType": "Bullet",
											"parameters": {
												"angle": "angle(Crate.X, Crate.Y, Self.X, Self.Y) + random(-30, 30)"
											}
										},
										{
											"id": "set-speed",
											"objectClass": "BrokenChain",
											"sid": 666838410352405,
											"behaviorType": "Bullet",
											"parameters": {
												"speed": "random(8, 48)"
											}
										},
										{
											"id": "tween-two-properties",
											"objectClass": "BrokenChain",
											"sid": 178890498615423,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"SizeDown\"",
												"property": "size",
												"end-x": "0",
												"end-y": "0",
												"time": "random(0.5, 1)",
												"ease": "easeinsine",
												"destroy-on-complete": "yes",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										}
									],
									"sid": 276592067853945
								},
								{
									"eventType": "comment",
									"text": "Destroy the bigger chain, since it has been visually replaced by the smaller ones."
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "destroy",
											"objectClass": "Chain",
											"sid": 624033970490308
										}
									],
									"sid": 523683441391573
								}
							]
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Reset the local variables of a specific crate to zero."
				},
				{
					"functionName": "ResetCrate",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "CrateUID",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 366880960101658
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-unique-id",
							"objectClass": "Crate",
							"sid": 774162951719382,
							"parameters": {
								"unique-id": "CrateUID"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Crate",
							"sid": 591197467316297,
							"parameters": {
								"instance-variable": "ForceAngle",
								"value": "0"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Crate",
							"sid": 476521118603119,
							"parameters": {
								"instance-variable": "Hits",
								"value": "0"
							}
						}
					],
					"sid": 308112790329589
				},
				{
					"eventType": "comment",
					"text": "Perform a sword attack, but only if the player is not charged and is not already performing a sword attack or shield bash."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 695826970518026,
							"parameters": {
								"key": 88
							}
						},
						{
							"id": "on-button-pressed",
							"objectClass": "Gamepad",
							"sid": 408440464232123,
							"parameters": {
								"gamepad": "0",
								"button": "button-b"
							}
						}
					],
					"actions": [],
					"sid": 940628481176378,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-boolean-eventvar",
									"objectClass": "System",
									"sid": 804592097476726,
									"parameters": {
										"variable": "Charged"
									},
									"isInverted": true
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "PlayerCollision",
									"sid": 252866170062196,
									"parameters": {
										"instance-variable": "AnimationState",
										"comparison": 0,
										"value": "0"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Update the player's state."
								},
								{
									"id": "set-instvar-value",
									"objectClass": "PlayerCollision",
									"sid": 253462870935923,
									"parameters": {
										"instance-variable": "AnimationState",
										"value": "2"
									}
								},
								{
									"id": "set-animation",
									"objectClass": "PlayerGraphics",
									"sid": 984166253976157,
									"parameters": {
										"animation": "\"SwordAttack\"",
										"from": "beginning"
									}
								},
								{
									"type": "comment",
									"text": "Spawn a sword hit detector in front of the player."
								},
								{
									"id": "spawn-another-object",
									"objectClass": "PlayerGraphics",
									"sid": 971112706037568,
									"parameters": {
										"object": "SwordHit",
										"layer": "\"World\"",
										"image-point": "\"Blade\"",
										"create-hierarchy": false,
										"template-name": "\"\""
									}
								}
							],
							"sid": 802114487043934,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-overlapping-another-object",
											"objectClass": "SwordHit",
											"sid": 991759437997675,
											"parameters": {
												"object": "Crate"
											}
										}
									],
									"actions": [],
									"sid": 811336345037379,
									"children": [
										{
											"eventType": "comment",
											"text": "If the sword hits the currently frozen crate, display a few visual effects and store the amount of hits and force angle, so the crate can be launched later."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "is-timer-running",
													"objectClass": "Crate",
													"sid": 826359515183272,
													"behaviorType": "Timer",
													"parameters": {
														"tag": "\"FreezeDuration\""
													}
												}
											],
											"actions": [
												{
													"id": "spawn-another-object",
													"objectClass": "SwordHit",
													"sid": 803036959961369,
													"parameters": {
														"object": "BladeGlow",
														"layer": "\"World\"",
														"image-point": "0",
														"create-hierarchy": false,
														"template-name": "\"\""
													}
												},
												{
													"id": "destroy",
													"objectClass": "SwordHit",
													"sid": 246752273781990
												},
												{
													"id": "add-to-instvar",
													"objectClass": "Crate",
													"sid": 795824212268013,
													"parameters": {
														"instance-variable": "Hits",
														"value": "1"
													}
												},
												{
													"id": "set-instvar-value",
													"objectClass": "Crate",
													"sid": 256201047090407,
													"parameters": {
														"instance-variable": "ForceAngle",
														"value": "angle(SwordHit.X, SwordHit.Y, Self.X, Self.Y)"
													}
												},
												{
													"callFunction": "UpdateArrow",
													"sid": 406495205230301,
													"parameters": [
														"Crate.UID"
													]
												},
												{
													"type": "comment",
													"text": "Shake the screen slightly for a more impactful effect."
												},
												{
													"callFunction": "ShakeScreen",
													"sid": 674288564677736,
													"parameters": [
														"1.05",
														"0.25"
													]
												}
											],
											"sid": 462791766906478
										},
										{
											"eventType": "comment",
											"text": "If the sword hits a crate, but it's no the frozen one, destroy the sword hit object."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "else",
													"objectClass": "System",
													"sid": 124921551506531
												},
												{
													"id": "is-timer-running",
													"objectClass": "Crate",
													"sid": 973047014967048,
													"behaviorType": "Timer",
													"parameters": {
														"tag": "\"FreezeDuration\""
													},
													"isInverted": true
												}
											],
											"actions": [
												{
													"id": "destroy",
													"objectClass": "SwordHit",
													"sid": 948579954578995
												}
											],
											"sid": 268916363143703
										}
									]
								},
								{
									"eventType": "comment",
									"text": "If the sword didn't hit anything, simply destroy the sword hit object."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-overlapping-another-object",
											"objectClass": "SwordHit",
											"sid": 631461613365912,
											"parameters": {
												"object": "Crate"
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "destroy",
											"objectClass": "SwordHit",
											"sid": 851376140205901
										}
									],
									"sid": 618459435247724
								}
							]
						}
					],
					"isOrBlock": true
				},
				{
					"eventType": "comment",
					"text": "Update the direction and visibility of a specific arrow based on the amount of hits its crate took."
				},
				{
					"functionName": "UpdateArrow",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "CrateUID",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 537117054014633
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-unique-id",
							"objectClass": "Crate",
							"sid": 294619634838044,
							"parameters": {
								"unique-id": "CrateUID"
							}
						}
					],
					"actions": [],
					"sid": 144320694489406,
					"children": [
						{
							"eventType": "comment",
							"text": "If the crate took at least one hit, make it visible and animate its size."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "Crate",
									"sid": 946022020471966,
									"parameters": {
										"instance-variable": "Hits",
										"comparison": 4,
										"value": "0"
									}
								}
							],
							"actions": [
								{
									"id": "set-angle",
									"objectClass": "Arrow",
									"sid": 645670449573265,
									"parameters": {
										"angle": "Crate.ForceAngle"
									}
								},
								{
									"id": "set-visible",
									"objectClass": "Arrow",
									"sid": 955948633571931,
									"parameters": {
										"visibility": "visible"
									}
								},
								{
									"id": "set-size",
									"objectClass": "Arrow",
									"sid": 249980109400733,
									"parameters": {
										"width": "0",
										"height": "0"
									}
								},
								{
									"type": "comment",
									"text": "Tween the arrow size to give it a very elastic impact effect, which is a perfect match for the sword hit."
								},
								{
									"id": "tween-two-properties",
									"objectClass": "Arrow",
									"sid": 146654406921249,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"SizeGrow\"",
										"property": "size",
										"end-x": "Self.ImageWidth",
										"end-y": "Self.ImageHeight",
										"time": "1",
										"ease": "easeoutelastic",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								}
							],
							"sid": 617180380334425
						},
						{
							"eventType": "comment",
							"text": "However, if the crate took no hits, make it invisible."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 155244543482167
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "Crate",
									"sid": 491359862733905,
									"parameters": {
										"instance-variable": "Hits",
										"comparison": 0,
										"value": "0"
									}
								}
							],
							"actions": [
								{
									"id": "set-angle",
									"objectClass": "Arrow",
									"sid": 961029106395242,
									"parameters": {
										"angle": "0"
									}
								},
								{
									"id": "set-visible",
									"objectClass": "Arrow",
									"sid": 157185278525132,
									"parameters": {
										"visibility": "invisible"
									}
								},
								{
									"id": "set-size",
									"objectClass": "Arrow",
									"sid": 989665544213441,
									"parameters": {
										"width": "Self.ImageWidth",
										"height": "Self.ImageHeight"
									}
								}
							],
							"sid": 136100690619416
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Spawn a consistent trail of light behind the crate if it's moving with enough speed."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-timer-running",
							"objectClass": "Crate",
							"sid": 497573087516746,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"Trail\""
							}
						}
					],
					"actions": [],
					"sid": 332913358508549,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-velocity",
									"objectClass": "Crate",
									"sid": 735713696180020,
									"behaviorType": "Physics",
									"parameters": {
										"which": "overall-velocity",
										"comparison": 4,
										"value": "16"
									}
								}
							],
							"actions": [
								{
									"id": "spawn-another-object",
									"objectClass": "Crate",
									"sid": 648517221848624,
									"parameters": {
										"object": "CrateTrail",
										"layer": "\"World\"",
										"image-point": "0",
										"create-hierarchy": false,
										"template-name": "\"\""
									}
								},
								{
									"id": "move-to-object",
									"objectClass": "CrateTrail",
									"sid": 214520297671625,
									"parameters": {
										"where": "behind",
										"object": "Crate"
									}
								},
								{
									"id": "set-angle-toward-position",
									"objectClass": "CrateTrail",
									"sid": 306085724638403,
									"parameters": {
										"x": "Crate.LastX",
										"y": "Crate.LastY"
									}
								},
								{
									"id": "set-size",
									"objectClass": "CrateTrail",
									"sid": 350857945475782,
									"parameters": {
										"width": "distance(Self.X, Self.Y, Crate.LastX, Crate.LastY) * 1.5",
										"height": "Self.ImageHeight"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "CrateTrail",
									"sid": 864707598494999,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"HeightDown\"",
										"property": "offsetHeight",
										"end-value": "0",
										"time": "0.5",
										"ease": "default",
										"destroy-on-complete": "yes",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								}
							],
							"sid": 116437353200887
						},
						{
							"eventType": "comment",
							"text": "Always update the last position variables, since they might be necessary in case the object gain speed again."
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "Crate",
									"sid": 361919882907787,
									"parameters": {
										"instance-variable": "LastX",
										"value": "Self.X"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Crate",
									"sid": 321548736449072,
									"parameters": {
										"instance-variable": "LastY",
										"value": "Self.Y"
									}
								}
							],
							"sid": 157384918731803
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Display a giant flash effect when a crate crosses the trigger object."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "Crate",
							"sid": 485918072358562,
							"parameters": {
								"object": "Trigger"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Spawn a large flash."
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 999857003516293,
							"parameters": {
								"object-to-create": "Flash",
								"layer": "\"World\"",
								"x": "Trigger.X",
								"y": "Trigger.Y",
								"create-hierarchy": false,
								"template-name": "\"\""
							}
						},
						{
							"id": "set-size",
							"objectClass": "Flash",
							"sid": 931534891409950,
							"parameters": {
								"width": "48",
								"height": "1024"
							}
						},
						{
							"id": "tween-two-properties",
							"objectClass": "Flash",
							"sid": 696182762293456,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"SizeDown\"",
								"property": "size",
								"end-x": "0",
								"end-y": "Self.Height",
								"time": "0.5",
								"ease": "default",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"type": "comment",
							"text": "Spawn a few particles around the large flash."
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 881212090940116,
							"parameters": {
								"object-to-create": "FlashSparkles",
								"layer": "\"World\"",
								"x": "Trigger.X",
								"y": "Trigger.Y",
								"create-hierarchy": false,
								"template-name": "\"\""
							}
						},
						{
							"id": "set-angle",
							"objectClass": "FlashSparkles",
							"sid": 854542448284259,
							"parameters": {
								"angle": "270"
							}
						},
						{
							"id": "set-y",
							"objectClass": "FlashSparkles",
							"sid": 903943041251126,
							"parameters": {
								"y": "Self.Y - Self.YRandom / 2"
							}
						},
						{
							"type": "comment",
							"text": "Shake the screen slightly for a more impactful effect."
						},
						{
							"callFunction": "ShakeScreen",
							"sid": 536340648962488,
							"parameters": [
								"1.1",
								"1"
							]
						}
					],
					"sid": 973473441666258,
					"children": [
						{
							"eventType": "comment",
							"text": "Spawn a few more flashes, but smaller this time."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "repeat",
									"objectClass": "System",
									"sid": 279442390702850,
									"parameters": {
										"count": "8"
									}
								}
							],
							"actions": [
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 112843958187817,
									"parameters": {
										"object-to-create": "Flash",
										"layer": "\"World\"",
										"x": "Trigger.X + random(-16, 16)",
										"y": "Trigger.Y",
										"create-hierarchy": false,
										"template-name": "\"\""
									}
								},
								{
									"id": "set-size",
									"objectClass": "Flash",
									"sid": 627694059020214,
									"parameters": {
										"width": "random(8, 32)",
										"height": "64 + random(0, 128)"
									}
								},
								{
									"id": "tween-two-properties",
									"objectClass": "Flash",
									"sid": 883940770713699,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"SizeDown\"",
										"property": "size",
										"end-x": "0",
										"end-y": "Self.Height - 32",
										"time": "random(0.25, 0.5)",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "Flash",
									"sid": 952281335700554,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"XMove\"",
										"property": "offsetX",
										"end-value": "Self.X + random(-8, 8)",
										"time": "0.5",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								}
							],
							"sid": 745735101347614
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Offset the flash effect in order to give it a very fast sense of motion."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 211442925911395,
							"parameters": {
								"first-value": "Flash.Count",
								"comparison": 4,
								"second-value": "0"
							}
						}
					],
					"actions": [
						{
							"id": "set-image-offset-y",
							"objectClass": "Flash",
							"sid": 682466818031336,
							"parameters": {
								"offset-y": "Self.ImageOffsetY + 4 * 60 * dt"
							}
						}
					],
					"sid": 582382265421120
				}
			],
			"sid": 751487184418538
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "DebugTools",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Force the game to restart for testing purposes only."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 886860410172297,
							"parameters": {
								"key": 82
							}
						},
						{
							"id": "on-button-pressed",
							"objectClass": "Gamepad",
							"sid": 549166494317235,
							"parameters": {
								"gamepad": "0",
								"button": "start-menu"
							}
						}
					],
					"actions": [
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 259241878741840
						}
					],
					"sid": 261502125594386,
					"isOrBlock": true
				}
			],
			"sid": 876242795795519
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "ScreenShake",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Shake the whole screen by constantly adjusting the layout scale to a range of random values."
				},
				{
					"functionName": "ShakeScreen",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "Strength",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 598402109952538
						},
						{
							"name": "Duration",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 413949466943445
						}
					],
					"eventType": "function-block",
					"conditions": [],
					"actions": [
						{
							"id": "tween-value",
							"objectClass": "GameManager",
							"sid": 309021463529378,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"ShakeScreen\"",
								"start-value": "Strength",
								"end-value": "1",
								"time": "Duration",
								"ease": "default",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						}
					],
					"sid": 432977423338725
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-playing",
							"objectClass": "GameManager",
							"sid": 478769808563944,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"ShakeScreen\""
							}
						}
					],
					"actions": [
						{
							"id": "set-layout-scale",
							"objectClass": "System",
							"sid": 462968800606314,
							"parameters": {
								"scale": "random(1, GameManager.Tween.Value(\"ShakeScreen\"))"
							}
						}
					],
					"sid": 461453553910127
				}
			],
			"sid": 708200527759195
		}
	],
	"sid": 703169307524782
}