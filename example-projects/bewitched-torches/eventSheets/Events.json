{
	"name": "Events",
	"events": [
		{
			"eventType": "comment",
			"text": "Made by Forsteri Studios\n\nWebsite: forsteristudios.com\nE-Mail: forsteristudios@gmail.com\nX: @forsteristudios"
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Player",
			"description": "",
			"isActiveOnStart": false,
			"children": [
				{
					"eventType": "variable",
					"name": "xAxis",
					"type": "number",
					"initialValue": "0",
					"comment": "Player X input axis.",
					"isStatic": false,
					"isConstant": false,
					"sid": 252581625951956
				},
				{
					"eventType": "variable",
					"name": "yAxis",
					"type": "number",
					"initialValue": "0",
					"comment": "Player Y input axis.",
					"isStatic": false,
					"isConstant": false,
					"sid": 938045474399273
				},
				{
					"eventType": "comment",
					"text": "Movement inputs."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 158849382589423,
							"parameters": {
								"key": 37
							}
						}
					],
					"actions": [
						{
							"id": "subtract-from-eventvar",
							"objectClass": "System",
							"sid": 861695494369300,
							"parameters": {
								"variable": "xAxis",
								"value": "1"
							}
						}
					],
					"sid": 413094831366296
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 564438680312788,
							"parameters": {
								"key": 39
							}
						}
					],
					"actions": [
						{
							"id": "add-to-eventvar",
							"objectClass": "System",
							"sid": 831650910512482,
							"parameters": {
								"variable": "xAxis",
								"value": "1"
							}
						}
					],
					"sid": 503953090580340
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 477585766010835,
							"parameters": {
								"key": 38
							}
						}
					],
					"actions": [
						{
							"id": "subtract-from-eventvar",
							"objectClass": "System",
							"sid": 517619704853356,
							"parameters": {
								"variable": "yAxis",
								"value": "1"
							}
						}
					],
					"sid": 863784256227099
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 792500594879940,
							"parameters": {
								"key": 40
							}
						}
					],
					"actions": [
						{
							"id": "add-to-eventvar",
							"objectClass": "System",
							"sid": 836569838973448,
							"parameters": {
								"variable": "yAxis",
								"value": "1"
							}
						}
					],
					"sid": 164204850384252
				},
				{
					"eventType": "comment",
					"text": "Process X input axis."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 863052170790116,
							"parameters": {
								"variable": "xAxis",
								"comparison": 4,
								"value": "0"
							}
						}
					],
					"actions": [
						{
							"id": "simulate-control",
							"objectClass": "Player",
							"sid": 700731236088459,
							"behaviorType": "TileMovement",
							"parameters": {
								"control": "right"
							}
						},
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 393815380900145,
							"parameters": {
								"animation": "left(Self.AnimationName, 4) = \"Idle\" ? \"Idle_0\" : Self.AnimationName",
								"from": "current-frame"
							}
						}
					],
					"sid": 748002434910023
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 618589891289742
						},
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 775556350242074,
							"parameters": {
								"variable": "xAxis",
								"comparison": 2,
								"value": "0"
							}
						}
					],
					"actions": [
						{
							"id": "simulate-control",
							"objectClass": "Player",
							"sid": 797002643317661,
							"behaviorType": "TileMovement",
							"parameters": {
								"control": "left"
							}
						},
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 424936763867073,
							"parameters": {
								"animation": "left(Self.AnimationName, 4) = \"Idle\" ? \"Idle_180\" : Self.AnimationName",
								"from": "current-frame"
							}
						}
					],
					"sid": 208612617344310
				},
				{
					"eventType": "comment",
					"text": "Process Y input axis."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 708889619239451,
							"parameters": {
								"variable": "yAxis",
								"comparison": 4,
								"value": "0"
							}
						}
					],
					"actions": [
						{
							"id": "simulate-control",
							"objectClass": "Player",
							"sid": 143291022411625,
							"behaviorType": "TileMovement",
							"parameters": {
								"control": "down"
							}
						},
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 313684605392097,
							"parameters": {
								"animation": "left(Self.AnimationName, 4) = \"Idle\" ? \"Idle_90\" : Self.AnimationName",
								"from": "current-frame"
							}
						}
					],
					"sid": 256334652048039
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 939432656566131
						},
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 133746194468428,
							"parameters": {
								"variable": "yAxis",
								"comparison": 2,
								"value": "0"
							}
						}
					],
					"actions": [
						{
							"id": "simulate-control",
							"objectClass": "Player",
							"sid": 608971241964627,
							"behaviorType": "TileMovement",
							"parameters": {
								"control": "up"
							}
						},
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 319906784344374,
							"parameters": {
								"animation": "left(Self.AnimationName, 4) = \"Idle\" ? \"Idle_270\" : Self.AnimationName",
								"from": "current-frame"
							}
						}
					],
					"sid": 171154295877199
				},
				{
					"eventType": "comment",
					"text": "Player is moving."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-moving-direction",
							"objectClass": "Player",
							"sid": 825357116649963,
							"behaviorType": "TileMovement",
							"parameters": {
								"direction": "right"
							}
						}
					],
					"actions": [
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 449979214461104,
							"parameters": {
								"animation": "\"Walk_0\"",
								"from": "current-frame"
							}
						}
					],
					"sid": 588102863520968
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 211498690631967
						},
						{
							"id": "is-moving-direction",
							"objectClass": "Player",
							"sid": 188047095408657,
							"behaviorType": "TileMovement",
							"parameters": {
								"direction": "left"
							}
						}
					],
					"actions": [
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 647015201431872,
							"parameters": {
								"animation": "\"Walk_180\"",
								"from": "current-frame"
							}
						}
					],
					"sid": 643091232571705
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 786191292045175
						},
						{
							"id": "is-moving-direction",
							"objectClass": "Player",
							"sid": 479619302661286,
							"behaviorType": "TileMovement",
							"parameters": {
								"direction": "down"
							}
						}
					],
					"actions": [
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 609031732123288,
							"parameters": {
								"animation": "\"Walk_90\"",
								"from": "current-frame"
							}
						}
					],
					"sid": 445745839196793
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 708004229320352
						},
						{
							"id": "is-moving-direction",
							"objectClass": "Player",
							"sid": 873911745608294,
							"behaviorType": "TileMovement",
							"parameters": {
								"direction": "up"
							}
						}
					],
					"actions": [
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 764233706437866,
							"parameters": {
								"animation": "\"Walk_270\"",
								"from": "current-frame"
							}
						}
					],
					"sid": 238951760130510
				},
				{
					"eventType": "comment",
					"text": "Player is idling."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 835300777426233
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 758239413934094,
							"parameters": {
								"value": "left(PlayerSprite.AnimationName, 5) <> \"Torch\" & left(PlayerSprite.AnimationName, 5) <> \"Extin\""
							}
						}
					],
					"actions": [
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 611554927217090,
							"parameters": {
								"animation": "\"Idle_\" & tokenat(PlayerSprite.AnimationName, 1, \"_\")",
								"from": "beginning"
							}
						}
					],
					"sid": 802341111226383
				},
				{
					"eventType": "comment",
					"text": "Light an adjacent torch."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 687038360437317,
							"parameters": {
								"key": 32
							}
						},
						{
							"id": "is-moving",
							"objectClass": "Player",
							"sid": 153660467775163,
							"behaviorType": "TileMovement",
							"isInverted": true
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 918074589541020,
							"parameters": {
								"value": "left(PlayerSprite.AnimationName, 5) <> \"Torch\" & left(PlayerSprite.AnimationName, 5) <> \"Extin\""
							}
						},
						{
							"id": "for-each",
							"objectClass": "System",
							"sid": 704217533684752,
							"parameters": {
								"object": "Torch"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 494889582714404,
							"parameters": {
								"value": "abs(Torch.X - Player.X) + abs(Torch.Y - Player.Y) < 25"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Disable some controls."
						},
						{
							"id": "set-ignoring-input",
							"objectClass": "Player",
							"sid": 459587969373487,
							"behaviorType": "TileMovement",
							"parameters": {
								"input": "start-ignoring"
							}
						},
						{
							"id": "stop-loop",
							"objectClass": "System",
							"sid": 974403945562348
						},
						{
							"type": "comment",
							"text": "Make the player face the torch."
						},
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 178518872510926,
							"parameters": {
								"animation": "(Torch.AnimationName = \"Lit\" ? \"Extinguish_\" : \"Torch_\") & round((angle(Player.X, Player.Y, Torch.X, Torch.Y) + 360) % 360)",
								"from": "beginning"
							}
						},
						{
							"type": "comment",
							"text": "Toggle current and linked torches."
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 649574059984680,
							"parameters": {
								"seconds": "0.5",
								"use-timescale": true
							}
						},
						{
							"callFunction": "toggleTorch",
							"sid": 882973674555688,
							"parameters": [
								"Torch.torchID"
							]
						},
						{
							"callFunction": "checkGroup",
							"sid": 101938494954703,
							"parameters": [
								"Torch.groupID"
							]
						}
					],
					"sid": 997435104447747
				},
				{
					"eventType": "comment",
					"text": "Return to idle."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-any-animation-finished",
							"objectClass": "PlayerSprite",
							"sid": 480933095871897
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 291322960206340,
							"parameters": {
								"value": "left(PlayerSprite.AnimationName, 5) = \"Torch\" | left(PlayerSprite.AnimationName, 5) = \"Extin\""
							}
						}
					],
					"actions": [
						{
							"id": "set-ignoring-input",
							"objectClass": "Player",
							"sid": 796949684620738,
							"behaviorType": "TileMovement",
							"parameters": {
								"input": "stop-ignoring"
							}
						},
						{
							"id": "set-animation",
							"objectClass": "PlayerSprite",
							"sid": 652016296323719,
							"parameters": {
								"animation": "\"Idle_\" & tokenat(PlayerSprite.AnimationName, 1, \"_\")",
								"from": "beginning"
							}
						}
					],
					"sid": 314830148226027
				}
			],
			"sid": 805448583766174
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Objective",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Check if the player has the key to open the door and beat the game."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "Player",
							"sid": 535279398890732,
							"parameters": {
								"object": "Trigger"
							}
						},
						{
							"id": "is-flashing",
							"objectClass": "TextMessage",
							"sid": 194408464831350,
							"behaviorType": "Flash",
							"isInverted": true
						}
					],
					"actions": [],
					"sid": 242089688875317,
					"children": [
						{
							"eventType": "comment",
							"text": "Player has the key - play final cutscene and end the game."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-visible",
									"objectClass": "Key",
									"sid": 106956105169891,
									"isInverted": true
								},
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 145210846489451,
									"parameters": {
										"object": "Door",
										"expression": "Door.groupID = 999"
									}
								},
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 785516677319508,
									"parameters": {
										"object": "CameraAnchor",
										"expression": "CameraAnchor.cameraID = 999"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Disable controls."
								},
								{
									"id": "set-enabled",
									"objectClass": "Player",
									"sid": 630374235998383,
									"behaviorType": "TileMovement",
									"parameters": {
										"state": "disabled"
									}
								},
								{
									"id": "set-group-active",
									"objectClass": "System",
									"sid": 334077855536643,
									"parameters": {
										"group-name": "\"Player\"",
										"state": "deactivated"
									}
								},
								{
									"type": "comment",
									"text": "Open the door."
								},
								{
									"id": "set-animation",
									"objectClass": "Door",
									"sid": 629627715790776,
									"parameters": {
										"animation": "\"Open\"",
										"from": "beginning"
									}
								},
								{
									"type": "comment",
									"text": "Set player position with an animation."
								},
								{
									"id": "tween-two-properties",
									"objectClass": "Player",
									"sid": 944777700249767,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"SetupPlayer\"",
										"property": "position",
										"end-x": "Trigger.X",
										"end-y": "Trigger.Y",
										"time": "distance(Player.X, Player.Y, Trigger.X, Trigger.Y)/24",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "wait-for-previous-actions",
									"objectClass": "System",
									"sid": 526863839371376
								},
								{
									"type": "comment",
									"text": "Move camera."
								},
								{
									"id": "tween-two-properties",
									"objectClass": "Camera",
									"sid": 343061944936012,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ScrollCamera\"",
										"property": "position",
										"end-x": "CameraAnchor.X",
										"end-y": "CameraAnchor.Y",
										"time": "7",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Camera",
									"sid": 181700354686567,
									"parameters": {
										"instance-variable": "cameraID",
										"value": "CameraAnchor.cameraID"
									}
								},
								{
									"type": "comment",
									"text": "Animate and move player."
								},
								{
									"id": "set-animation",
									"objectClass": "PlayerSprite",
									"sid": 747826003175903,
									"parameters": {
										"animation": "\"Walk_90\"",
										"from": "beginning"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "Player",
									"sid": 907167545399214,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"MovePlayer\"",
										"property": "offsetY",
										"end-value": "EndingPosition.Y",
										"time": "10",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "wait-for-previous-actions",
									"objectClass": "System",
									"sid": 259897717616844
								},
								{
									"type": "comment",
									"text": "Show success screen."
								},
								{
									"id": "tween-one-property",
									"objectClass": "Fader",
									"sid": 346770561178578,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ShowFader\"",
										"property": "offsetOpacity",
										"end-value": "100",
										"time": "2",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "set-text",
									"objectClass": "TextGameOver",
									"sid": 912407821692736,
									"parameters": {
										"text": "\"[color=#00ff00]SUCCESS[/color]\""
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "TextGameOver",
									"sid": 640091106521144,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ShowGameOver\"",
										"property": "offsetOpacity",
										"end-value": "100",
										"time": "2",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"type": "comment",
									"text": "Hide game over screen."
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 638824097235403,
									"parameters": {
										"seconds": "5",
										"use-timescale": true
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "TextGameOver",
									"sid": 663382123187639,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"hideGameOver\"",
										"property": "offsetOpacity",
										"end-value": "0",
										"time": "1",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"type": "comment",
									"text": "Restart the game."
								},
								{
									"id": "wait-for-previous-actions",
									"objectClass": "System",
									"sid": 648955017609675
								},
								{
									"id": "restart-layout",
									"objectClass": "System",
									"sid": 874918783763224
								}
							],
							"sid": 270446013507361
						},
						{
							"eventType": "comment",
							"text": "Player doesn't have the key - flash message."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 545312938468174
								}
							],
							"actions": [
								{
									"id": "set-text",
									"objectClass": "TextMessage",
									"sid": 150733429167891,
									"parameters": {
										"text": "\"[color=#ffff00]Golden key[/color] is required to unlock this door.\""
									}
								},
								{
									"id": "flash",
									"objectClass": "TextMessage",
									"sid": 359996219785628,
									"behaviorType": "Flash",
									"parameters": {
										"on-time": "0.15",
										"off-time": "0.1",
										"duration": "2.9"
									}
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 354018366228600,
									"parameters": {
										"seconds": "3.0",
										"use-timescale": true
									}
								},
								{
									"id": "set-visible",
									"objectClass": "TextMessage",
									"sid": 248163184206709,
									"parameters": {
										"visibility": "invisible"
									}
								}
							],
							"sid": 253732871695196
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Grab the golden key and flash message."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "Player",
							"sid": 325669301647475,
							"parameters": {
								"object": "Key"
							}
						},
						{
							"id": "is-visible",
							"objectClass": "Key",
							"sid": 494951023582961
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Hide the key."
						},
						{
							"id": "set-visible",
							"objectClass": "Key",
							"sid": 530135563740912,
							"parameters": {
								"visibility": "invisible"
							}
						},
						{
							"type": "comment",
							"text": "Flash message."
						},
						{
							"id": "set-text",
							"objectClass": "TextMessage",
							"sid": 608715367087701,
							"parameters": {
								"text": "\"Acquired the [color=#ffff00]golden key[/color] to the front yard!\""
							}
						},
						{
							"id": "flash",
							"objectClass": "TextMessage",
							"sid": 445081989845136,
							"behaviorType": "Flash",
							"parameters": {
								"on-time": "0.15",
								"off-time": "0.1",
								"duration": "2.9"
							}
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 376448654487529,
							"parameters": {
								"seconds": "3.0",
								"use-timescale": true
							}
						},
						{
							"id": "set-visible",
							"objectClass": "TextMessage",
							"sid": 745547743220665,
							"parameters": {
								"visibility": "invisible"
							}
						}
					],
					"sid": 203694827349759
				}
			],
			"sid": 847768107843400
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Bat",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Start patrolling waypoints."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 664443417364443
						},
						{
							"id": "for-each",
							"objectClass": "System",
							"sid": 692141363886155,
							"parameters": {
								"object": "Bat"
							}
						},
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 927077405408033,
							"parameters": {
								"object": "BatWaypoint",
								"expression": "BatWaypoint.batID = Bat.batID"
							}
						},
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 659330446200962,
							"parameters": {
								"object": "BatWaypoint",
								"expression": "BatWaypoint.wptNum = Bat.nextWpt"
							}
						}
					],
					"actions": [
						{
							"id": "move-to-object",
							"objectClass": "Bat",
							"sid": 688894379766732,
							"behaviorType": "MoveTo",
							"parameters": {
								"object": "BatWaypoint",
								"image-point": "0",
								"mode": "direct"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Bat",
							"sid": 313592238309098,
							"parameters": {
								"instance-variable": "nextWpt",
								"value": "(Self.nextWpt = Self.totalWpt - 1) ? 0 : Self.nextWpt + 1"
							}
						},
						{
							"id": "set-width",
							"objectClass": "Bat",
							"sid": 225383673618763,
							"parameters": {
								"width": "Self.X < BatWaypoint.X ? Self.ImageWidth : (Self.X > BatWaypoint.X ? -Self.ImageWidth : Self.Width)"
							}
						}
					],
					"sid": 504675859877321
				},
				{
					"eventType": "comment",
					"text": "Go to the next waypoint."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-arrived",
							"objectClass": "Bat",
							"sid": 640082905514367,
							"behaviorType": "MoveTo"
						},
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 113329563164560,
							"parameters": {
								"object": "BatWaypoint",
								"expression": "BatWaypoint.batID = Bat.batID"
							}
						},
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 338699104198765,
							"parameters": {
								"object": "BatWaypoint",
								"expression": "BatWaypoint.wptNum = Bat.nextWpt"
							}
						}
					],
					"actions": [
						{
							"id": "move-to-object",
							"objectClass": "Bat",
							"sid": 843459717290731,
							"behaviorType": "MoveTo",
							"parameters": {
								"object": "BatWaypoint",
								"image-point": "0",
								"mode": "direct"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Bat",
							"sid": 812023048351082,
							"parameters": {
								"instance-variable": "nextWpt",
								"value": "(Self.nextWpt = Self.totalWpt - 1) ? 0 : Self.nextWpt + 1"
							}
						},
						{
							"id": "set-width",
							"objectClass": "Bat",
							"sid": 223673211127518,
							"parameters": {
								"width": "Self.X < BatWaypoint.X ? Self.ImageWidth : (Self.X > BatWaypoint.X ? -Self.ImageWidth : Self.Width)"
							}
						}
					],
					"sid": 864311232726395
				},
				{
					"eventType": "comment",
					"text": "If the bat touches the player, it's game over."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "Bat",
							"sid": 860029058140711,
							"parameters": {
								"object": "Player"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Show game over screen."
						},
						{
							"id": "tween-one-property",
							"objectClass": "Fader",
							"sid": 600487340534438,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"ShowFader\"",
								"property": "offsetOpacity",
								"end-value": "100",
								"time": "2",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "TextGameOver",
							"sid": 494285714914681,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"ShowGameOver\"",
								"property": "offsetOpacity",
								"end-value": "100",
								"time": "2",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"type": "comment",
							"text": "Flash player."
						},
						{
							"id": "flash",
							"objectClass": "PlayerSprite",
							"sid": 424466274877382,
							"behaviorType": "Flash",
							"parameters": {
								"on-time": "0.1",
								"off-time": "0.1",
								"duration": "Infinity"
							}
						},
						{
							"type": "comment",
							"text": "Disable player and bat."
						},
						{
							"id": "set-collisions-enabled",
							"objectClass": "Player",
							"sid": 754859215254252,
							"parameters": {
								"collisions": "disabled"
							}
						},
						{
							"id": "set-ignoring-input",
							"objectClass": "Player",
							"sid": 751172852492012,
							"behaviorType": "TileMovement",
							"parameters": {
								"input": "start-ignoring"
							}
						},
						{
							"id": "stop",
							"objectClass": "Bat",
							"sid": 418783031401007,
							"behaviorType": "MoveTo"
						},
						{
							"type": "comment",
							"text": "Hide game over screen."
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 944873847530196,
							"parameters": {
								"seconds": "5",
								"use-timescale": true
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "TextGameOver",
							"sid": 862337925587109,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"hideGameOver\"",
								"property": "offsetOpacity",
								"end-value": "0",
								"time": "1",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"type": "comment",
							"text": "Restart the game."
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 559737675120201
						},
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 851684545090070
						}
					],
					"sid": 771365702799368
				}
			],
			"sid": 432205455062017
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Rooms and Camera",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Setup game."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 439980130924031
						},
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 340571383780985,
							"parameters": {
								"object": "CameraAnchor",
								"expression": "CameraAnchor.cameraID = 0"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Disable controls."
						},
						{
							"id": "set-ignoring-input",
							"objectClass": "Player",
							"sid": 568000516061211,
							"behaviorType": "TileMovement",
							"parameters": {
								"input": "start-ignoring"
							}
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 212027703783610,
							"parameters": {
								"group-name": "\"Player\"",
								"state": "deactivated"
							}
						},
						{
							"type": "comment",
							"text": "Setup camera starting position."
						},
						{
							"id": "set-position-to-another-object",
							"objectClass": "Camera",
							"sid": 860439609268946,
							"parameters": {
								"object": "CameraAnchor",
								"image-point-optional": "0"
							}
						},
						{
							"id": "scroll-to-object",
							"objectClass": "System",
							"sid": 977079949957150,
							"parameters": {
								"object": "CameraAnchor"
							}
						},
						{
							"type": "comment",
							"text": "Show tutorial screen."
						},
						{
							"id": "tween-one-property",
							"objectClass": "Fader",
							"sid": 819119291661062,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"DimFader\"",
								"property": "offsetOpacity",
								"end-value": "80",
								"time": "0.5",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "TextTutorial",
							"sid": 481948057166254,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"ShowTutorial\"",
								"property": "offsetOpacity",
								"end-value": "100",
								"time": "0.5",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						}
					],
					"sid": 734258193224581
				},
				{
					"eventType": "comment",
					"text": "Start the game."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-key-pressed",
							"objectClass": "Keyboard",
							"sid": 931090856459191,
							"parameters": {
								"key": 32
							}
						},
						{
							"id": "compare-opacity",
							"objectClass": "TextTutorial",
							"sid": 765153479401693,
							"parameters": {
								"comparison": 0,
								"opacity": "100"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Enable controls."
						},
						{
							"id": "set-group-active",
							"objectClass": "System",
							"sid": 656423095227371,
							"parameters": {
								"group-name": "\"Player\"",
								"state": "activated"
							}
						},
						{
							"id": "set-ignoring-input",
							"objectClass": "Player",
							"sid": 728579773056126,
							"behaviorType": "TileMovement",
							"parameters": {
								"input": "stop-ignoring"
							}
						},
						{
							"type": "comment",
							"text": "Hide tutorial screen."
						},
						{
							"id": "tween-one-property",
							"objectClass": "Fader",
							"sid": 580986976326733,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"HideFader\"",
								"property": "offsetOpacity",
								"end-value": "0",
								"time": "0.5",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "TextTutorial",
							"sid": 111807660411973,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"HideTutorial\"",
								"property": "offsetOpacity",
								"end-value": "0",
								"time": "0.5",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						}
					],
					"sid": 806982135473104
				},
				{
					"eventType": "comment",
					"text": "Change room and scroll camera to new anchor position."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "Player",
							"sid": 905643519263184,
							"parameters": {
								"object": "RoomTrigger"
							}
						},
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 491736631005568,
							"parameters": {
								"object": "CameraAnchor",
								"expression": "CameraAnchor.cameraID = RoomTrigger.cameraID"
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "Camera",
							"sid": 699584538260378,
							"parameters": {
								"instance-variable": "cameraID",
								"comparison": 1,
								"value": "CameraAnchor.cameraID"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Disable player's controls."
						},
						{
							"id": "set-ignoring-input",
							"objectClass": "Player",
							"sid": 168144284672407,
							"behaviorType": "TileMovement",
							"parameters": {
								"input": "start-ignoring"
							}
						},
						{
							"type": "comment",
							"text": "Move camera."
						},
						{
							"id": "tween-two-properties",
							"objectClass": "Camera",
							"sid": 481360288819130,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"ScrollCamera\"",
								"property": "position",
								"end-x": "CameraAnchor.X",
								"end-y": "CameraAnchor.Y",
								"time": "1",
								"ease": "easeinoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Camera",
							"sid": 228456295923538,
							"parameters": {
								"instance-variable": "cameraID",
								"value": "CameraAnchor.cameraID"
							}
						},
						{
							"type": "comment",
							"text": "Enable player's controls."
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 151639044013268
						},
						{
							"id": "set-ignoring-input",
							"objectClass": "Player",
							"sid": 815159435656563,
							"behaviorType": "TileMovement",
							"parameters": {
								"input": "stop-ignoring"
							}
						}
					],
					"sid": 190641788627883
				},
				{
					"eventType": "comment",
					"text": "Screen follows camera object."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-playing",
							"objectClass": "Camera",
							"sid": 836438390445003,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"ScrollCamera\""
							}
						}
					],
					"actions": [
						{
							"id": "scroll-to-object",
							"objectClass": "System",
							"sid": 318684084029362,
							"parameters": {
								"object": "Camera"
							}
						}
					],
					"sid": 450800263648979
				}
			],
			"sid": 557211897690985
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Torches and Doors",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Toggle a torch and propagate its signal."
				},
				{
					"functionName": "toggleTorch",
					"functionDescription": "Toggle a torch and propagate its signal.",
					"functionCategory": "Torches and Doors",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "torchID",
							"type": "number",
							"initialValue": "0",
							"comment": "Torch identification number.",
							"sid": 274102003627883
						}
					],
					"eventType": "function-block",
					"conditions": [],
					"actions": [],
					"sid": 670784006815946,
					"children": [
						{
							"eventType": "comment",
							"text": "Toggle current torch."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 534469602509812,
									"parameters": {
										"object": "Torch",
										"expression": "Torch.torchID = torchID"
									}
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "Torch",
									"sid": 366037962768748,
									"parameters": {
										"animation": "Self.AnimationName = \"Lit\" ? \"Unlit\" : \"Lit\"",
										"from": "beginning"
									}
								}
							],
							"sid": 595349043573925
						},
						{
							"eventType": "comment",
							"text": "Toggle torches linked to the current torch."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 282665366876458,
									"parameters": {
										"object": "Torch"
									}
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 182706543631148,
									"parameters": {
										"value": "RegexSearch(Torch.linkedWith, \"\\b\" & torchID & \"\\b\", \"\") >= 0"
									}
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "Torch",
									"sid": 316897654155215,
									"parameters": {
										"animation": "Self.AnimationName = \"Lit\" ? \"Unlit\" : \"Lit\"",
										"from": "beginning"
									}
								}
							],
							"sid": 404994482289537
						},
						{
							"eventType": "comment",
							"text": "Make links change color for better visual cues."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 688770208849291,
									"parameters": {
										"object": "Link"
									}
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 410333764027925,
									"parameters": {
										"value": "Link.firstTorchID = torchID | Link.secondTorchID = torchID"
									}
								}
							],
							"actions": [
								{
									"id": "tween-value",
									"objectClass": "Link",
									"sid": 414334011011241,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"FlashLink\"",
										"start-value": "0",
										"end-value": "1",
										"time": "0.25",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "yes",
										"repeat-count": "1"
									}
								}
							],
							"sid": 280973825667220
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Check if all torches in a group are lit."
				},
				{
					"functionName": "checkGroup",
					"functionDescription": "Check if all torches in a group are lit.",
					"functionCategory": "Torches and Doors",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "group",
							"type": "number",
							"initialValue": "0",
							"comment": "Group number.",
							"sid": 400779854056031
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 630500189899913,
							"parameters": {
								"object": "Door",
								"expression": "Door.groupID = group"
							}
						},
						{
							"id": "pick-by-evaluate",
							"objectClass": "System",
							"sid": 687434687733483,
							"parameters": {
								"object": "Torch",
								"expression": "Torch.groupID = group"
							}
						}
					],
					"actions": [],
					"sid": 382190696121220,
					"children": [
						{
							"eventType": "variable",
							"name": "unlitFound",
							"type": "boolean",
							"initialValue": "false",
							"comment": "There is at least one unlit torch,",
							"isStatic": false,
							"isConstant": false,
							"sid": 673939050458506
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 126489023838890,
									"parameters": {
										"object": "Torch"
									}
								},
								{
									"id": "is-animation-playing",
									"objectClass": "Torch",
									"sid": 807512675493765,
									"parameters": {
										"animation": "\"Unlit\""
									}
								}
							],
							"actions": [
								{
									"id": "set-boolean-eventvar",
									"objectClass": "System",
									"sid": 917101160901847,
									"parameters": {
										"variable": "unlitFound",
										"value": "true"
									}
								},
								{
									"id": "stop-loop",
									"objectClass": "System",
									"sid": 807087490787609
								}
							],
							"sid": 454582653513252
						},
						{
							"eventType": "comment",
							"text": "If all torches are lit, open the door."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-boolean-eventvar",
									"objectClass": "System",
									"sid": 549821237081978,
									"parameters": {
										"variable": "unlitFound"
									},
									"isInverted": true
								},
								{
									"id": "is-animation-playing",
									"objectClass": "Door",
									"sid": 775199743720543,
									"parameters": {
										"animation": "\"Close\""
									}
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "Door",
									"sid": 301111467743277,
									"parameters": {
										"animation": "\"Open\"",
										"from": "beginning"
									}
								},
								{
									"id": "set-enabled",
									"objectClass": "Door",
									"sid": 364083490168200,
									"behaviorType": "Solid",
									"parameters": {
										"state": "disabled"
									}
								}
							],
							"sid": 138296636533869
						},
						{
							"eventType": "comment",
							"text": "Otherwise, close the door."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 925095120335710
								},
								{
									"id": "is-animation-playing",
									"objectClass": "Door",
									"sid": 758562292622007,
									"parameters": {
										"animation": "\"Open\""
									}
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "Door",
									"sid": 620384006903229,
									"parameters": {
										"animation": "\"Close\"",
										"from": "beginning"
									}
								},
								{
									"id": "set-enabled",
									"objectClass": "Door",
									"sid": 716619151112266,
									"behaviorType": "Solid",
									"parameters": {
										"state": "enabled"
									}
								}
							],
							"sid": 940267611024113
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Create link between two torches."
				},
				{
					"functionName": "createLink",
					"functionDescription": "Create link between two torches.",
					"functionCategory": "Torches and Doors",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "firstTorchID",
							"type": "number",
							"initialValue": "0",
							"comment": "First torch.",
							"sid": 737828825931620
						},
						{
							"name": "secondTorchID",
							"type": "number",
							"initialValue": "0",
							"comment": "Second Torch.",
							"sid": 343135967301011
						}
					],
					"eventType": "function-block",
					"conditions": [],
					"actions": [],
					"sid": 335020841537538,
					"children": [
						{
							"eventType": "variable",
							"name": "firstX",
							"type": "number",
							"initialValue": "0",
							"comment": "First X position.",
							"isStatic": false,
							"isConstant": false,
							"sid": 739305856465204
						},
						{
							"eventType": "variable",
							"name": "firstY",
							"type": "number",
							"initialValue": "0",
							"comment": "First Y position.",
							"isStatic": false,
							"isConstant": false,
							"sid": 430872721204191
						},
						{
							"eventType": "variable",
							"name": "secondX",
							"type": "number",
							"initialValue": "0",
							"comment": "Second X position.",
							"isStatic": false,
							"isConstant": false,
							"sid": 156835694072241
						},
						{
							"eventType": "variable",
							"name": "secondY",
							"type": "number",
							"initialValue": "0",
							"comment": "Second Y position.",
							"isStatic": false,
							"isConstant": false,
							"sid": 204140325502145
						},
						{
							"eventType": "variable",
							"name": "alreadyExists",
							"type": "boolean",
							"initialValue": "false",
							"comment": "Link between torches already exists.",
							"isStatic": false,
							"isConstant": false,
							"sid": 500160920484881
						},
						{
							"eventType": "comment",
							"text": "Get position of the first torch."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 410885021634688,
									"parameters": {
										"object": "Torch",
										"expression": "Torch.torchID = firstTorchID"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 180593199213541,
									"parameters": {
										"variable": "firstX",
										"value": "Torch.ImagePointX(\"LinkPos\")"
									}
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 376905727184076,
									"parameters": {
										"variable": "firstY",
										"value": "Torch.ImagePointY(\"LinkPos\")"
									}
								}
							],
							"sid": 413638095767904
						},
						{
							"eventType": "comment",
							"text": "Get position of the second torch."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 693832609462695,
									"parameters": {
										"object": "Torch",
										"expression": "Torch.torchID = secondTorchID"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 563054436604925,
									"parameters": {
										"variable": "secondX",
										"value": "Torch.ImagePointX(\"LinkPos\")"
									}
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 148728274659261,
									"parameters": {
										"variable": "secondY",
										"value": "Torch.ImagePointY(\"LinkPos\")"
									}
								}
							],
							"sid": 232613744193736
						},
						{
							"eventType": "comment",
							"text": "Check if link already exists."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 782585165025282,
									"parameters": {
										"object": "Link"
									}
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 638306808771952,
									"parameters": {
										"value": "(Link.firstTorchID = firstTorchID & Link.secondTorchID = secondTorchID) |\n(Link.firstTorchID = secondTorchID & Link.secondTorchID = firstTorchID)"
									}
								}
							],
							"actions": [
								{
									"id": "set-boolean-eventvar",
									"objectClass": "System",
									"sid": 565037292411665,
									"parameters": {
										"variable": "alreadyExists",
										"value": "true"
									}
								}
							],
							"sid": 628905294928838
						},
						{
							"eventType": "comment",
							"text": "If link doesn't already exist, create it."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-boolean-eventvar",
									"objectClass": "System",
									"sid": 211374670143771,
									"parameters": {
										"variable": "alreadyExists"
									},
									"isInverted": true
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Create link below first torch."
								},
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 251456060540329,
									"parameters": {
										"object-to-create": "Link",
										"layer": "\"Foreground\"",
										"x": "firstX",
										"y": "firstY",
										"create-hierarchy": false,
										"template-name": "\"\""
									}
								},
								{
									"type": "comment",
									"text": "Set its properties."
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Link",
									"sid": 244937123517264,
									"parameters": {
										"instance-variable": "firstTorchID",
										"value": "firstTorchID"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Link",
									"sid": 173744799331281,
									"parameters": {
										"instance-variable": "secondTorchID",
										"value": "secondTorchID"
									}
								},
								{
									"id": "set-default-color",
									"objectClass": "Link",
									"sid": 991819634409625,
									"parameters": {
										"color": "rgba255(58, 18, 8, 255)"
									}
								},
								{
									"type": "comment",
									"text": "Set size and angle to link with the second torch."
								},
								{
									"id": "set-width",
									"objectClass": "Link",
									"sid": 210808390911923,
									"parameters": {
										"width": "distance(firstX, firstY, secondX, secondY)"
									}
								},
								{
									"id": "set-angle-toward-position",
									"objectClass": "Link",
									"sid": 769044492903564,
									"parameters": {
										"x": "secondX",
										"y": "secondY"
									}
								},
								{
									"type": "comment",
									"text": "Move link to the bottom of the layer."
								},
								{
									"id": "move-to-bottom",
									"objectClass": "Link",
									"sid": 931313635290558
								}
							],
							"sid": 665982200508610
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Randomize starting animation frame of lit torches and create links."
				},
				{
					"eventType": "variable",
					"name": "numLink",
					"type": "number",
					"initialValue": "0",
					"comment": "Number of links.",
					"isStatic": false,
					"isConstant": false,
					"sid": 252679579064567
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 958372726649596
						},
						{
							"id": "for-each",
							"objectClass": "System",
							"sid": 520381117745256,
							"parameters": {
								"object": "Torch"
							}
						}
					],
					"actions": [
						{
							"id": "set-animation-frame",
							"objectClass": "Torch",
							"sid": 626692393297758,
							"parameters": {
								"frame-number": "int(random(0, 6))"
							}
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 369035560437110,
							"parameters": {
								"seconds": "0.1 * loopindex",
								"use-timescale": true
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 689214615330505,
							"parameters": {
								"variable": "numLink",
								"value": "tokencount(Torch.linkedWith, \",\")"
							}
						}
					],
					"sid": 156103063788511,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 682071712439223,
									"parameters": {
										"name": "\"token\"",
										"start-index": "0",
										"end-index": "numLink - 1"
									}
								},
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 619805429284295,
									"parameters": {
										"variable": "numLink",
										"comparison": 4,
										"value": "0"
									}
								}
							],
							"actions": [
								{
									"callFunction": "createLink",
									"sid": 920414404234943,
									"parameters": [
										"Torch.torchID",
										"int(tokenat(Torch.linkedWith, loopindex(\"token\"), \",\"))"
									]
								}
							],
							"sid": 239433052082791
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Flash links."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "for-each",
							"objectClass": "System",
							"sid": 625075017290775,
							"parameters": {
								"object": "Link"
							}
						},
						{
							"id": "is-playing",
							"objectClass": "Link",
							"sid": 547147374646753,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"FlashLink\""
							}
						}
					],
					"actions": [
						{
							"id": "set-default-color",
							"objectClass": "Link",
							"sid": 493112187958072,
							"parameters": {
								"color": "rgba255(\n    58 + Self.Tween.Value(\"FlashLink\") * 185,\n    18 + Self.Tween.Value(\"FlashLink\") * 161,\n    8 + Self.Tween.Value(\"FlashLink\") * 22,\n    255\n)"
							}
						}
					],
					"sid": 897494551685544
				}
			],
			"sid": 167422367786468
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Z-Order",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Sort Z-Order."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "for-each",
							"objectClass": "System",
							"sid": 153339527397654,
							"parameters": {
								"object": "ZOrderables"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "ZOrderables",
							"sid": 168678524554720,
							"parameters": {
								"instance-variable": "zOrderIndex",
								"value": "Self.Y"
							}
						}
					],
					"sid": 189555372445449
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "sort-z-order",
							"objectClass": "System",
							"sid": 547243212144513,
							"parameters": {
								"object": "ZOrderables",
								"instance-variable": {
									"name": "zOrderIndex",
									"objectClass": "ZOrderables"
								}
							}
						}
					],
					"sid": 312522508997612
				}
			],
			"sid": 331021178219763
		}
	],
	"sid": 380797728204819
}