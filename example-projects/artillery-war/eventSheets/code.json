{
	"name": "Code",
	"events": [
		{
			"eventType": "comment",
			"text": "Made by Viridino Studios (@ViridinoStudios)\n\nMateus Ferreira - Programmer\nTwitter: @BonzerKitten\nE-mail: ferreiramoreiramateus@gmail.com\n\nWesley Andrade - Artist\nTwitter: @andrart7\nE-mail: wesleymatos1989@gmail.com\n\nMade with the support of patrons on https://www.patreon.com/viridinostudios"
		},
		{
			"eventType": "comment",
			"text": "How large and tall each collision tile is."
		},
		{
			"eventType": "variable",
			"name": "TILESIZE",
			"type": "number",
			"initialValue": "4",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 164401157322651
		},
		{
			"eventType": "comment",
			"text": "Which player is currently playing."
		},
		{
			"eventType": "variable",
			"name": "CurrentlyPlaying",
			"type": "number",
			"initialValue": "1",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 341107001089967
		},
		{
			"eventType": "comment",
			"text": "Whether or not any of the player are allow to control their towers."
		},
		{
			"eventType": "variable",
			"name": "Playable",
			"type": "boolean",
			"initialValue": "true",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 467341999509976
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "World",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Setup the game by generating a new mask and hiding the ground collosion."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 995302023806621
						}
					],
					"actions": [
						{
							"callFunction": "GenerateMask",
							"sid": 879247548252030
						},
						{
							"id": "set-visible",
							"objectClass": "GroundCollision",
							"sid": 839583390939067,
							"parameters": {
								"visibility": "invisible"
							}
						},
						{
							"type": "comment",
							"text": "Also update the size of each arrow."
						},
						{
							"id": "set-width",
							"objectClass": "Arrow",
							"sid": 664549877987203,
							"parameters": {
								"width": "0"
							}
						},
						{
							"callFunction": "UpdateCannons",
							"sid": 174544762751272
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 683159498994674,
							"parameters": {
								"seconds": "10"
							}
						},
						{
							"id": "tween-one-property",
							"objectClass": "Tutorial",
							"sid": 661864165304836,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"SelfDestroy\"",
								"property": "offsetY",
								"end-value": "Self.Y - 96",
								"time": "0.5",
								"ease": "easeinsine",
								"destroy-on-complete": "yes",
								"loop": "no",
								"ping-pong": "no"
							}
						}
					],
					"sid": 245861240025618
				},
				{
					"eventType": "comment",
					"text": "Destroy the previous mask and generate a new one based on the ground collision."
				},
				{
					"functionName": "GenerateMask",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [],
					"eventType": "function-block",
					"conditions": [],
					"actions": [],
					"sid": 356873046385411,
					"children": [
						{
							"eventType": "comment",
							"text": "Destroy every mask object."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 913091790599688,
									"parameters": {
										"first-value": "Mask.Count",
										"comparison": 4,
										"second-value": "0"
									}
								}
							],
							"actions": [],
							"sid": 855006013759802,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-all",
											"objectClass": "System",
											"sid": 194185667494572,
											"parameters": {
												"object": "Mask"
											}
										}
									],
									"actions": [
										{
											"id": "destroy",
											"objectClass": "Mask",
											"sid": 647524619002632
										}
									],
									"sid": 897831501001953
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Loop through all tiles in the ground collision and create a new mask for each tile that's not empty."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 131857726295374,
									"parameters": {
										"name": "\"X\"",
										"start-index": "0",
										"end-index": "GroundCollision.Width / TILESIZE - 1"
									}
								}
							],
							"actions": [],
							"sid": 147143894993408,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for",
											"objectClass": "System",
											"sid": 841673920420956,
											"parameters": {
												"name": "\"Y\"",
												"start-index": "0",
												"end-index": "GroundCollision.Height / TILESIZE - 1"
											}
										}
									],
									"actions": [],
									"sid": 386531161116914,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-tile-at",
													"objectClass": "GroundCollision",
													"sid": 281174754543283,
													"parameters": {
														"tile-x": "loopindex(\"X\")",
														"tile-y": "loopindex(\"Y\")",
														"comparison": 1,
														"tile": "-1"
													}
												}
											],
											"actions": [
												{
													"id": "create-object",
													"objectClass": "System",
													"sid": 624390816382174,
													"parameters": {
														"object-to-create": "Mask",
														"layer": "\"Ground\"",
														"x": "GroundCollision.TileToPositionX(loopindex(\"X\"))",
														"y": "GroundCollision.TileToPositionX(loopindex(\"Y\"))",
														"create-hierarchy": false
													}
												},
												{
													"id": "set-size",
													"objectClass": "Mask",
													"sid": 636936165583956,
													"parameters": {
														"width": "16",
														"height": "16"
													}
												}
											],
											"sid": 264355831400682
										}
									]
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Move the ground texture to the top, so the blend modes are properly mixed."
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "move-to-top",
									"objectClass": "GroundTexture",
									"sid": 751641195334395
								}
							],
							"sid": 755062973718268
						}
					]
				},
				{
					"eventType": "comment",
					"text": "How large is the area of effectiveness of an explosion."
				},
				{
					"eventType": "variable",
					"name": "EXPLOSIONRADIUS",
					"type": "number",
					"initialValue": "16",
					"comment": "",
					"isStatic": true,
					"isConstant": true,
					"sid": 938261963262831
				},
				{
					"eventType": "comment",
					"text": "Detonate the ground in a specific area."
				},
				{
					"functionName": "DetonateArea",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "TargetX",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 773203909099515
						},
						{
							"name": "TargetY",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 818256603663718
						}
					],
					"eventType": "function-block",
					"conditions": [],
					"actions": [],
					"sid": 980308563817357,
					"children": [
						{
							"eventType": "comment",
							"text": "Loop through all tile in the ground collision and erase the ones that are inside the explosion radius."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 986269655216734,
									"parameters": {
										"name": "\"X\"",
										"start-index": "0",
										"end-index": "GroundCollision.Width / TILESIZE - 1"
									}
								}
							],
							"actions": [],
							"sid": 530135411549069,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for",
											"objectClass": "System",
											"sid": 658494174789807,
											"parameters": {
												"name": "\"Y\"",
												"start-index": "0",
												"end-index": "GroundCollision.Height / TILESIZE - 1"
											}
										}
									],
									"actions": [],
									"sid": 433627935763094,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-two-values",
													"objectClass": "System",
													"sid": 791076349128068,
													"parameters": {
														"first-value": "distance(TargetX, TargetY, GroundCollision.TileToPositionX(loopindex(\"X\")), GroundCollision.TileToPositionX(loopindex(\"Y\")))",
														"comparison": 3,
														"second-value": "EXPLOSIONRADIUS"
													}
												},
												{
													"id": "compare-tile-at",
													"objectClass": "GroundCollision",
													"sid": 715300645244824,
													"parameters": {
														"tile-x": "loopindex(\"X\")",
														"tile-y": "loopindex(\"Y\")",
														"comparison": 1,
														"tile": "-1"
													}
												}
											],
											"actions": [
												{
													"id": "erase-tile",
													"objectClass": "GroundCollision",
													"sid": 419134267283248,
													"parameters": {
														"tile-x": "loopindex(\"X\")",
														"tile-y": "loopindex(\"Y\")"
													}
												}
											],
											"sid": 790066910533687,
											"children": [
												{
													"eventType": "comment",
													"text": "There's also a 50% chance of creating flying debris after destroying a tile."
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "compare-two-values",
															"objectClass": "System",
															"sid": 279067299447022,
															"parameters": {
																"first-value": "choose(0, 1)",
																"comparison": 0,
																"second-value": "1"
															}
														}
													],
													"actions": [
														{
															"id": "create-object",
															"objectClass": "System",
															"sid": 322113620388476,
															"parameters": {
																"object-to-create": "FlyingDebris",
																"layer": "\"Battlefield\"",
																"x": "GroundCollision.TileToPositionX(loopindex(\"X\"))",
																"y": "GroundCollision.TileToPositionY(loopindex(\"Y\"))",
																"create-hierarchy": false
															}
														},
														{
															"id": "set-angle",
															"objectClass": "FlyingDebris",
															"sid": 941698712184088,
															"parameters": {
																"angle": "270"
															}
														}
													],
													"sid": 836525576500574
												}
											]
										}
									]
								}
							]
						},
						{
							"eventType": "comment",
							"text": "If there's no ground below a decoration object, destroy it so it doesn't stay flying in the air."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 815531084947292,
									"parameters": {
										"object": "Decoration"
									}
								}
							],
							"actions": [],
							"sid": 276915639539384,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-overlapping-at-offset",
											"objectClass": "Decoration",
											"sid": 834600518414874,
											"parameters": {
												"object": "GroundCollision",
												"offset-x": "0",
												"offset-y": "4"
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "destroy",
											"objectClass": "Decoration",
											"sid": 537277029522668
										}
									],
									"sid": 449355208588850
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Create an explosion on top of everything and generate a new mask to match the new ground collision shape."
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 781759496932035,
									"parameters": {
										"object-to-create": "ExplosionSmoke1",
										"layer": "\"Battlefield\"",
										"x": "TargetX",
										"y": "TargetY",
										"create-hierarchy": false
									}
								},
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 442725042811595,
									"parameters": {
										"object-to-create": "ExplosionSmoke2",
										"layer": "\"Battlefield\"",
										"x": "TargetX",
										"y": "TargetY",
										"create-hierarchy": false
									}
								},
								{
									"callFunction": "GenerateMask",
									"sid": 650392324508365
								},
								{
									"type": "comment",
									"text": "Also stick the camera to the same position, so the player has time to see what it just destroyed."
								},
								{
									"callFunction": "StickCamera",
									"sid": 364852687976953
								}
							],
							"sid": 454402557552424
						}
					]
				}
			],
			"sid": 211291316288214
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Controls",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Setup each arrow by defining their minimum and maximum angle based on their starting angle."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 715484425010897
						}
					],
					"actions": [],
					"sid": 319600489677515,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 734410846118360,
									"parameters": {
										"object": "Arrow"
									}
								}
							],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "Arrow",
									"sid": 918937057335153,
									"parameters": {
										"instance-variable": "CannonAngle",
										"value": "Self.Angle"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Arrow",
									"sid": 778134506166070,
									"parameters": {
										"instance-variable": "MinAngle",
										"value": "Self.CannonAngle - 45"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Arrow",
									"sid": 351064059762954,
									"parameters": {
										"instance-variable": "MaxAngle",
										"value": "Self.CannonAngle + 45"
									}
								}
							],
							"sid": 482685591623507
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Change the cannon angle, cannon power and even shoot based on the currently playing player input, but only if the game is playable (no game over)."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-boolean-eventvar",
							"objectClass": "System",
							"sid": 652101192611276,
							"parameters": {
								"variable": "Playable"
							}
						}
					],
					"actions": [],
					"sid": 602929131687549,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-by-comparison",
									"objectClass": "System",
									"sid": 321828678037298,
									"parameters": {
										"object": "Arrow",
										"expression": "Arrow.PlayerID",
										"comparison": 0,
										"value": "CurrentlyPlaying"
									}
								}
							],
							"actions": [],
							"sid": 823350000587308,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "key-is-down",
											"objectClass": "Keyboard",
											"sid": 107329952663260,
											"parameters": {
												"key": 37
											}
										},
										{
											"id": "is-button-down",
											"objectClass": "Gamepad",
											"sid": 893849356265154,
											"parameters": {
												"gamepad": "0",
												"button": "d-pad-left"
											}
										}
									],
									"actions": [
										{
											"callFunction": "ChangeCannonAngle",
											"sid": 115145582790998,
											"parameters": [
												"Arrow.UID",
												"-1"
											]
										}
									],
									"sid": 611523188842543,
									"isOrBlock": true
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "key-is-down",
											"objectClass": "Keyboard",
											"sid": 702405141131039,
											"parameters": {
												"key": 39
											}
										},
										{
											"id": "is-button-down",
											"objectClass": "Gamepad",
											"sid": 287388511309463,
											"parameters": {
												"gamepad": "0",
												"button": "d-pad-right"
											}
										}
									],
									"actions": [
										{
											"callFunction": "ChangeCannonAngle",
											"sid": 705487590622734,
											"parameters": [
												"Arrow.UID",
												"1"
											]
										}
									],
									"sid": 469772933312843,
									"isOrBlock": true
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "on-key-pressed",
											"objectClass": "Keyboard",
											"sid": 384931523222438,
											"parameters": {
												"key": 38
											}
										},
										{
											"id": "on-button-pressed",
											"objectClass": "Gamepad",
											"sid": 816549729348719,
											"parameters": {
												"gamepad": "0",
												"button": "d-pad-up"
											}
										}
									],
									"actions": [
										{
											"callFunction": "ChangeCannonPower",
											"sid": 176472561932730,
											"parameters": [
												"Arrow.UID",
												"1"
											]
										}
									],
									"sid": 385143399668115,
									"isOrBlock": true
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "on-key-pressed",
											"objectClass": "Keyboard",
											"sid": 219168231335856,
											"parameters": {
												"key": 40
											}
										},
										{
											"id": "on-button-pressed",
											"objectClass": "Gamepad",
											"sid": 673737771897189,
											"parameters": {
												"gamepad": "0",
												"button": "d-pad-down"
											}
										}
									],
									"actions": [
										{
											"callFunction": "ChangeCannonPower",
											"sid": 459760490953686,
											"parameters": [
												"Arrow.UID",
												"-1"
											]
										}
									],
									"sid": 848643713100769,
									"isOrBlock": true
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "on-key-pressed",
											"objectClass": "Keyboard",
											"sid": 806893128536423,
											"parameters": {
												"key": 32
											}
										},
										{
											"id": "on-button-pressed",
											"objectClass": "Gamepad",
											"sid": 362800130616868,
											"parameters": {
												"gamepad": "0",
												"button": "button-a"
											}
										}
									],
									"actions": [
										{
											"callFunction": "ShootCannon",
											"sid": 398725168887235,
											"parameters": [
												"Arrow.UID"
											]
										}
									],
									"sid": 600975944851533,
									"isOrBlock": true
								}
							]
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Change the angle of a specific cannon, but with clamped values, so the cannon doesn't rotate too much."
				},
				{
					"functionName": "ChangeCannonAngle",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "CannonUID",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 944700440915211
						},
						{
							"name": "Magnitude",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 671173762339002
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-unique-id",
							"objectClass": "Arrow",
							"sid": 605913902682201,
							"parameters": {
								"unique-id": "CannonUID"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Arrow",
							"sid": 211987760346031,
							"parameters": {
								"instance-variable": "CannonAngle",
								"value": "clamp(Self.CannonAngle + Magnitude * 60 * dt, Self.MinAngle, Self.MaxAngle)"
							}
						},
						{
							"id": "set-angle",
							"objectClass": "Arrow",
							"sid": 233908725266254,
							"parameters": {
								"angle": "Self.CannonAngle"
							}
						}
					],
					"sid": 702085301985427
				},
				{
					"eventType": "comment",
					"text": "Change the power of a specific cannon, but with clamped values, so the cannon doesn't shoot too far."
				},
				{
					"functionName": "ChangeCannonPower",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "CannonUID",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 150555844886111
						},
						{
							"name": "Magnitude",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 331140322452204
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-unique-id",
							"objectClass": "Arrow",
							"sid": 774976170166225,
							"parameters": {
								"unique-id": "CannonUID"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Arrow",
							"sid": 727015617099957,
							"parameters": {
								"instance-variable": "CannonPower",
								"value": "clamp(Self.CannonPower + Magnitude, Self.MinPower, Self.MaxPower)"
							}
						},
						{
							"callFunction": "UpdateCannons",
							"sid": 424835592086921
						}
					],
					"sid": 736224089906993
				},
				{
					"eventType": "comment",
					"text": "Shoot a heavy projectile out of a cannon tip."
				},
				{
					"functionName": "ShootCannon",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "CannonUID",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"sid": 643838188934365
						}
					],
					"eventType": "function-block",
					"conditions": [
						{
							"id": "pick-by-unique-id",
							"objectClass": "Arrow",
							"sid": 146818239639178,
							"parameters": {
								"unique-id": "CannonUID"
							}
						}
					],
					"actions": [
						{
							"id": "spawn-another-object",
							"objectClass": "Arrow",
							"sid": 549854803201954,
							"parameters": {
								"object": "CannonBall",
								"layer": "\"Battlefield\"",
								"image-point": "\"Tip\"",
								"create-hierarchy": false
							}
						},
						{
							"id": "set-angle",
							"objectClass": "CannonBall",
							"sid": 437497063365299,
							"parameters": {
								"angle": "0"
							}
						},
						{
							"type": "comment",
							"text": "Both angle and speed are based on the cannon settings."
						},
						{
							"id": "set-angle-of-motion",
							"objectClass": "CannonBall",
							"sid": 335764883518300,
							"behaviorType": "Bullet",
							"parameters": {
								"angle": "Arrow.CannonAngle"
							}
						},
						{
							"id": "set-speed",
							"objectClass": "CannonBall",
							"sid": 746978868240377,
							"behaviorType": "Bullet",
							"parameters": {
								"speed": "Arrow.CannonPower * 32"
							}
						},
						{
							"type": "comment",
							"text": "Once the projectile have been shot, switch and update the cannons, so the other player can play as well."
						},
						{
							"callFunction": "SwitchCannons",
							"sid": 183413419934860
						},
						{
							"callFunction": "UpdateCannons",
							"sid": 139103650078376
						}
					],
					"sid": 565159595446476
				},
				{
					"eventType": "comment",
					"text": "Switch between both cannons, so both player can play the game in turns."
				},
				{
					"functionName": "SwitchCannons",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [],
					"eventType": "function-block",
					"conditions": [],
					"actions": [],
					"sid": 926989404962827,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 975641094611757,
									"parameters": {
										"variable": "CurrentlyPlaying",
										"comparison": 0,
										"value": "1"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 899219206315990,
									"parameters": {
										"variable": "CurrentlyPlaying",
										"value": "2"
									}
								}
							],
							"sid": 612628415073085
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 858463780502631
								},
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 497086713565495,
									"parameters": {
										"variable": "CurrentlyPlaying",
										"comparison": 0,
										"value": "2"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 218325148849059,
									"parameters": {
										"variable": "CurrentlyPlaying",
										"value": "1"
									}
								}
							],
							"sid": 445261756984704
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Update the visuals of all cannons arrows, so the expand and contract accordingly."
				},
				{
					"functionName": "UpdateCannons",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [],
					"eventType": "function-block",
					"conditions": [],
					"actions": [],
					"sid": 962385584705269,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 970768342359944,
									"parameters": {
										"object": "Arrow"
									}
								}
							],
							"actions": [
								{
									"id": "stop-all-tweens",
									"objectClass": "Arrow",
									"sid": 311277262474039,
									"behaviorType": "Tween"
								}
							],
							"sid": 387594981681309,
							"children": [
								{
									"eventType": "comment",
									"text": "Expand the arrow of the currently playing player."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "Arrow",
											"sid": 530291325203384,
											"parameters": {
												"instance-variable": "PlayerID",
												"comparison": 0,
												"value": "CurrentlyPlaying"
											}
										}
									],
									"actions": [
										{
											"id": "tween-one-property",
											"objectClass": "Arrow",
											"sid": 458146221540802,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"Expand\"",
												"property": "offsetWidth",
												"end-value": "Self.ImageWidth",
												"time": "0.25",
												"ease": "easeoutback",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no"
											}
										}
									],
									"sid": 798915174371463,
									"children": [
										{
											"eventType": "comment",
											"text": "Also update its power meter."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "pick-by-comparison",
													"objectClass": "System",
													"sid": 551186478603659,
													"parameters": {
														"object": "PowerMeter",
														"expression": "PowerMeter.PlayerID",
														"comparison": 0,
														"value": "Arrow.PlayerID"
													}
												}
											],
											"actions": [
												{
													"id": "set-width",
													"objectClass": "PowerMeter",
													"sid": 734476380827800,
													"parameters": {
														"width": "1 +3 * Arrow.CannonPower"
													}
												}
											],
											"sid": 791577892855322
										}
									]
								},
								{
									"eventType": "comment",
									"text": "Contract the arrow of the other player."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 527529885390429
										},
										{
											"id": "compare-instance-variable",
											"objectClass": "Arrow",
											"sid": 168132920765947,
											"parameters": {
												"instance-variable": "PlayerID",
												"comparison": 1,
												"value": "CurrentlyPlaying"
											}
										}
									],
									"actions": [
										{
											"id": "tween-one-property",
											"objectClass": "Arrow",
											"sid": 455002955990096,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"Contract\"",
												"property": "offsetWidth",
												"end-value": "0",
												"time": "0.1",
												"ease": "easeinsine",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no"
											}
										}
									],
									"sid": 321208624797516,
									"children": [
										{
											"eventType": "comment",
											"text": "Also update its power meter."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "pick-by-comparison",
													"objectClass": "System",
													"sid": 158040750538961,
													"parameters": {
														"object": "PowerMeter",
														"expression": "PowerMeter.PlayerID",
														"comparison": 0,
														"value": "Arrow.PlayerID"
													}
												}
											],
											"actions": [
												{
													"id": "set-width",
													"objectClass": "PowerMeter",
													"sid": 315513947787310,
													"parameters": {
														"width": "1 +3 * Arrow.CannonPower"
													}
												}
											],
											"sid": 405591741501345
										}
									]
								}
							]
						}
					]
				}
			],
			"sid": 454746286840167
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "CannonBall",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Once a cannon ball is created, attach a smoke trail behind it."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-created",
							"objectClass": "CannonBall",
							"sid": 333513814341010
						}
					],
					"actions": [
						{
							"id": "spawn-another-object",
							"objectClass": "CannonBall",
							"sid": 667091630701845,
							"parameters": {
								"object": "SmokeTrail",
								"layer": "\"Battlefield\"",
								"image-point": "0",
								"create-hierarchy": false
							}
						},
						{
							"id": "set-position-to-another-object",
							"objectClass": "SmokeTrail",
							"sid": 903084096244616,
							"parameters": {
								"object": "CannonBall",
								"image-point-optional": "0"
							}
						},
						{
							"id": "move-to-object",
							"objectClass": "SmokeTrail",
							"sid": 722719348345961,
							"parameters": {
								"where": "behind",
								"object": "CannonBall"
							}
						},
						{
							"id": "add-child",
							"objectClass": "CannonBall",
							"sid": 837687676004037,
							"parameters": {
								"child": "SmokeTrail",
								"transform-x": true,
								"transform-y": true,
								"transform-w": false,
								"transform-h": false,
								"transform-a": false,
								"transform-z-elevation": false,
								"destroy-with-parent": false
							}
						}
					],
					"sid": 632830805059117
				},
				{
					"eventType": "comment",
					"text": "If a cannon ball collides with ground, disable its bullet behavior so it doesn't move anymore."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "CannonBall",
							"sid": 585977218703294,
							"parameters": {
								"object": "GroundCollision"
							}
						}
					],
					"actions": [
						{
							"id": "set-enabled",
							"objectClass": "CannonBall",
							"sid": 439249267225610,
							"behaviorType": "Bullet",
							"parameters": {
								"state": "disabled"
							}
						}
					],
					"sid": 282349677812802,
					"children": [
						{
							"eventType": "comment",
							"text": "Remove if cannon ball from the ground, so the explosion only occurs in the ground surface."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "while",
									"objectClass": "System",
									"sid": 127795134752834
								},
								{
									"id": "is-overlapping-another-object",
									"objectClass": "CannonBall",
									"sid": 739744272510969,
									"parameters": {
										"object": "GroundCollision"
									}
								}
							],
							"actions": [
								{
									"id": "move-at-angle",
									"objectClass": "CannonBall",
									"sid": 966915038709906,
									"parameters": {
										"angle": "Self.Bullet.AngleOfMotion + 180",
										"distance": "0.1"
									}
								}
							],
							"sid": 788339301927716
						},
						{
							"eventType": "comment",
							"text": "Destroy the area around the cannon ball while also destroying it."
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"callFunction": "DetonateArea",
									"sid": 354943787931240,
									"parameters": [
										"CannonBall.X",
										"CannonBall.Y"
									]
								},
								{
									"id": "destroy",
									"objectClass": "CannonBall",
									"sid": 887299703100138
								}
							],
							"sid": 575166274029542
						}
					]
				},
				{
					"eventType": "comment",
					"text": "If a cannon ball collides with a tower, destroy both the cannon ball and the tower, while also temporarily preventing the game from being played."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "CannonBall",
							"sid": 742837162960132,
							"parameters": {
								"object": "Tower"
							}
						}
					],
					"actions": [
						{
							"id": "destroy",
							"objectClass": "CannonBall",
							"sid": 357527353815377
						}
					],
					"sid": 803537167542844,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-boolean-eventvar",
									"objectClass": "System",
									"sid": 562228382983830,
									"parameters": {
										"variable": "Playable"
									}
								}
							],
							"actions": [
								{
									"id": "set-boolean-eventvar",
									"objectClass": "System",
									"sid": 835256773502780,
									"parameters": {
										"variable": "Playable",
										"value": "false"
									}
								},
								{
									"callFunction": "DetonateArea",
									"sid": 242364614912511,
									"parameters": [
										"Tower.ImagePointX(\"Ground\")",
										"Tower.ImagePointY(\"Ground\")"
									]
								},
								{
									"id": "set-visible",
									"objectClass": "Tower",
									"sid": 146895359853506,
									"parameters": {
										"visibility": "invisible"
									}
								}
							],
							"sid": 499328190261430,
							"children": [
								{
									"eventType": "comment",
									"text": "Also hide all user interface elements and wait three seconds before restarting the game."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-by-comparison",
											"objectClass": "System",
											"sid": 345997900558821,
											"parameters": {
												"object": "Arrow",
												"expression": "Arrow.PlayerID",
												"comparison": 0,
												"value": "Tower.PlayerID"
											}
										}
									],
									"actions": [
										{
											"id": "set-visible",
											"objectClass": "Arrow",
											"sid": 543430793156347,
											"parameters": {
												"visibility": "invisible"
											}
										}
									],
									"sid": 967244082358329
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-by-comparison",
											"objectClass": "System",
											"sid": 709494375168253,
											"parameters": {
												"object": "PowerMeter",
												"expression": "PowerMeter.PlayerID",
												"comparison": 0,
												"value": "Tower.PlayerID"
											}
										}
									],
									"actions": [
										{
											"id": "set-visible",
											"objectClass": "PowerMeter",
											"sid": 631285333210097,
											"parameters": {
												"visibility": "invisible"
											}
										}
									],
									"sid": 193827736729372
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "wait",
											"objectClass": "System",
											"sid": 570929637180540,
											"parameters": {
												"seconds": "3"
											}
										},
										{
											"callFunction": "GameOver",
											"sid": 592810088518364
										}
									],
									"sid": 608174798706453
								}
							]
						}
					]
				},
				{
					"eventType": "comment",
					"text": "Once a cannon ball is destroyed, release its smoke trail and destroy it after a second, so it doesn't keep consuming any computing resources."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-destroyed",
							"objectClass": "CannonBall",
							"sid": 216510882187562
						}
					],
					"actions": [],
					"sid": 759450310219850,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "has-children",
									"objectClass": "CannonBall",
									"sid": 247349522024448
								}
							],
							"actions": [],
							"sid": 820423127964530,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-children",
											"objectClass": "CannonBall",
											"sid": 967908580184887,
											"parameters": {
												"child": "SmokeTrail",
												"which": "own"
											}
										}
									],
									"actions": [
										{
											"id": "set-rate",
											"objectClass": "SmokeTrail",
											"sid": 673475817896782,
											"parameters": {
												"rate": "0"
											}
										},
										{
											"id": "tween-value",
											"objectClass": "SmokeTrail",
											"sid": 834029392129496,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"SelfDestroy\"",
												"start-value": "0",
												"end-value": "0",
												"time": "1",
												"ease": "default",
												"destroy-on-complete": "yes",
												"loop": "no",
												"ping-pong": "no"
											}
										}
									],
									"sid": 464526411819130
								}
							]
						}
					]
				}
			],
			"sid": 724137303372850
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Background",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Constantly increase the horizontal offset of the clouds, so it looks like they're moving."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "every-tick",
							"objectClass": "System",
							"sid": 921233683906881
						}
					],
					"actions": [
						{
							"id": "set-image-offset-x",
							"objectClass": "Clouds",
							"sid": 834051059142950,
							"parameters": {
								"offset-x": "Self.ImageOffsetX + 0.1 * 60 * dt"
							}
						}
					],
					"sid": 815692506226337
				}
			],
			"sid": 394661312509307
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "GameOver",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Restart the game and reset all global variables, so nothing from the previous session is carried over."
				},
				{
					"functionName": "GameOver",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [],
					"eventType": "function-block",
					"conditions": [],
					"actions": [
						{
							"id": "reset-global-variables",
							"objectClass": "System",
							"sid": 341361481020443
						},
						{
							"id": "restart-layout",
							"objectClass": "System",
							"sid": 353934068887481
						}
					],
					"sid": 948323999806213
				}
			],
			"sid": 695010727229180
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Camera",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Prevent the camera from moving for a small amount of time."
				},
				{
					"functionName": "StickCamera",
					"functionDescription": "",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionIsAsync": false,
					"functionParameters": [],
					"eventType": "function-block",
					"conditions": [],
					"actions": [
						{
							"id": "stop-tweens",
							"objectClass": "GameManager",
							"sid": 694389092599209,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"StickCamera\""
							}
						},
						{
							"id": "tween-value",
							"objectClass": "GameManager",
							"sid": 892500507379420,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"StickCamera\"",
								"start-value": "0",
								"end-value": "0",
								"time": "0.5",
								"ease": "default",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no"
							}
						}
					],
					"sid": 231835963679948
				},
				{
					"eventType": "comment",
					"text": "Position where the camera will move next."
				},
				{
					"eventType": "variable",
					"name": "CameraX",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 196144736746283
				},
				{
					"eventType": "variable",
					"name": "CameraY",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 253463798009088
				},
				{
					"eventType": "comment",
					"text": "Only allow the camera to move if the \"StickCamera\" tween animation is not being played."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-playing",
							"objectClass": "GameManager",
							"sid": 353558047316641,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"StickCamera\""
							},
							"isInverted": true
						}
					],
					"actions": [],
					"sid": 402283591577424,
					"children": [
						{
							"eventType": "comment",
							"text": "If there's at least one cannon ball in the layout, calculate their middle position and set the camera position to match it."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 590893691961962,
									"parameters": {
										"first-value": "CannonBall.Count",
										"comparison": 4,
										"second-value": "0"
									}
								}
							],
							"actions": [],
							"sid": 761296429296171,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for-each",
											"objectClass": "System",
											"sid": 112176940170724,
											"parameters": {
												"object": "CannonBall"
											}
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 354559465995592,
											"parameters": {
												"variable": "CameraX",
												"value": "CameraX + CannonBall.X"
											}
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 177421001989958,
											"parameters": {
												"variable": "CameraY",
												"value": "CameraY + CannonBall.Y"
											}
										}
									],
									"sid": 154474164342550
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 679788991213066,
											"parameters": {
												"variable": "CameraX",
												"value": "CameraX / CannonBall.Count"
											}
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 370849200297120,
											"parameters": {
												"variable": "CameraY",
												"value": "CameraY / CannonBall.Count"
											}
										}
									],
									"sid": 503549659538190
								}
							]
						},
						{
							"eventType": "comment",
							"text": "However, if there's no cannon balls in the layout, set the camera position to match the currently playing player."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 507007290075922
								},
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 572969355243877,
									"parameters": {
										"first-value": "CannonBall.Count",
										"comparison": 0,
										"second-value": "0"
									}
								}
							],
							"actions": [],
							"sid": 666206015384863,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-by-comparison",
											"objectClass": "System",
											"sid": 273146333446390,
											"parameters": {
												"object": "Arrow",
												"expression": "Arrow.PlayerID",
												"comparison": 0,
												"value": "CurrentlyPlaying"
											}
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 800436061780915,
											"parameters": {
												"variable": "CameraX",
												"value": "Arrow.X"
											}
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 108988328651715,
											"parameters": {
												"variable": "CameraY",
												"value": "Arrow.Y"
											}
										}
									],
									"sid": 660649197163165
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Scroll the viewport towards the camera position, but using linear interpolation for a smoother result."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "every-tick",
									"objectClass": "System",
									"sid": 519414907432410
								}
							],
							"actions": [
								{
									"id": "scroll-to-position",
									"objectClass": "System",
									"sid": 393555999194129,
									"parameters": {
										"x": "lerp(scrollx, CameraX, 0.1 * 60 * dt)",
										"y": "lerp(scrolly, CameraY, 0.1 * 60 * dt)"
									}
								}
							],
							"sid": 823141193938612
						}
					]
				}
			],
			"sid": 209735474874112
		}
	],
	"sid": 827996755129847
}