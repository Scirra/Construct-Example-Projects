{
	"name": "EnemyEvents",
	"events": [
		{
			"eventType": "include",
			"includeSheet": "SoundEvents"
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "EnemyProjectiles",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Create an enemy projectile."
				},
				{
					"aceType": "action",
					"aceName": "Create projectile",
					"objectClass": "EnemyProjectile",
					"functionDescription": "Create an enemy projectile",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [
						{
							"name": "template",
							"type": "string",
							"initialValue": "",
							"comment": "Projectile template",
							"sid": 386144756459788
						},
						{
							"name": "x",
							"type": "number",
							"initialValue": "0",
							"comment": "X position",
							"sid": 790903418921053
						},
						{
							"name": "y",
							"type": "number",
							"initialValue": "0",
							"comment": "Y position",
							"sid": 732023553151347
						},
						{
							"name": "z",
							"type": "number",
							"initialValue": "0",
							"comment": "Z position",
							"sid": 395474541228604
						},
						{
							"name": "angleOfMotion",
							"type": "number",
							"initialValue": "0",
							"comment": "Angle of motion",
							"sid": 713266908902104
						}
					],
					"eventType": "custom-ace-block",
					"conditions": [],
					"actions": [
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 729844499421080,
							"parameters": {
								"object-to-create": "EnemyProjectile",
								"layer": "\"Entities\"",
								"x": "x",
								"y": "y",
								"create-hierarchy": true,
								"template-name": "template"
							}
						},
						{
							"id": "set-z-elevation",
							"objectClass": "EnemyProjectile",
							"sid": 725985964547106,
							"parameters": {
								"z": "z"
							}
						},
						{
							"id": "set-angle-of-motion",
							"objectClass": "EnemyProjectile",
							"sid": 339966569098439,
							"behaviorType": "Bullet",
							"parameters": {
								"angle": "angleOfMotion"
							}
						},
						{
							"id": "start-timer",
							"objectClass": "EnemyProjectile",
							"sid": 675102314827827,
							"behaviorType": "Timer",
							"parameters": {
								"duration": "10",
								"type": "once",
								"tag": "\"ProjectileLifespan\""
							}
						}
					],
					"sid": 337139552697237
				},
				{
					"eventType": "comment",
					"text": "Destroy this enemy projectile."
				},
				{
					"aceType": "action",
					"aceName": "Destroy projectile",
					"objectClass": "EnemyProjectile",
					"functionDescription": "Destroy this enemy projectile",
					"functionCategory": "",
					"functionReturnType": "none",
					"functionCopyPicked": false,
					"functionIsAsync": false,
					"functionParameters": [],
					"eventType": "custom-ace-block",
					"conditions": [
						{
							"id": "pick-children",
							"objectClass": "EnemyProjectile",
							"sid": 878740156243374,
							"parameters": {
								"child": "EnemyProjectileParticles",
								"which": "own"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Create projectile hit effect."
						},
						{
							"callFunction": "createFX",
							"sid": 946534216651693,
							"parameters": [
								"\"Billboard\"",
								"EnemyProjectile.pHit",
								"EnemyProjectile.X",
								"EnemyProjectile.Y + 4",
								"EnemyProjectile.ZElevation"
							]
						},
						{
							"type": "comment",
							"text": "Destroy the projectile itself."
						},
						{
							"id": "destroy",
							"objectClass": "EnemyProjectile",
							"sid": 989742759799623
						},
						{
							"type": "comment",
							"text": "Destroy the particles gracefully."
						},
						{
							"id": "set-rate",
							"objectClass": "EnemyProjectileParticles",
							"sid": 845510736396316,
							"parameters": {
								"rate": "0"
							}
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 937858424398534,
							"parameters": {
								"seconds": "1",
								"use-timescale": true
							}
						},
						{
							"id": "destroy",
							"objectClass": "EnemyProjectileParticles",
							"sid": 541301069276003
						}
					],
					"sid": 643637660637376
				},
				{
					"eventType": "comment",
					"text": "Player hit by enemy projectile."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "EnemyProjectile",
							"sid": 552517470495999,
							"parameters": {
								"object": "Player"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 417112461331765,
							"parameters": {
								"value": "EnemyProjectile.ZElevation <= Player.ZElevation + PlayerBillboard.ZHeight"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 488953824786004,
							"parameters": {
								"value": "EnemyProjectile.ZElevation >= Player.ZElevation"
							}
						}
					],
					"actions": [
						{
							"customAction": "Hit",
							"objectClass": "Player",
							"sid": 221767484071390,
							"parameters": [
								"EnemyProjectile.damage"
							]
						},
						{
							"customAction": "Destroy projectile",
							"objectClass": "EnemyProjectile",
							"sid": 502951664759682
						}
					],
					"sid": 750898535685648
				},
				{
					"eventType": "comment",
					"text": "Enemy projectile hit geometry."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "EnemyProjectile",
							"sid": 161442979482632,
							"parameters": {
								"object": "Geometry"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 575212413229957,
							"parameters": {
								"value": "EnemyProjectile.ZElevation <= Geometry.ZElevation + Geometry.ZHeight"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 313375554541042,
							"parameters": {
								"value": "EnemyProjectile.ZElevation >= Geometry.ZElevation"
							}
						}
					],
					"actions": [
						{
							"customAction": "Destroy projectile",
							"objectClass": "EnemyProjectile",
							"sid": 532164343305453
						}
					],
					"sid": 695144276034898
				},
				{
					"eventType": "comment",
					"text": "Enemy projectile hit stalagmite."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-collision-with-another-object",
							"objectClass": "EnemyProjectile",
							"sid": 851579473245468,
							"parameters": {
								"object": "StalagmiteGeometry"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 664340372289415,
							"parameters": {
								"value": "EnemyProjectile.ZElevation <= StalagmiteGeometry.ZElevation + StalagmiteGeometry.ZHeight"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 586783921121530,
							"parameters": {
								"value": "EnemyProjectile.ZElevation >= StalagmiteGeometry.ZElevation"
							}
						}
					],
					"actions": [
						{
							"customAction": "Destroy projectile",
							"objectClass": "EnemyProjectile",
							"sid": 103468526951571
						}
					],
					"sid": 820607122741570
				},
				{
					"eventType": "comment",
					"text": "Projectile lifespan has ended."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-timer",
							"objectClass": "EnemyProjectile",
							"sid": 403288239171893,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"ProjectileLifespan\""
							}
						}
					],
					"actions": [
						{
							"customAction": "Destroy projectile",
							"objectClass": "EnemyProjectile",
							"sid": 411190338056967
						}
					],
					"sid": 800331630753186
				}
			],
			"sid": 159923825733565
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Enemy Melee",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "group",
					"disabled": false,
					"title": "Enemy Melee Setup",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Setup enemy."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-created",
									"objectClass": "EnemyMelee",
									"sid": 201731160597666
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Add obstacles."
								},
								{
									"id": "add-obstacle",
									"objectClass": "EnemyMelee",
									"sid": 928726698412428,
									"behaviorType": "Pathfinding",
									"parameters": {
										"obstacle": "EnemyNoGoZone"
									}
								},
								{
									"type": "comment",
									"text": "Move parts to the correct positions."
								},
								{
									"id": "set-z-elevation",
									"objectClass": "EnemyMeleeBillboard",
									"sid": 952491638122661,
									"parameters": {
										"z": "EnemyMelee.ZElevation"
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "EnemyMeleeAoE",
									"sid": 411050656570918,
									"parameters": {
										"z": "EnemyMelee.ZElevation"
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "EnemyMeleeFreeCheck",
									"sid": 719266569982988,
									"parameters": {
										"z": "EnemyMelee.ZElevation"
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "EnemyMeleeShadow",
									"sid": 370913625841220,
									"parameters": {
										"z": "EnemyMelee.ZElevation + 1"
									}
								},
								{
									"id": "set-position",
									"objectClass": "EnemyMeleeTextures",
									"sid": 623618744534079,
									"parameters": {
										"x": "-10000",
										"y": "-10000"
									}
								},
								{
									"type": "comment",
									"text": "Start billboard animation."
								},
								{
									"id": "tween-one-property",
									"objectClass": "EnemyMeleeBillboard",
									"sid": 644370763860804,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"BillboardZElevation\"",
										"property": "offsetZElevation",
										"end-value": "Self.ZElevation + 4",
										"time": "0.33",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "yes",
										"repeat-count": "1"
									}
								},
								{
									"type": "comment",
									"text": "Create hierarchy."
								},
								{
									"id": "add-child",
									"objectClass": "EnemyMelee",
									"sid": 664032494860381,
									"parameters": {
										"child": "EnemyMeleeBillboard",
										"transform-x": true,
										"transform-y": true,
										"transform-w": false,
										"transform-h": false,
										"transform-a": false,
										"transform-o": false,
										"transform-z-elevation": true,
										"transform-visibility": false,
										"destroy-with-parent": true
									}
								},
								{
									"id": "add-child",
									"objectClass": "EnemyMelee",
									"sid": 711865606668511,
									"parameters": {
										"child": "EnemyMeleeShadow",
										"transform-x": true,
										"transform-y": true,
										"transform-w": false,
										"transform-h": false,
										"transform-a": false,
										"transform-o": false,
										"transform-z-elevation": true,
										"transform-visibility": false,
										"destroy-with-parent": true
									}
								},
								{
									"id": "add-child",
									"objectClass": "EnemyMelee",
									"sid": 868527915621696,
									"parameters": {
										"child": "EnemyMeleeAoE",
										"transform-x": true,
										"transform-y": true,
										"transform-w": false,
										"transform-h": false,
										"transform-a": false,
										"transform-o": false,
										"transform-z-elevation": true,
										"transform-visibility": false,
										"destroy-with-parent": true
									}
								},
								{
									"id": "add-child",
									"objectClass": "EnemyMelee",
									"sid": 835386186708357,
									"parameters": {
										"child": "EnemyMeleeFreeCheck",
										"transform-x": true,
										"transform-y": true,
										"transform-w": false,
										"transform-h": false,
										"transform-a": false,
										"transform-o": false,
										"transform-z-elevation": true,
										"transform-visibility": false,
										"destroy-with-parent": true
									}
								},
								{
									"type": "comment",
									"text": "Process first world state."
								},
								{
									"customAction": "Act",
									"objectClass": "EnemyMelee",
									"sid": 843791408045673
								}
							],
							"sid": 629901968025174
						}
					],
					"sid": 730624975002707
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "Enemy Melee Actions",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Set current enemy state."
						},
						{
							"aceType": "action",
							"aceName": "Set state",
							"objectClass": "EnemyMelee",
							"functionDescription": "Set current enemy state",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "state",
									"type": "string",
									"initialValue": "",
									"comment": "State to set",
									"sid": 445323843929627
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "EnemyMelee",
									"sid": 290104403834775,
									"parameters": {
										"instance-variable": "state",
										"value": "state"
									}
								}
							],
							"sid": 928107640371324
						},
						{
							"eventType": "comment",
							"text": "Override current action immediately."
						},
						{
							"aceType": "action",
							"aceName": "Override act",
							"objectClass": "EnemyMelee",
							"functionDescription": "Override current action immediately",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 943668860027050,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"dead\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 685454898079831,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"hit\""
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyMelee",
									"sid": 891406190519049,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Stop everything."
								},
								{
									"id": "stop-all-timers",
									"objectClass": "EnemyMelee",
									"sid": 843240481844193,
									"behaviorType": "Timer"
								},
								{
									"id": "stop",
									"objectClass": "EnemyMelee",
									"sid": 641574887466919,
									"behaviorType": "Pathfinding"
								},
								{
									"type": "comment",
									"text": "Perform a new action."
								},
								{
									"customAction": "Act",
									"objectClass": "EnemyMelee",
									"sid": 962550760331133
								}
							],
							"sid": 597701141081697
						},
						{
							"eventType": "comment",
							"text": "Process the world state and act based on it."
						},
						{
							"aceType": "action",
							"aceName": "Act",
							"objectClass": "EnemyMelee",
							"functionDescription": "Process the world state and act based on it",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 629543314773038,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"dead\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 315168109128489,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"hit\""
									}
								}
							],
							"actions": [],
							"sid": 997305869638494,
							"children": [
								{
									"eventType": "comment",
									"text": "The player is on the same geometry block as the enemy."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "EnemyMelee",
											"sid": 668490731755912,
											"parameters": {
												"instance-variable": "onGeometryID",
												"comparison": 0,
												"value": "Player.onGeometryID"
											}
										},
										{
											"id": "is-boolean-instance-variable-set",
											"objectClass": "Player",
											"sid": 860264026727748,
											"parameters": {
												"instance-variable": "cloaked"
											},
											"isInverted": true
										}
									],
									"actions": [],
									"sid": 500649473554117,
									"children": [
										{
											"eventType": "comment",
											"text": "If close enough to the player, perform an attack."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "is-overlapping-another-object",
													"objectClass": "EnemyMeleeAoE",
													"sid": 462768428834649,
													"parameters": {
														"object": "Player"
													}
												}
											],
											"actions": [
												{
													"customAction": "Attack",
													"objectClass": "EnemyMelee",
													"sid": 453991031445202
												}
											],
											"sid": 882958804660523
										},
										{
											"eventType": "comment",
											"text": "Otherwise follow the player."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "else",
													"objectClass": "System",
													"sid": 956907715187472
												}
											],
											"actions": [
												{
													"customAction": "Follow",
													"objectClass": "EnemyMelee",
													"sid": 929825743379003
												}
											],
											"sid": 745320365374033
										}
									]
								},
								{
									"eventType": "comment",
									"text": "The player is not on the same geometry block as the enemy."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 735934189237635
										}
									],
									"actions": [
										{
											"customAction": "Patrol",
											"objectClass": "EnemyMelee",
											"sid": 254545654086577
										}
									],
									"sid": 293104248858275
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Patrol the area."
						},
						{
							"aceType": "action",
							"aceName": "Patrol",
							"objectClass": "EnemyMelee",
							"functionDescription": "Patrol the area",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 888976710666610,
									"parameters": {
										"object": "Geometry",
										"expression": "Geometry.geometryID = EnemyMelee.onGeometryID"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 525954270933642,
									"parameters": {
										"object": "Geometry",
										"which": "highest",
										"expression": "Geometry.Height * Geometry.Width"
									}
								},
								{
									"id": "pick-random-instance",
									"objectClass": "System",
									"sid": 978552212747833,
									"parameters": {
										"object": "Geometry"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyMelee",
									"sid": 802334947831178,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"customAction": "Set state",
									"objectClass": "EnemyMelee",
									"sid": 843787525569862,
									"parameters": [
										"\"patrol\""
									]
								},
								{
									"type": "comment",
									"text": "Search path."
								},
								{
									"id": "find-path",
									"objectClass": "EnemyMelee",
									"sid": 970747029375734,
									"behaviorType": "Pathfinding",
									"parameters": {
										"x": "random(\n    Geometry.X - Geometry.Width/2 + EnemyMelee.Width/2,\n    Geometry.X + Geometry.Width/2 - EnemyMelee.Width/2\n)",
										"y": "random(\r\n    Geometry.Y - Geometry.Height/2 + EnemyMelee.Height/2,\r\n    Geometry.Y + Geometry.Height/2 - EnemyMelee.Height/2\r\n)"
									}
								}
							],
							"sid": 734980698604454
						},
						{
							"eventType": "comment",
							"text": "Patrol an area nearby."
						},
						{
							"aceType": "action",
							"aceName": "Mini patrol",
							"objectClass": "EnemyMelee",
							"functionDescription": "Patrol an area nearby",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 966278278322132,
									"parameters": {
										"object": "Geometry",
										"expression": "Geometry.geometryID = EnemyMelee.onGeometryID"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 170424896613794,
									"parameters": {
										"object": "Geometry",
										"which": "highest",
										"expression": "Geometry.Height * Geometry.Width"
									}
								},
								{
									"id": "pick-random-instance",
									"objectClass": "System",
									"sid": 474772473828832,
									"parameters": {
										"object": "Geometry"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyMelee",
									"sid": 243629453629546,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"customAction": "Set state",
									"objectClass": "EnemyMelee",
									"sid": 305737788236603,
									"parameters": [
										"\"patrol\""
									]
								},
								{
									"type": "comment",
									"text": "Search path."
								},
								{
									"id": "find-path",
									"objectClass": "EnemyMelee",
									"sid": 235319095511683,
									"behaviorType": "Pathfinding",
									"parameters": {
										"x": "clamp(\n    random(Self.X - 32, Self.X + 32),\n    Geometry.X - Geometry.Width/2 + EnemyMelee.Width/2,\n    Geometry.X + Geometry.Width/2 - EnemyMelee.Width/2\n)",
										"y": "clamp(\n    random(Self.Y - 32, Self.Y + 32),\r\n    Geometry.Y - Geometry.Height/2 + EnemyMelee.Height/2,\r\n    Geometry.Y + Geometry.Height/2 - EnemyMelee.Height/2\r\n)"
									}
								}
							],
							"sid": 565764670844938
						},
						{
							"eventType": "comment",
							"text": "Follow the player."
						},
						{
							"aceType": "action",
							"aceName": "Follow",
							"objectClass": "EnemyMelee",
							"functionDescription": "Follow the player",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 586918445780417,
									"parameters": {
										"object": "Geometry",
										"expression": "Geometry.geometryID = EnemyMelee.onGeometryID"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 390961308021509,
									"parameters": {
										"object": "Geometry",
										"which": "lowest",
										"expression": "distance(Geometry.X, Geometry.Y, Player.X, Player.Y)"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyMelee",
									"sid": 396782551865592,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"customAction": "Set state",
									"objectClass": "EnemyMelee",
									"sid": 961926708939196,
									"parameters": [
										"\"follow\""
									]
								},
								{
									"type": "comment",
									"text": "Search path."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyMelee",
									"sid": 161963815987272,
									"behaviorType": "Timer",
									"parameters": {
										"duration": "0.1",
										"type": "once",
										"tag": "\"RefreshFollowPath\""
									}
								}
							],
							"sid": 164969277386586
						},
						{
							"eventType": "comment",
							"text": "Make enemy wait before taking a new action."
						},
						{
							"aceType": "action",
							"aceName": "Wait",
							"objectClass": "EnemyMelee",
							"functionDescription": "Make enemy wait before taking a new action",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "timeToWait",
									"type": "number",
									"initialValue": "1",
									"comment": "How much time the enemy should wait",
									"sid": 498964373213208
								},
								{
									"name": "nextAction",
									"type": "string",
									"initialValue": "",
									"comment": "Next action to be performed",
									"sid": 912580921114859
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [],
							"sid": 888137288796838,
							"children": [
								{
									"eventType": "comment",
									"text": "Act action."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-eventvar",
											"objectClass": "System",
											"sid": 493993463873659,
											"parameters": {
												"variable": "nextAction",
												"comparison": 0,
												"value": "\"act\""
											}
										}
									],
									"actions": [
										{
											"id": "start-timer",
											"objectClass": "EnemyMelee",
											"sid": 968157545748240,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "timeToWait",
												"type": "once",
												"tag": "\"WaitToAct\""
											}
										}
									],
									"sid": 423701095117748
								},
								{
									"eventType": "comment",
									"text": "Attack action."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 518234200855626
										},
										{
											"id": "compare-eventvar",
											"objectClass": "System",
											"sid": 804728206469932,
											"parameters": {
												"variable": "nextAction",
												"comparison": 0,
												"value": "\"attack\""
											}
										}
									],
									"actions": [
										{
											"id": "start-timer",
											"objectClass": "EnemyMelee",
											"sid": 716627051189762,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "timeToWait",
												"type": "once",
												"tag": "\"WaitToAttack\""
											}
										}
									],
									"sid": 325808854317443
								},
								{
									"eventType": "comment",
									"text": "Recover action."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 917994358781481
										},
										{
											"id": "compare-eventvar",
											"objectClass": "System",
											"sid": 327493177756274,
											"parameters": {
												"variable": "nextAction",
												"comparison": 0,
												"value": "\"recover\""
											}
										}
									],
									"actions": [
										{
											"id": "start-timer",
											"objectClass": "EnemyMelee",
											"sid": 152419416997544,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "timeToWait",
												"type": "once",
												"tag": "\"WaitToRecover\""
											}
										}
									],
									"sid": 654341191909864
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Attack the player."
						},
						{
							"aceType": "action",
							"aceName": "Attack",
							"objectClass": "EnemyMelee",
							"functionDescription": "Attack the player",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyMelee",
									"sid": 961418390117781,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"customAction": "Set state",
									"objectClass": "EnemyMelee",
									"sid": 226824273808896,
									"parameters": [
										"\"attack\""
									]
								},
								{
									"type": "comment",
									"text": "Wait a little before attacking."
								},
								{
									"customAction": "Wait",
									"objectClass": "EnemyMelee",
									"sid": 805546608820741,
									"parameters": [
										"0.5",
										"\"attack\""
									]
								}
							],
							"sid": 201250482748730
						},
						{
							"eventType": "comment",
							"text": "Rotate the enemy."
						},
						{
							"aceType": "action",
							"aceName": "Rotate",
							"objectClass": "EnemyMelee",
							"functionDescription": "Rotate the enemy",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "newAngle",
									"type": "number",
									"initialValue": "0",
									"comment": "Angle to set",
									"sid": 266902384255583
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "EnemyMelee",
									"sid": 588201664305594,
									"parameters": {
										"instance-variable": "currentAngle",
										"value": "Functions.ConvertAngle(Functions.RoundNumber(newAngle, 45))"
									}
								},
								{
									"id": "set-angle",
									"objectClass": "EnemyMeleeAoE",
									"sid": 648728594906132,
									"parameters": {
										"angle": "EnemyMelee.currentAngle"
									}
								},
								{
									"id": "set-angle",
									"objectClass": "EnemyMeleeFreeCheck",
									"sid": 986717046068171,
									"parameters": {
										"angle": "EnemyMelee.currentAngle"
									}
								}
							],
							"sid": 406758125859013
						},
						{
							"eventType": "comment",
							"text": "Wait to act."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "EnemyMelee",
									"sid": 350479885044515,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"WaitToAct\""
									}
								}
							],
							"actions": [
								{
									"customAction": "Act",
									"objectClass": "EnemyMelee",
									"sid": 767600667985986
								}
							],
							"sid": 651911969437267
						},
						{
							"eventType": "comment",
							"text": "Take a hit."
						},
						{
							"aceType": "action",
							"aceName": "Take hit",
							"objectClass": "EnemyMelee",
							"functionDescription": "Take a hit",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "damage",
									"type": "number",
									"initialValue": "0",
									"comment": "How much hp to subtract",
									"sid": 128305380243764
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 641071900918771,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"hit\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 885349290046893,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"dead\""
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyMelee",
									"sid": 360737001565756,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Play sound."
								},
								{
									"callFunction": "playSFX",
									"sid": 768780115452168,
									"parameters": [
										"\"hit\"",
										"\"EMHit\"",
										"-11",
										"random(1.5, 1.8)"
									]
								},
								{
									"type": "comment",
									"text": "Subtract from hp."
								},
								{
									"id": "subtract-from-instvar",
									"objectClass": "EnemyMelee",
									"sid": 235637742648372,
									"parameters": {
										"instance-variable": "hp",
										"value": "damage"
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"customAction": "Set state",
									"objectClass": "EnemyMelee",
									"sid": 309259451434553,
									"parameters": [
										"\"hit\""
									]
								},
								{
									"type": "comment",
									"text": "Flash the enemy."
								},
								{
									"id": "tween-value",
									"objectClass": "EnemyMelee",
									"sid": 777502426237528,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"EnemyFlash\"",
										"start-value": "100",
										"end-value": "150",
										"time": "0.075",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "yes",
										"repeat-count": "1"
									}
								}
							],
							"sid": 467279361575968,
							"children": [
								{
									"eventType": "comment",
									"text": "Enemy died."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "EnemyMelee",
											"sid": 569376325622853,
											"parameters": {
												"instance-variable": "hp",
												"comparison": 3,
												"value": "0"
											}
										}
									],
									"actions": [
										{
											"type": "comment",
											"text": "Play sound."
										},
										{
											"callFunction": "playSFX",
											"sid": 795998489883317,
											"parameters": [
												"\"melee_death\"",
												"\"EMDeath\"",
												"-8",
												"random(0.9, 1.2)"
											]
										},
										{
											"type": "comment",
											"text": "Set state."
										},
										{
											"customAction": "Set state",
											"objectClass": "EnemyMelee",
											"sid": 722376781008869,
											"parameters": [
												"\"dead\""
											]
										},
										{
											"type": "comment",
											"text": "Stop timers and movement."
										},
										{
											"id": "stop-all-timers",
											"objectClass": "EnemyMelee",
											"sid": 190901419365945,
											"behaviorType": "Timer"
										},
										{
											"id": "stop",
											"objectClass": "EnemyMelee",
											"sid": 810849341949995,
											"behaviorType": "Pathfinding"
										},
										{
											"type": "comment",
											"text": "Stop billboard animation."
										},
										{
											"id": "stop-all-tweens",
											"objectClass": "EnemyMeleeBillboard",
											"sid": 566795316760488,
											"behaviorType": "Tween"
										},
										{
											"id": "set-z-elevation",
											"objectClass": "EnemyMeleeBillboard",
											"sid": 901339430438571,
											"parameters": {
												"z": "EnemyMelee.ZElevation"
											}
										},
										{
											"type": "comment",
											"text": "Play death animation."
										},
										{
											"id": "set-animation",
											"objectClass": "EnemyMeleeTextures",
											"sid": 800633987471202,
											"parameters": {
												"animation": "\"DeathMelee\"",
												"from": "beginning"
											}
										}
									],
									"sid": 763550962766080,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-instance-variable",
													"objectClass": "EnemyMelee",
													"sid": 190196006373445,
													"parameters": {
														"instance-variable": "drop",
														"comparison": 1,
														"value": "\"\""
													}
												}
											],
											"actions": [
												{
													"callFunction": "createItem",
													"sid": 666880854812686,
													"parameters": [
														"EnemyMelee.X",
														"EnemyMelee.Y",
														"EnemyMelee.ZElevation",
														"EnemyMelee.drop",
														"1"
													]
												}
											],
											"sid": 963442298822352
										}
									]
								},
								{
									"eventType": "comment",
									"text": "If the enemy survived, knock them back."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 215617123742111
										}
									],
									"actions": [],
									"sid": 326206432163546,
									"children": [
										{
											"eventType": "variable",
											"name": "knockX",
											"type": "number",
											"initialValue": "0",
											"comment": "Knockback X coordinate.",
											"isStatic": false,
											"isConstant": false,
											"sid": 542487098205829
										},
										{
											"eventType": "variable",
											"name": "knockY",
											"type": "number",
											"initialValue": "0",
											"comment": "Knockback Y coordinate.",
											"isStatic": false,
											"isConstant": false,
											"sid": 837567777157194
										},
										{
											"eventType": "block",
											"conditions": [],
											"actions": [
												{
													"type": "comment",
													"text": "Calculate enemy coordinates after knockback."
												},
												{
													"id": "set-eventvar-value",
													"objectClass": "System",
													"sid": 391924102631726,
													"parameters": {
														"variable": "knockX",
														"value": "EnemyMelee.X - cos(angle(EnemyMelee.X, EnemyMelee.Y, Player.X, Player.Y)) * Player.knockback"
													}
												},
												{
													"id": "set-eventvar-value",
													"objectClass": "System",
													"sid": 738193096548291,
													"parameters": {
														"variable": "knockY",
														"value": "EnemyMelee.Y - sin(angle(EnemyMelee.X, EnemyMelee.Y, Player.X, Player.Y)) * Player.knockback"
													}
												}
											],
											"sid": 167647284196235,
											"children": [
												{
													"eventType": "comment",
													"text": "If the new coordinates do not fall onto an invalid position, move the enemy there."
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "pick-overlapping-point",
															"objectClass": "System",
															"sid": 270709730019564,
															"parameters": {
																"object": "EnemyNoGoZone",
																"x": "knockX",
																"y": "knockY"
															}
														}
													],
													"actions": [],
													"sid": 536523028872793
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "else",
															"objectClass": "System",
															"sid": 253732633470825
														}
													],
													"actions": [
														{
															"id": "tween-two-properties",
															"objectClass": "EnemyMelee",
															"sid": 299464818835215,
															"behaviorType": "Tween",
															"parameters": {
																"tags": "\"knockEnemy\"",
																"property": "position",
																"end-x": "knockX",
																"end-y": "knockY",
																"time": "0.1",
																"ease": "easeoutsine",
																"destroy-on-complete": "no",
																"loop": "no",
																"ping-pong": "no",
																"repeat-count": "1"
															}
														}
													],
													"sid": 110805483323949
												}
											]
										}
									]
								}
							]
						},
						{
							"eventType": "comment",
							"text": "After the death animation, remove the enemy billboard from the level."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-animation-finished",
									"objectClass": "EnemyMeleeTextures",
									"sid": 909807455582063,
									"parameters": {
										"animation": "\"DeathMelee\""
									}
								}
							],
							"actions": [
								{
									"id": "flash",
									"objectClass": "EnemyMeleeBillboard",
									"sid": 951259770406094,
									"behaviorType": "Flash",
									"parameters": {
										"on-time": "0.1",
										"off-time": "0.1",
										"duration": "0.6"
									}
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 774057516257499,
									"parameters": {
										"seconds": "0.6",
										"use-timescale": true
									}
								},
								{
									"id": "destroy",
									"objectClass": "EnemyMelee",
									"sid": 378673659783989
								}
							],
							"sid": 486352573990576
						},
						{
							"eventType": "comment",
							"text": "Flash the enemy's billboard."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-playing",
									"objectClass": "EnemyMelee",
									"sid": 315171899932687,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"EnemyFlash\""
									}
								}
							],
							"actions": [
								{
									"id": "set-effect-parameter",
									"objectClass": "EnemyMeleeBillboard",
									"sid": 525077542910501,
									"parameters": {
										"effect": "\"AdjustHSL\"",
										"parameter-index": "2",
										"value": "EnemyMelee.Tween.Value(\"EnemyFlash\")"
									}
								}
							],
							"sid": 443319413614718
						},
						{
							"eventType": "comment",
							"text": "Enemy took a full hit and has now recovered."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-tweens-finished",
									"objectClass": "EnemyMelee",
									"sid": 806452496200993,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"EnemyFlash\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 736003181736273,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"dead\""
									}
								}
							],
							"actions": [],
							"sid": 482629442449247,
							"children": [
								{
									"eventType": "comment",
									"text": "Recovery time changes depending on player berserk status."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-timer-running",
											"objectClass": "Player",
											"sid": 421709763652596,
											"behaviorType": "Timer",
											"parameters": {
												"tag": "\"playerBerserk\""
											}
										}
									],
									"actions": [
										{
											"customAction": "Wait",
											"objectClass": "EnemyMelee",
											"sid": 952368197312879,
											"parameters": [
												"Player.berserkMeleeCooldown - 0.1",
												"\"recover\""
											]
										}
									],
									"sid": 435077915884115
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 291640193204922
										}
									],
									"actions": [
										{
											"customAction": "Wait",
											"objectClass": "EnemyMelee",
											"sid": 799605688097652,
											"parameters": [
												"Player.defaultMeleeCooldown - 0.1",
												"\"recover\""
											]
										}
									],
									"sid": 682688061041817
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Enemy recovered from hit."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "EnemyMelee",
									"sid": 164055727663712,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"WaitToRecover\""
									}
								}
							],
							"actions": [
								{
									"customAction": "Set state",
									"objectClass": "EnemyMelee",
									"sid": 329687027889073,
									"parameters": [
										"\"recovered\""
									]
								},
								{
									"customAction": "Act",
									"objectClass": "EnemyMelee",
									"sid": 353330771332900
								}
							],
							"sid": 796312216835419
						},
						{
							"eventType": "comment",
							"text": "Enemy has become impatient. Act now!"
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "EnemyMelee",
									"sid": 950467551569428,
									"behaviorType": "Impatience",
									"parameters": {
										"tag": "\"EnemyImpatience\""
									}
								}
							],
							"actions": [
								{
									"customAction": "Override act",
									"objectClass": "EnemyMelee",
									"sid": 890203396590660
								}
							],
							"sid": 890920603376496
						}
					],
					"sid": 711931214651824
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "Enemy Melee Attack",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Check if any enemy is close enough to attack the player."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 678926532902192,
									"parameters": {
										"object": "EnemyMelee"
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 464130407469392,
									"parameters": {
										"instance-variable": "state",
										"comparison": 0,
										"value": "\"follow\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 848243499433162,
									"parameters": {
										"instance-variable": "onGeometryID",
										"comparison": 0,
										"value": "Player.onGeometryID"
									}
								},
								{
									"id": "is-overlapping-another-object",
									"objectClass": "EnemyMeleeAoE",
									"sid": 163624839248491,
									"parameters": {
										"object": "Player"
									}
								}
							],
							"actions": [
								{
									"customAction": "Override act",
									"objectClass": "EnemyMelee",
									"sid": 303137343713259
								}
							],
							"sid": 846826459384791
						},
						{
							"eventType": "comment",
							"text": "Wait to attack."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "EnemyMelee",
									"sid": 602156418169919,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"WaitToAttack\""
									}
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "EnemyMeleeTextures",
									"sid": 249658656907795,
									"parameters": {
										"animation": "\"AttackMelee\" & EnemyMelee.currentAngle",
										"from": "beginning"
									}
								},
								{
									"type": "comment",
									"text": "Play sound effect."
								},
								{
									"callFunction": "playSFX",
									"sid": 655076876493486,
									"parameters": [
										"\"woosh\" & choose(0, 1, 2)",
										"\"EMAttack\"",
										"-11",
										"random(1.6, 1.8)"
									]
								}
							],
							"sid": 895695645558616
						},
						{
							"eventType": "comment",
							"text": "After the attack animation finishes, wait a little and perform another action."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-any-animation-finished",
									"objectClass": "EnemyMeleeTextures",
									"sid": 573155136294178
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 324167246949616,
									"parameters": {
										"value": "left(EnemyMeleeTextures.AnimationName, 11) = \"AttackMelee\""
									}
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "EnemyMeleeTextures",
									"sid": 674540259909979,
									"parameters": {
										"animation": "\"IdleMelee\" & EnemyMelee.currentAngle",
										"from": "current-frame"
									}
								},
								{
									"customAction": "Rotate",
									"objectClass": "EnemyMelee",
									"sid": 134418941262881,
									"parameters": [
										"angle(Self.X, Self.Y, Player.X, Player.Y)"
									]
								},
								{
									"customAction": "Wait",
									"objectClass": "EnemyMelee",
									"sid": 606756089774874,
									"parameters": [
										"0.5",
										"\"act\""
									]
								}
							],
							"sid": 247632210908166
						},
						{
							"eventType": "comment",
							"text": "Hit player if they are within attack boundaries, while the attack animation plays."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-animation-frame-changed",
									"objectClass": "EnemyMeleeTextures",
									"sid": 463011868209352
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 350812516976286,
									"parameters": {
										"value": "left(EnemyMeleeTextures.AnimationName, 11) = \"AttackMelee\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 650792896795838,
									"parameters": {
										"instance-variable": "onGeometryID",
										"comparison": 0,
										"value": "Player.onGeometryID"
									}
								},
								{
									"id": "is-overlapping-another-object",
									"objectClass": "EnemyMeleeAoE",
									"sid": 772972113006967,
									"parameters": {
										"object": "Player"
									}
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 125611220415083,
									"parameters": {
										"value": "EnemyMeleeAoE.ZElevation >= Player.ZElevation - EnemyMeleeBillboard.ZHeight"
									}
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 385038340391196,
									"parameters": {
										"value": "EnemyMeleeAoE.ZElevation < Player.ZElevation + PlayerBillboard.ZHeight"
									}
								}
							],
							"actions": [
								{
									"customAction": "Hit",
									"objectClass": "Player",
									"sid": 701705792337330,
									"parameters": [
										"EnemyMelee.damage"
									]
								}
							],
							"sid": 281744581024934
						}
					],
					"sid": 473169455322743
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "Enemy Melee Movements",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Repeat billboard animation."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-tweens-finished",
									"objectClass": "EnemyMeleeBillboard",
									"sid": 467512491637500,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"BillboardZElevation\""
									}
								}
							],
							"actions": [
								{
									"id": "tween-one-property",
									"objectClass": "EnemyMeleeBillboard",
									"sid": 113964462198381,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"BillboardZElevation\"",
										"property": "offsetZElevation",
										"end-value": "Self.ZElevation + 4",
										"time": "0.33",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "yes",
										"repeat-count": "1"
									}
								}
							],
							"sid": 606700243319042
						},
						{
							"eventType": "comment",
							"text": "When a path is found, move along it."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-path-found",
									"objectClass": "EnemyMelee",
									"sid": 387262764285427,
									"behaviorType": "Pathfinding"
								}
							],
							"actions": [
								{
									"id": "move-along-path",
									"objectClass": "EnemyMelee",
									"sid": 522351858525947,
									"behaviorType": "Pathfinding"
								}
							],
							"sid": 930679333578065
						},
						{
							"eventType": "comment",
							"text": "If a path is not found, do a mini patrol and try a new action."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-failed-to-find-path",
									"objectClass": "EnemyMelee",
									"sid": 770867988590990,
									"behaviorType": "Pathfinding"
								}
							],
							"actions": [
								{
									"customAction": "Mini patrol",
									"objectClass": "EnemyMelee",
									"sid": 400684328484373
								}
							],
							"sid": 788905785481294
						},
						{
							"eventType": "comment",
							"text": "Enemies set to follow the player constantly update their path."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "EnemyMelee",
									"sid": 834638246980338,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"RefreshFollowPath\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyMelee",
									"sid": 374721778450647,
									"parameters": {
										"instance-variable": "state",
										"comparison": 0,
										"value": "\"follow\""
									}
								},
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 377977075598429,
									"parameters": {
										"object": "Geometry",
										"expression": "Geometry.geometryID = EnemyMelee.onGeometryID"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 621140893322186,
									"parameters": {
										"object": "Geometry",
										"which": "highest",
										"expression": "Geometry.Height * Geometry.Width"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 741113628957805,
									"parameters": {
										"object": "Geometry",
										"which": "lowest",
										"expression": "distance(Geometry.X, Geometry.Y, Player.X, Player.Y)"
									}
								}
							],
							"actions": [
								{
									"id": "find-path",
									"objectClass": "EnemyMelee",
									"sid": 703504772486865,
									"behaviorType": "Pathfinding",
									"parameters": {
										"x": "clamp(\n    Player.X,\n    Geometry.X - Geometry.Width/2 + EnemyMelee.Width/2,\n    Geometry.X + Geometry.Width/2 - EnemyMelee.Width/2\n)",
										"y": "clamp(\n    Player.Y,\r\n    Geometry.Y - Geometry.Height/2 + EnemyMelee.Height/2,\r\n    Geometry.Y + Geometry.Height/2 - EnemyMelee.Height/2\r\n)"
									}
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyMelee",
									"sid": 765678274420962,
									"behaviorType": "Timer",
									"parameters": {
										"duration": "0.1",
										"type": "once",
										"tag": "\"RefreshFollowPath\""
									}
								}
							],
							"sid": 699276681886774
						},
						{
							"eventType": "comment",
							"text": "Enemy arrived at destination."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-arrived",
									"objectClass": "EnemyMelee",
									"sid": 412931635044951,
									"behaviorType": "Pathfinding"
								}
							],
							"actions": [],
							"sid": 275701188782469,
							"children": [
								{
									"eventType": "comment",
									"text": "If the enemy is just patrolling, wait a little."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "EnemyMelee",
											"sid": 202400005532697,
											"parameters": {
												"instance-variable": "state",
												"comparison": 0,
												"value": "\"patrol\""
											}
										}
									],
									"actions": [
										{
											"customAction": "Wait",
											"objectClass": "EnemyMelee",
											"sid": 124593794008465,
											"parameters": [
												"0.5",
												"\"act\""
											]
										}
									],
									"sid": 133897517304498
								},
								{
									"eventType": "comment",
									"text": "Otherwise, if the enemy is following the player, act again immediately."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 579822343221207
										}
									],
									"actions": [
										{
											"customAction": "Act",
											"objectClass": "EnemyMelee",
											"sid": 881330609547757
										}
									],
									"sid": 563154623895555
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Set enemy moving animation."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 876264927163069,
									"parameters": {
										"object": "EnemyMelee"
									}
								},
								{
									"id": "is-moving-along-path",
									"objectClass": "EnemyMelee",
									"sid": 450020667838869,
									"behaviorType": "Pathfinding"
								}
							],
							"actions": [],
							"sid": 438186099256279,
							"children": [
								{
									"eventType": "comment",
									"text": "Patrol and follow states are the only valid ones to update this animation."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "EnemyMelee",
											"sid": 893010502488331,
											"parameters": {
												"instance-variable": "state",
												"comparison": 0,
												"value": "\"patrol\""
											}
										},
										{
											"id": "compare-instance-variable",
											"objectClass": "EnemyMelee",
											"sid": 847431370318792,
											"parameters": {
												"instance-variable": "state",
												"comparison": 0,
												"value": "\"follow\""
											}
										}
									],
									"actions": [
										{
											"customAction": "Rotate",
											"objectClass": "EnemyMelee",
											"sid": 813859122588274,
											"parameters": [
												"EnemyMelee.Pathfinding.MovingAngle"
											]
										},
										{
											"id": "set-animation",
											"objectClass": "EnemyMeleeTextures",
											"sid": 189755680852752,
											"parameters": {
												"animation": "\"IdleMelee\" & EnemyMelee.currentAngle",
												"from": "current-frame"
											}
										}
									],
									"sid": 931502859470093,
									"isOrBlock": true
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Stop to avoid too much overlapping."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 354501147331717,
									"parameters": {
										"object": "EnemyMeleeFreeCheck"
									}
								},
								{
									"id": "is-overlapping-another-object",
									"objectClass": "EnemyMeleeFreeCheck",
									"sid": 491853542514155,
									"parameters": {
										"object": "Enemies"
									}
								}
							],
							"actions": [],
							"sid": 901255895854069,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-parent",
											"objectClass": "EnemyMeleeFreeCheck",
											"sid": 682701005031944,
											"parameters": {
												"parent": "EnemyMelee",
												"which": "own"
											}
										}
									],
									"actions": [
										{
											"id": "set-speed",
											"objectClass": "EnemyMelee",
											"sid": 382089120848510,
											"behaviorType": "Pathfinding",
											"parameters": {
												"speed": "0"
											}
										}
									],
									"sid": 636752196741028
								}
							]
						}
					],
					"sid": 899993982403795
				}
			],
			"sid": 435964258049365
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Enemy Ranged",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "group",
					"disabled": false,
					"title": "Enemy Ranged Setup",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Setup enemy."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-created",
									"objectClass": "EnemyRanged",
									"sid": 414106965297413
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Add obstacles."
								},
								{
									"id": "add-obstacle",
									"objectClass": "EnemyRanged",
									"sid": 736922677178336,
									"behaviorType": "Pathfinding",
									"parameters": {
										"obstacle": "EnemyNoGoZone"
									}
								},
								{
									"type": "comment",
									"text": "Move parts to the correct positions."
								},
								{
									"id": "set-z-elevation",
									"objectClass": "EnemyRangedBillboard",
									"sid": 645227112223740,
									"parameters": {
										"z": "EnemyRanged.ZElevation"
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "EnemyRangedAoE",
									"sid": 702009916948514,
									"parameters": {
										"z": "EnemyRanged.ZElevation + 1"
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "EnemyRangedFreeCheck",
									"sid": 801565546335794,
									"parameters": {
										"z": "EnemyRanged.ZElevation"
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "EnemyRangedShadow",
									"sid": 579736915231321,
									"parameters": {
										"z": "EnemyRanged.ZElevation + 1"
									}
								},
								{
									"id": "set-position",
									"objectClass": "EnemyRangedTextures",
									"sid": 556090489328428,
									"parameters": {
										"x": "-10000",
										"y": "-10000"
									}
								},
								{
									"type": "comment",
									"text": "Create hierarchy."
								},
								{
									"id": "add-child",
									"objectClass": "EnemyRanged",
									"sid": 343218612268572,
									"parameters": {
										"child": "EnemyRangedBillboard",
										"transform-x": true,
										"transform-y": true,
										"transform-w": false,
										"transform-h": false,
										"transform-a": false,
										"transform-o": false,
										"transform-z-elevation": true,
										"transform-visibility": false,
										"destroy-with-parent": true
									}
								},
								{
									"id": "add-child",
									"objectClass": "EnemyRanged",
									"sid": 855937644634580,
									"parameters": {
										"child": "EnemyRangedShadow",
										"transform-x": true,
										"transform-y": true,
										"transform-w": false,
										"transform-h": false,
										"transform-a": false,
										"transform-o": false,
										"transform-z-elevation": true,
										"transform-visibility": false,
										"destroy-with-parent": true
									}
								},
								{
									"id": "add-child",
									"objectClass": "EnemyRanged",
									"sid": 926048727575041,
									"parameters": {
										"child": "EnemyRangedAoE",
										"transform-x": true,
										"transform-y": true,
										"transform-w": false,
										"transform-h": false,
										"transform-a": false,
										"transform-o": false,
										"transform-z-elevation": true,
										"transform-visibility": false,
										"destroy-with-parent": true
									}
								},
								{
									"id": "add-child",
									"objectClass": "EnemyRanged",
									"sid": 975851597114980,
									"parameters": {
										"child": "EnemyRangedFreeCheck",
										"transform-x": true,
										"transform-y": true,
										"transform-w": false,
										"transform-h": false,
										"transform-a": false,
										"transform-o": false,
										"transform-z-elevation": true,
										"transform-visibility": false,
										"destroy-with-parent": true
									}
								},
								{
									"type": "comment",
									"text": "Process first world state."
								},
								{
									"customAction": "Act",
									"objectClass": "EnemyRanged",
									"sid": 936666041397362
								}
							],
							"sid": 584744172718395
						}
					],
					"sid": 192376885862295
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "Enemy Ranged Actions",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Set current enemy state."
						},
						{
							"aceType": "action",
							"aceName": "Set state",
							"objectClass": "EnemyRanged",
							"functionDescription": "Set current enemy state",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "state",
									"type": "string",
									"initialValue": "",
									"comment": "State to set",
									"sid": 503378596144501
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "EnemyRanged",
									"sid": 156063160333324,
									"parameters": {
										"instance-variable": "state",
										"value": "state"
									}
								}
							],
							"sid": 531843271953393
						},
						{
							"eventType": "comment",
							"text": "Override current action immediately."
						},
						{
							"aceType": "action",
							"aceName": "Override act",
							"objectClass": "EnemyRanged",
							"functionDescription": "Override current action immediately",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyRanged",
									"sid": 768633721784300,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"dead\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyRanged",
									"sid": 678955160495587,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"hit\""
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyRanged",
									"sid": 744125071887525,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Stop everything."
								},
								{
									"id": "stop-all-timers",
									"objectClass": "EnemyRanged",
									"sid": 569559304925218,
									"behaviorType": "Timer"
								},
								{
									"id": "stop",
									"objectClass": "EnemyRanged",
									"sid": 649286531183353,
									"behaviorType": "Pathfinding"
								},
								{
									"type": "comment",
									"text": "Perform a new action."
								},
								{
									"customAction": "Act",
									"objectClass": "EnemyRanged",
									"sid": 299363487290120
								}
							],
							"sid": 903811670492075
						},
						{
							"eventType": "comment",
							"text": "Process the world state and act based on it."
						},
						{
							"aceType": "action",
							"aceName": "Act",
							"objectClass": "EnemyRanged",
							"functionDescription": "Process the world state and act based on it",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyRanged",
									"sid": 516544333826282,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"dead\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyRanged",
									"sid": 472339320588012,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"hit\""
									}
								}
							],
							"actions": [],
							"sid": 234885919792052,
							"children": [
								{
									"eventType": "comment",
									"text": "The player is on the same geometry block as the enemy."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "EnemyRanged",
											"sid": 123076132092741,
											"parameters": {
												"instance-variable": "onGeometryID",
												"comparison": 0,
												"value": "Player.onGeometryID"
											}
										},
										{
											"id": "is-boolean-instance-variable-set",
											"objectClass": "Player",
											"sid": 233597819081248,
											"parameters": {
												"instance-variable": "cloaked"
											},
											"isInverted": true
										}
									],
									"actions": [],
									"sid": 442199579520753,
									"children": [
										{
											"eventType": "comment",
											"text": "If close enough to the player, perform an attack."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "is-overlapping-another-object",
													"objectClass": "EnemyRangedAoE",
													"sid": 547325768392455,
													"parameters": {
														"object": "Player"
													}
												}
											],
											"actions": [
												{
													"customAction": "Attack",
													"objectClass": "EnemyRanged",
													"sid": 140282913923185
												}
											],
											"sid": 138689170411111
										},
										{
											"eventType": "comment",
											"text": "Otherwise follow the player."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "else",
													"objectClass": "System",
													"sid": 620711260079640
												}
											],
											"actions": [
												{
													"customAction": "Follow",
													"objectClass": "EnemyRanged",
													"sid": 154234228349305
												}
											],
											"sid": 145771653464739
										}
									]
								},
								{
									"eventType": "comment",
									"text": "The player is not on the same geometry block as the enemy."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 433172948325799
										}
									],
									"actions": [
										{
											"customAction": "Patrol",
											"objectClass": "EnemyRanged",
											"sid": 192962528379567
										}
									],
									"sid": 160804374265941
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Patrol the area."
						},
						{
							"aceType": "action",
							"aceName": "Patrol",
							"objectClass": "EnemyRanged",
							"functionDescription": "Patrol the area",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 840350960386712,
									"parameters": {
										"object": "Geometry",
										"expression": "Geometry.geometryID = EnemyRanged.onGeometryID"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 164421202592987,
									"parameters": {
										"object": "Geometry",
										"which": "highest",
										"expression": "Geometry.Height * Geometry.Width"
									}
								},
								{
									"id": "pick-random-instance",
									"objectClass": "System",
									"sid": 904233247446700,
									"parameters": {
										"object": "Geometry"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyRanged",
									"sid": 164248717287900,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"customAction": "Set state",
									"objectClass": "EnemyRanged",
									"sid": 229780616404278,
									"parameters": [
										"\"patrol\""
									]
								},
								{
									"type": "comment",
									"text": "Search path."
								},
								{
									"id": "find-path",
									"objectClass": "EnemyRanged",
									"sid": 486076885618672,
									"behaviorType": "Pathfinding",
									"parameters": {
										"x": "random(\n    Geometry.X - Geometry.Width/2 + EnemyRanged.Width/2,\n    Geometry.X + Geometry.Width/2 - EnemyRanged.Width/2\n)",
										"y": "random(\r\n    Geometry.Y - Geometry.Height/2 + EnemyRanged.Height/2,\r\n    Geometry.Y + Geometry.Height/2 - EnemyRanged.Height/2\r\n)"
									}
								}
							],
							"sid": 859983717597030
						},
						{
							"eventType": "comment",
							"text": "Patrol an area nearby."
						},
						{
							"aceType": "action",
							"aceName": "Mini patrol",
							"objectClass": "EnemyRanged",
							"functionDescription": "Patrol an area nearby",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 191326130725812,
									"parameters": {
										"object": "Geometry",
										"expression": "Geometry.geometryID = EnemyRanged.onGeometryID"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 839568114904438,
									"parameters": {
										"object": "Geometry",
										"which": "highest",
										"expression": "Geometry.Height * Geometry.Width"
									}
								},
								{
									"id": "pick-random-instance",
									"objectClass": "System",
									"sid": 659420315834141,
									"parameters": {
										"object": "Geometry"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyRanged",
									"sid": 676591816981799,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"customAction": "Set state",
									"objectClass": "EnemyRanged",
									"sid": 665121370048951,
									"parameters": [
										"\"patrol\""
									]
								},
								{
									"type": "comment",
									"text": "Search path."
								},
								{
									"id": "find-path",
									"objectClass": "EnemyRanged",
									"sid": 590906751476115,
									"behaviorType": "Pathfinding",
									"parameters": {
										"x": "clamp(\n    random(Self.X - 32, Self.X + 32),\n    Geometry.X - Geometry.Width/2 + EnemyRanged.Width/2,\n    Geometry.X + Geometry.Width/2 - EnemyRanged.Width/2\n)",
										"y": "clamp(\n    random(Self.Y - 32, Self.Y + 32),\r\n    Geometry.Y - Geometry.Height/2 + EnemyRanged.Height/2,\r\n    Geometry.Y + Geometry.Height/2 - EnemyRanged.Height/2\r\n)"
									}
								}
							],
							"sid": 324224073304441
						},
						{
							"eventType": "comment",
							"text": "Follow the player."
						},
						{
							"aceType": "action",
							"aceName": "Follow",
							"objectClass": "EnemyRanged",
							"functionDescription": "Follow the player",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 166492215953005,
									"parameters": {
										"object": "Geometry",
										"expression": "Geometry.geometryID = EnemyRanged.onGeometryID"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 312687322066187,
									"parameters": {
										"object": "Geometry",
										"which": "lowest",
										"expression": "distance(Geometry.X, Geometry.Y, Player.X, Player.Y)"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyRanged",
									"sid": 906708325198435,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"customAction": "Set state",
									"objectClass": "EnemyRanged",
									"sid": 638324803596472,
									"parameters": [
										"\"follow\""
									]
								},
								{
									"type": "comment",
									"text": "Search path."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyRanged",
									"sid": 875982791316779,
									"behaviorType": "Timer",
									"parameters": {
										"duration": "0.1",
										"type": "once",
										"tag": "\"RefreshFollowPath\""
									}
								}
							],
							"sid": 642504187735772
						},
						{
							"eventType": "comment",
							"text": "Make enemy wait before taking a new action."
						},
						{
							"aceType": "action",
							"aceName": "Wait",
							"objectClass": "EnemyRanged",
							"functionDescription": "Make enemy wait before taking a new action",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "timeToWait",
									"type": "number",
									"initialValue": "1",
									"comment": "How much time the enemy should wait",
									"sid": 366174172316984
								},
								{
									"name": "nextAction",
									"type": "string",
									"initialValue": "",
									"comment": "Next action to be performed",
									"sid": 322192037771489
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "EnemyRangedTextures",
									"sid": 684145322579008,
									"parameters": {
										"animation": "\"IdleRanged\" & EnemyRanged.currentAngle",
										"from": "current-frame"
									}
								}
							],
							"sid": 319698323434494,
							"children": [
								{
									"eventType": "comment",
									"text": "Act action."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-eventvar",
											"objectClass": "System",
											"sid": 247818447828660,
											"parameters": {
												"variable": "nextAction",
												"comparison": 0,
												"value": "\"act\""
											}
										}
									],
									"actions": [
										{
											"id": "start-timer",
											"objectClass": "EnemyRanged",
											"sid": 832376417342880,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "timeToWait",
												"type": "once",
												"tag": "\"WaitToAct\""
											}
										}
									],
									"sid": 962002831195978
								},
								{
									"eventType": "comment",
									"text": "Attack action."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 920616110468288
										},
										{
											"id": "compare-eventvar",
											"objectClass": "System",
											"sid": 720071150787056,
											"parameters": {
												"variable": "nextAction",
												"comparison": 0,
												"value": "\"attack\""
											}
										}
									],
									"actions": [
										{
											"id": "start-timer",
											"objectClass": "EnemyRanged",
											"sid": 909207648074212,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "timeToWait",
												"type": "once",
												"tag": "\"WaitToAttack\""
											}
										}
									],
									"sid": 410470019330799
								},
								{
									"eventType": "comment",
									"text": "Recover action."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 489333057682149
										},
										{
											"id": "compare-eventvar",
											"objectClass": "System",
											"sid": 487839854098217,
											"parameters": {
												"variable": "nextAction",
												"comparison": 0,
												"value": "\"recover\""
											}
										}
									],
									"actions": [
										{
											"id": "start-timer",
											"objectClass": "EnemyRanged",
											"sid": 684953633284643,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "timeToWait",
												"type": "once",
												"tag": "\"WaitToRecover\""
											}
										}
									],
									"sid": 364460676126658
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Attack the player."
						},
						{
							"aceType": "action",
							"aceName": "Attack",
							"objectClass": "EnemyRanged",
							"functionDescription": "Attack the player",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyRanged",
									"sid": 413944998355069,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"customAction": "Set state",
									"objectClass": "EnemyRanged",
									"sid": 902034031886782,
									"parameters": [
										"\"attack\""
									]
								},
								{
									"type": "comment",
									"text": "Wait a little before attacking."
								},
								{
									"customAction": "Wait",
									"objectClass": "EnemyRanged",
									"sid": 302133670223247,
									"parameters": [
										"0.5",
										"\"attack\""
									]
								}
							],
							"sid": 686519138034752
						},
						{
							"eventType": "comment",
							"text": "Rotate the enemy."
						},
						{
							"aceType": "action",
							"aceName": "Rotate",
							"objectClass": "EnemyRanged",
							"functionDescription": "Rotate the enemy",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "newAngle",
									"type": "number",
									"initialValue": "0",
									"comment": "Angle to set",
									"sid": 339698033973015
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "EnemyRanged",
									"sid": 728674042115269,
									"parameters": {
										"instance-variable": "currentAngle",
										"value": "Functions.ConvertAngle(Functions.RoundNumber(newAngle, 45))"
									}
								},
								{
									"id": "set-angle",
									"objectClass": "EnemyRangedAoE",
									"sid": 342449413528602,
									"parameters": {
										"angle": "EnemyRanged.currentAngle"
									}
								},
								{
									"id": "set-angle",
									"objectClass": "EnemyRangedFreeCheck",
									"sid": 109835819096221,
									"parameters": {
										"angle": "EnemyRanged.currentAngle"
									}
								}
							],
							"sid": 267083730570128
						},
						{
							"eventType": "comment",
							"text": "Wait to act."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "EnemyRanged",
									"sid": 293763041833048,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"WaitToAct\""
									}
								}
							],
							"actions": [
								{
									"customAction": "Act",
									"objectClass": "EnemyRanged",
									"sid": 259892508527810
								}
							],
							"sid": 439269074723487
						},
						{
							"eventType": "comment",
							"text": "Take a hit."
						},
						{
							"aceType": "action",
							"aceName": "Take hit",
							"objectClass": "EnemyRanged",
							"functionDescription": "Take a hit",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "damage",
									"type": "number",
									"initialValue": "0",
									"comment": "How much hp to subtract",
									"sid": 704658078614421
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyRanged",
									"sid": 391359804585593,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"hit\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyRanged",
									"sid": 596328175999093,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"dead\""
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Reset impatience."
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyRanged",
									"sid": 961481439427248,
									"behaviorType": "Impatience",
									"parameters": {
										"duration": "3.0",
										"type": "once",
										"tag": "\"EnemyImpatience\""
									}
								},
								{
									"type": "comment",
									"text": "Play sound."
								},
								{
									"callFunction": "playSFX",
									"sid": 579833348518968,
									"parameters": [
										"\"hit\"",
										"\"ERHit\"",
										"-11",
										"random(1.5, 1.8)"
									]
								},
								{
									"id": "subtract-from-instvar",
									"objectClass": "EnemyRanged",
									"sid": 310403012583854,
									"parameters": {
										"instance-variable": "hp",
										"value": "damage"
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"customAction": "Set state",
									"objectClass": "EnemyRanged",
									"sid": 754336298556532,
									"parameters": [
										"\"hit\""
									]
								},
								{
									"type": "comment",
									"text": "Flash the enemy."
								},
								{
									"id": "tween-value",
									"objectClass": "EnemyRanged",
									"sid": 341263132011165,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"EnemyFlash\"",
										"start-value": "100",
										"end-value": "150",
										"time": "0.075",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "yes",
										"repeat-count": "1"
									}
								}
							],
							"sid": 147393705080701,
							"children": [
								{
									"eventType": "comment",
									"text": "Enemy died."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "EnemyRanged",
											"sid": 204603352229663,
											"parameters": {
												"instance-variable": "hp",
												"comparison": 3,
												"value": "0"
											}
										}
									],
									"actions": [
										{
											"type": "comment",
											"text": "Play sound."
										},
										{
											"callFunction": "playSFX",
											"sid": 409400203288358,
											"parameters": [
												"\"goblin_death\" & choose(0, 1, 2 ,3)",
												"\"ERDeath\"",
												"-14",
												"random(0.9, 1.2)"
											]
										},
										{
											"type": "comment",
											"text": "Set state."
										},
										{
											"customAction": "Set state",
											"objectClass": "EnemyRanged",
											"sid": 599665933039462,
											"parameters": [
												"\"dead\""
											]
										},
										{
											"type": "comment",
											"text": "Stop timers and movement."
										},
										{
											"id": "stop-all-timers",
											"objectClass": "EnemyRanged",
											"sid": 664911712783417,
											"behaviorType": "Timer"
										},
										{
											"id": "stop",
											"objectClass": "EnemyRanged",
											"sid": 266481822945564,
											"behaviorType": "Pathfinding"
										},
										{
											"type": "comment",
											"text": "Play death animation."
										},
										{
											"id": "set-animation",
											"objectClass": "EnemyRangedTextures",
											"sid": 426026930828627,
											"parameters": {
												"animation": "\"DeathRanged\"",
												"from": "beginning"
											}
										}
									],
									"sid": 984390303403254,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-instance-variable",
													"objectClass": "EnemyRanged",
													"sid": 584357640145960,
													"parameters": {
														"instance-variable": "drop",
														"comparison": 1,
														"value": "\"\""
													}
												}
											],
											"actions": [
												{
													"callFunction": "createItem",
													"sid": 883044656616784,
													"parameters": [
														"EnemyRanged.X",
														"EnemyRanged.Y",
														"EnemyRanged.ZElevation",
														"EnemyRanged.drop",
														"1"
													]
												}
											],
											"sid": 421721881645114
										}
									]
								},
								{
									"eventType": "comment",
									"text": "If the enemy survived, knock them back."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 380249057209629
										}
									],
									"actions": [],
									"sid": 769586478429799,
									"children": [
										{
											"eventType": "variable",
											"name": "knockX",
											"type": "number",
											"initialValue": "0",
											"comment": "Knockback X coordinate.",
											"isStatic": false,
											"isConstant": false,
											"sid": 332217191165484
										},
										{
											"eventType": "variable",
											"name": "knockY",
											"type": "number",
											"initialValue": "0",
											"comment": "Knockback Y coordinate.",
											"isStatic": false,
											"isConstant": false,
											"sid": 366871002543667
										},
										{
											"eventType": "block",
											"conditions": [],
											"actions": [
												{
													"type": "comment",
													"text": "Calculate enemy coordinates after knockback."
												},
												{
													"id": "set-eventvar-value",
													"objectClass": "System",
													"sid": 753737914001245,
													"parameters": {
														"variable": "knockX",
														"value": "EnemyRanged.X - cos(angle(EnemyRanged.X, EnemyRanged.Y, Player.X, Player.Y)) * Player.knockback"
													}
												},
												{
													"id": "set-eventvar-value",
													"objectClass": "System",
													"sid": 554497914923960,
													"parameters": {
														"variable": "knockY",
														"value": "EnemyRanged.Y - sin(angle(EnemyRanged.X, EnemyRanged.Y, Player.X, Player.Y)) * Player.knockback"
													}
												}
											],
											"sid": 694286304450523,
											"children": [
												{
													"eventType": "comment",
													"text": "If the new coordinates do not fall onto an invalid position, move the enemy there."
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "pick-overlapping-point",
															"objectClass": "System",
															"sid": 214371400964579,
															"parameters": {
																"object": "EnemyNoGoZone",
																"x": "knockX",
																"y": "knockY"
															}
														}
													],
													"actions": [],
													"sid": 551460727154052
												},
												{
													"eventType": "block",
													"conditions": [
														{
															"id": "else",
															"objectClass": "System",
															"sid": 764900451679549
														}
													],
													"actions": [
														{
															"id": "tween-two-properties",
															"objectClass": "EnemyRanged",
															"sid": 538405867853640,
															"behaviorType": "Tween",
															"parameters": {
																"tags": "\"knockEnemy\"",
																"property": "position",
																"end-x": "knockX",
																"end-y": "knockY",
																"time": "0.1",
																"ease": "easeoutsine",
																"destroy-on-complete": "no",
																"loop": "no",
																"ping-pong": "no",
																"repeat-count": "1"
															}
														}
													],
													"sid": 372943229070471
												}
											]
										}
									]
								}
							]
						},
						{
							"eventType": "comment",
							"text": "After the death animation, remove the enemy billboard from the level."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-animation-finished",
									"objectClass": "EnemyRangedTextures",
									"sid": 838351207449326,
									"parameters": {
										"animation": "\"DeathRanged\""
									}
								}
							],
							"actions": [
								{
									"id": "flash",
									"objectClass": "EnemyRangedBillboard",
									"sid": 320191059600608,
									"behaviorType": "Flash",
									"parameters": {
										"on-time": "0.1",
										"off-time": "0.1",
										"duration": "0.6"
									}
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 378039166207631,
									"parameters": {
										"seconds": "0.6",
										"use-timescale": true
									}
								},
								{
									"id": "destroy",
									"objectClass": "EnemyRanged",
									"sid": 990855174204231
								}
							],
							"sid": 266870423576463
						},
						{
							"eventType": "comment",
							"text": "Flash the enemy's billboard."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-playing",
									"objectClass": "EnemyRanged",
									"sid": 947496419702575,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"EnemyFlash\""
									}
								}
							],
							"actions": [
								{
									"id": "set-effect-parameter",
									"objectClass": "EnemyRangedBillboard",
									"sid": 995664287217388,
									"parameters": {
										"effect": "\"AdjustHSL\"",
										"parameter-index": "2",
										"value": "EnemyRanged.Tween.Value(\"EnemyFlash\")"
									}
								}
							],
							"sid": 593398790572963
						},
						{
							"eventType": "comment",
							"text": "Enemy took a full hit and has now recovered."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-tweens-finished",
									"objectClass": "EnemyRanged",
									"sid": 127797299095084,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"EnemyFlash\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyRanged",
									"sid": 738977329500296,
									"parameters": {
										"instance-variable": "state",
										"comparison": 1,
										"value": "\"dead\""
									}
								}
							],
							"actions": [],
							"sid": 640939558177881,
							"children": [
								{
									"eventType": "comment",
									"text": "Recovery time changes depending on player berserk status."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-timer-running",
											"objectClass": "Player",
											"sid": 603309101847023,
											"behaviorType": "Timer",
											"parameters": {
												"tag": "\"playerBerserk\""
											}
										}
									],
									"actions": [
										{
											"customAction": "Wait",
											"objectClass": "EnemyRanged",
											"sid": 869164796232994,
											"parameters": [
												"Player.berserkMeleeCooldown - 0.1",
												"\"recover\""
											]
										}
									],
									"sid": 849004204989239
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 427333420613583
										}
									],
									"actions": [
										{
											"customAction": "Wait",
											"objectClass": "EnemyRanged",
											"sid": 473985213805999,
											"parameters": [
												"Player.defaultMeleeCooldown - 0.1",
												"\"recover\""
											]
										}
									],
									"sid": 128284136805502
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Enemy recovered from hit."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "EnemyRanged",
									"sid": 505106012528114,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"WaitToRecover\""
									}
								}
							],
							"actions": [
								{
									"customAction": "Set state",
									"objectClass": "EnemyRanged",
									"sid": 608581667344793,
									"parameters": [
										"\"recovered\""
									]
								},
								{
									"customAction": "Act",
									"objectClass": "EnemyRanged",
									"sid": 519407151807034
								}
							],
							"sid": 680881883586033
						},
						{
							"eventType": "comment",
							"text": "Enemy has become impatient. Act now!"
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "EnemyRanged",
									"sid": 523010165173194,
									"behaviorType": "Impatience",
									"parameters": {
										"tag": "\"EnemyImpatience\""
									}
								}
							],
							"actions": [
								{
									"customAction": "Override act",
									"objectClass": "EnemyRanged",
									"sid": 114234377387830
								}
							],
							"sid": 250676193244448
						}
					],
					"sid": 380426264642208
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "Enemy Ranged Attack",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Check if any enemy is close enough to attack the player."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 833267604610060,
									"parameters": {
										"object": "EnemyRanged"
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyRanged",
									"sid": 186558437227759,
									"parameters": {
										"instance-variable": "state",
										"comparison": 0,
										"value": "\"follow\""
									}
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 355385405466351,
									"parameters": {
										"value": "abs(Player.ZElevation - EnemyRanged.ZElevation) < 16"
									}
								},
								{
									"id": "is-overlapping-another-object",
									"objectClass": "EnemyRangedAoE",
									"sid": 599700615966626,
									"parameters": {
										"object": "Player"
									}
								}
							],
							"actions": [
								{
									"customAction": "Override act",
									"objectClass": "EnemyRanged",
									"sid": 767809825678004
								}
							],
							"sid": 665336474720993
						},
						{
							"eventType": "comment",
							"text": "Wait to attack."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "EnemyRanged",
									"sid": 570854354024630,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"WaitToAttack\""
									}
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "EnemyRangedTextures",
									"sid": 866415735052056,
									"parameters": {
										"animation": "\"AttackRanged\" & EnemyRanged.currentAngle",
										"from": "beginning"
									}
								}
							],
							"sid": 771589572599295
						},
						{
							"eventType": "comment",
							"text": "After the attack animation finishes, create projectile and wait a little and perform another action."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-any-animation-finished",
									"objectClass": "EnemyRangedTextures",
									"sid": 658769926006842
								},
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 457620867130310,
									"parameters": {
										"value": "left(EnemyRangedTextures.AnimationName, 12) = \"AttackRanged\""
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Play sound."
								},
								{
									"callFunction": "playSFX",
									"sid": 451771335938284,
									"parameters": [
										"\"spell\"",
										"\"ERAttack\"",
										"-10",
										"random(0.9, 1.2)"
									]
								},
								{
									"type": "comment",
									"text": "Rotate and set animation."
								},
								{
									"customAction": "Rotate",
									"objectClass": "EnemyRanged",
									"sid": 785145724557913,
									"parameters": [
										"angle(Self.X, Self.Y, Player.X, Player.Y)"
									]
								},
								{
									"id": "set-animation",
									"objectClass": "EnemyRangedTextures",
									"sid": 648056863065099,
									"parameters": {
										"animation": "\"IdleRanged\" & EnemyRanged.currentAngle",
										"from": "current-frame"
									}
								},
								{
									"type": "comment",
									"text": "Create and setup projectile."
								},
								{
									"customAction": "Create projectile",
									"objectClass": "EnemyProjectile",
									"sid": 103561983900974,
									"parameters": [
										"\"EnemyRanged0\"",
										"EnemyRanged.X",
										"EnemyRanged.Y",
										"EnemyRanged.ZElevation + 8",
										"angle(EnemyRanged.X, EnemyRanged.Y, Player.X, Player.Y)"
									]
								},
								{
									"type": "comment",
									"text": "Perform another action."
								},
								{
									"customAction": "Wait",
									"objectClass": "EnemyRanged",
									"sid": 495201822496812,
									"parameters": [
										"0.5",
										"\"act\""
									]
								}
							],
							"sid": 419798295388784,
							"children": [
								{
									"eventType": "comment",
									"text": "Create cast effect."
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"callFunction": "createFX",
											"sid": 438963260656974,
											"parameters": [
												"\"Billboard\"",
												"\"EnemyRangedEffect\"",
												"EnemyRanged.X + cos(EnemyRanged.currentAngle) * 8",
												"EnemyRanged.Y + ((EnemyRanged.currentAngle > 180 & EnemyRanged.currentAngle < 360) ? -4 : 4)",
												"EnemyRanged.ZElevation + 10"
											]
										},
										{
											"id": "wait",
											"objectClass": "System",
											"sid": 391741411898862,
											"parameters": {
												"seconds": "0",
												"use-timescale": true
											}
										}
									],
									"sid": 249491691912809
								}
							]
						}
					],
					"sid": 615192045655684
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "Enemy Ranged Movements",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "When a path is found, move along it."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-path-found",
									"objectClass": "EnemyRanged",
									"sid": 194569475213926,
									"behaviorType": "Pathfinding"
								}
							],
							"actions": [
								{
									"id": "move-along-path",
									"objectClass": "EnemyRanged",
									"sid": 167946283208524,
									"behaviorType": "Pathfinding"
								}
							],
							"sid": 855037551819112
						},
						{
							"eventType": "comment",
							"text": "If a path is not found, do a mini patrol and try a new action."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-failed-to-find-path",
									"objectClass": "EnemyRanged",
									"sid": 427782644171643,
									"behaviorType": "Pathfinding"
								}
							],
							"actions": [
								{
									"customAction": "Mini patrol",
									"objectClass": "EnemyRanged",
									"sid": 205511882441573
								}
							],
							"sid": 343116499866472
						},
						{
							"eventType": "comment",
							"text": "Enemies set to follow the player constantly update their path."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "EnemyRanged",
									"sid": 921843717050898,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"RefreshFollowPath\""
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "EnemyRanged",
									"sid": 549020199076972,
									"parameters": {
										"instance-variable": "state",
										"comparison": 0,
										"value": "\"follow\""
									}
								},
								{
									"id": "pick-by-evaluate",
									"objectClass": "System",
									"sid": 281952810682281,
									"parameters": {
										"object": "Geometry",
										"expression": "Geometry.geometryID = EnemyRanged.onGeometryID"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 658981615620926,
									"parameters": {
										"object": "Geometry",
										"which": "highest",
										"expression": "Geometry.Height * Geometry.Width"
									}
								},
								{
									"id": "pick-random-instance",
									"objectClass": "System",
									"sid": 790142607712365,
									"parameters": {
										"object": "Geometry"
									}
								}
							],
							"actions": [
								{
									"id": "find-path",
									"objectClass": "EnemyRanged",
									"sid": 650213462858233,
									"behaviorType": "Pathfinding",
									"parameters": {
										"x": "clamp(\n    Player.X,\n    Geometry.X - Geometry.Width/2 + EnemyRanged.Width/2,\n    Geometry.X + Geometry.Width/2 - EnemyRanged.Width/2\n)",
										"y": "clamp(\n    Player.Y,\r\n    Geometry.Y - Geometry.Height/2 + EnemyRanged.Height/2,\r\n    Geometry.Y + Geometry.Height/2 - EnemyRanged.Height/2\r\n)"
									}
								},
								{
									"id": "start-timer",
									"objectClass": "EnemyRanged",
									"sid": 294252812559309,
									"behaviorType": "Timer",
									"parameters": {
										"duration": "0.1",
										"type": "once",
										"tag": "\"RefreshFollowPath\""
									}
								}
							],
							"sid": 537485049773381
						},
						{
							"eventType": "comment",
							"text": "Enemy arrived at destination."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-arrived",
									"objectClass": "EnemyRanged",
									"sid": 579222464251933,
									"behaviorType": "Pathfinding"
								}
							],
							"actions": [
								{
									"id": "set-animation",
									"objectClass": "EnemyRangedTextures",
									"sid": 113353679948388,
									"parameters": {
										"animation": "\"IdleRanged\" & EnemyRanged.currentAngle",
										"from": "current-frame"
									}
								}
							],
							"sid": 255421153704047,
							"children": [
								{
									"eventType": "comment",
									"text": "If the enemy is just patrolling, wait a little."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "EnemyRanged",
											"sid": 507626805570468,
											"parameters": {
												"instance-variable": "state",
												"comparison": 0,
												"value": "\"patrol\""
											}
										}
									],
									"actions": [
										{
											"customAction": "Wait",
											"objectClass": "EnemyRanged",
											"sid": 787830545597592,
											"parameters": [
												"0.5",
												"\"act\""
											]
										}
									],
									"sid": 175926894609804
								},
								{
									"eventType": "comment",
									"text": "Otherwise, if the enemy is following the player, act again immediately."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 732444358387485
										}
									],
									"actions": [
										{
											"customAction": "Act",
											"objectClass": "EnemyRanged",
											"sid": 995168170739408
										}
									],
									"sid": 911395468026356
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Set enemy moving animation."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 131937757779300,
									"parameters": {
										"object": "EnemyRanged"
									}
								},
								{
									"id": "is-moving-along-path",
									"objectClass": "EnemyRanged",
									"sid": 833588770966470,
									"behaviorType": "Pathfinding"
								}
							],
							"actions": [],
							"sid": 716740595515781,
							"children": [
								{
									"eventType": "comment",
									"text": "Patrol and follow states are the only valid ones to update this animation."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "EnemyRanged",
											"sid": 317197390592275,
											"parameters": {
												"instance-variable": "state",
												"comparison": 0,
												"value": "\"patrol\""
											}
										},
										{
											"id": "compare-instance-variable",
											"objectClass": "EnemyRanged",
											"sid": 156304087437217,
											"parameters": {
												"instance-variable": "state",
												"comparison": 0,
												"value": "\"follow\""
											}
										}
									],
									"actions": [
										{
											"customAction": "Rotate",
											"objectClass": "EnemyRanged",
											"sid": 983239380727364,
											"parameters": [
												"EnemyRanged.Pathfinding.MovingAngle"
											]
										}
									],
									"sid": 464866807054457,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-speed",
													"objectClass": "EnemyRanged",
													"sid": 303819435795414,
													"behaviorType": "Pathfinding",
													"parameters": {
														"comparison": 4,
														"speed": "0.1"
													}
												}
											],
											"actions": [
												{
													"id": "set-animation",
													"objectClass": "EnemyRangedTextures",
													"sid": 189438431714208,
													"parameters": {
														"animation": "\"MoveRanged\" & EnemyRanged.currentAngle",
														"from": "current-frame"
													}
												}
											],
											"sid": 642146946891222
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "else",
													"objectClass": "System",
													"sid": 764586536185129
												}
											],
											"actions": [
												{
													"id": "set-animation",
													"objectClass": "EnemyRangedTextures",
													"sid": 199114036946289,
													"parameters": {
														"animation": "\"IdleRanged\" & EnemyRanged.currentAngle",
														"from": "current-frame"
													}
												}
											],
											"sid": 408347038809444
										}
									],
									"isOrBlock": true
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Stop to avoid too much overlapping."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 507244187582535,
									"parameters": {
										"object": "EnemyRangedFreeCheck"
									}
								},
								{
									"id": "is-overlapping-another-object",
									"objectClass": "EnemyRangedFreeCheck",
									"sid": 799849429765080,
									"parameters": {
										"object": "Enemies"
									}
								}
							],
							"actions": [],
							"sid": 190217408729533,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-parent",
											"objectClass": "EnemyRangedFreeCheck",
											"sid": 969112369767734,
											"parameters": {
												"parent": "EnemyRanged",
												"which": "own"
											}
										}
									],
									"actions": [
										{
											"id": "set-speed",
											"objectClass": "EnemyRanged",
											"sid": 797279846289936,
											"behaviorType": "Pathfinding",
											"parameters": {
												"speed": "0"
											}
										}
									],
									"sid": 960329613866508
								}
							]
						}
					],
					"sid": 832286021365399
				}
			],
			"sid": 881510546397033
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Stalagmite",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "Setup stalagmites."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 846377185150515
						},
						{
							"id": "for-each",
							"objectClass": "System",
							"sid": 642250865954730,
							"parameters": {
								"object": "StalagmiteSpawner"
							}
						}
					],
					"actions": [
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 284008724179096,
							"parameters": {
								"object-to-create": "StalagmiteGeometry",
								"layer": "\"Entities\"",
								"x": "StalagmiteSpawner.X",
								"y": "StalagmiteSpawner.Y",
								"create-hierarchy": true,
								"template-name": "StalagmiteSpawner.AnimationName"
							}
						},
						{
							"id": "set-z-elevation",
							"objectClass": "StalagmiteGeometry",
							"sid": 151710795847618,
							"parameters": {
								"z": "StalagmiteSpawner.ZElevation"
							}
						}
					],
					"sid": 449396720721989
				},
				{
					"eventType": "comment",
					"text": "If the player touches a stalagmite, they get hit."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-overlapping-another-object",
							"objectClass": "Player",
							"sid": 618024857867373,
							"parameters": {
								"object": "StalagmiteGeometry"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 684166123661770,
							"parameters": {
								"value": "Player.ZElevation <= StalagmiteGeometry.ZElevation + StalagmiteGeometry.ZHeight"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 211667815576002,
							"parameters": {
								"value": "Player.ZElevation >= StalagmiteGeometry.ZElevation"
							}
						},
						{
							"id": "is-timer-running",
							"objectClass": "Player",
							"sid": 975102784756930,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"Immune\""
							},
							"isInverted": true
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Deal damage to the player."
						},
						{
							"customAction": "Hit",
							"objectClass": "Player",
							"sid": 293406441160662,
							"parameters": [
								"10"
							]
						},
						{
							"type": "comment",
							"text": "Become immune from receiving stalagmite damage for a brief period."
						},
						{
							"id": "start-timer",
							"objectClass": "Player",
							"sid": 316333727397993,
							"behaviorType": "Timer",
							"parameters": {
								"duration": "0.25",
								"type": "once",
								"tag": "\"Immune\""
							}
						},
						{
							"type": "comment",
							"text": "Stop the player."
						},
						{
							"id": "set-max-speed",
							"objectClass": "Player",
							"sid": 911075461922085,
							"behaviorType": "8Direction",
							"parameters": {
								"max-speed": "0"
							}
						},
						{
							"id": "set-enabled",
							"objectClass": "Player",
							"sid": 690962634260403,
							"behaviorType": "8Direction",
							"parameters": {
								"state": "disabled"
							}
						},
						{
							"type": "comment",
							"text": "Push the player back."
						},
						{
							"id": "tween-two-properties",
							"objectClass": "Player",
							"sid": 944325797841494,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"PushPlayer\"",
								"property": "position",
								"end-x": "Player.X + cos(angle(StalagmiteGeometry.X, StalagmiteGeometry.Y, Player.X, Player.Y)) * 16",
								"end-y": "Player.Y + sin(angle(StalagmiteGeometry.X, StalagmiteGeometry.Y, Player.X, Player.Y)) * 16",
								"time": "0.1",
								"ease": "easeoutsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						},
						{
							"type": "comment",
							"text": "Make player smoothly regain their normal walking speed."
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 189080772630430
						},
						{
							"id": "set-enabled",
							"objectClass": "Player",
							"sid": 388012674321934,
							"behaviorType": "8Direction",
							"parameters": {
								"state": "enabled"
							}
						},
						{
							"id": "tween-value",
							"objectClass": "Player",
							"sid": 265663365844537,
							"behaviorType": "Tween",
							"parameters": {
								"tags": "\"PlayerSpeedTween\"",
								"start-value": "0",
								"end-value": "Self.defaultMaxSpeed",
								"time": "0.5",
								"ease": "easeinsine",
								"destroy-on-complete": "no",
								"loop": "no",
								"ping-pong": "no",
								"repeat-count": "1"
							}
						}
					],
					"sid": 843163051170793
				}
			],
			"sid": 974315325178864
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "Totem",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "group",
					"disabled": false,
					"title": "Totem Setup",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Spawn totem."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-created",
									"objectClass": "TotemSpawner",
									"sid": 759728883822332
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Create the totem itself and set onGeometryID."
								},
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 570694744583074,
									"parameters": {
										"object-to-create": "Totem",
										"layer": "\"Entities\"",
										"x": "TotemSpawner.X",
										"y": "TotemSpawner.Y",
										"create-hierarchy": true,
										"template-name": "\"\""
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Totem",
									"sid": 270147054113932,
									"parameters": {
										"instance-variable": "onGeometryID",
										"value": "TotemSpawner.onGeometryID"
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Totem",
									"sid": 354970636835379,
									"parameters": {
										"instance-variable": "extraCooldown",
										"value": "TotemSpawner.extraCooldown"
									}
								}
							],
							"sid": 912337350680385,
							"children": [
								{
									"eventType": "comment",
									"text": "Get the created totem and its children."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-last-created",
											"objectClass": "System",
											"sid": 152543067680755,
											"parameters": {
												"object": "Totem"
											}
										},
										{
											"id": "pick-children",
											"objectClass": "Totem",
											"sid": 629925210952920,
											"parameters": {
												"child": "TotemShape",
												"which": "own"
											}
										},
										{
											"id": "pick-children",
											"objectClass": "Totem",
											"sid": 692935259442465,
											"parameters": {
												"child": "Geometry",
												"which": "own"
											}
										},
										{
											"id": "pick-children",
											"objectClass": "Totem",
											"sid": 217379008007009,
											"parameters": {
												"child": "EnemyNoGoZone",
												"which": "own"
											}
										}
									],
									"actions": [
										{
											"type": "comment",
											"text": "Set animation."
										},
										{
											"id": "set-animation-frame",
											"objectClass": "TotemTexture",
											"sid": 954662083424567,
											"parameters": {
												"frame-number": "1"
											}
										},
										{
											"type": "comment",
											"text": "Set positions."
										},
										{
											"id": "set-z-elevation",
											"objectClass": "Totem",
											"sid": 886946377073736,
											"parameters": {
												"z": "TotemSpawner.ZElevation + 12"
											}
										},
										{
											"id": "set-z-elevation",
											"objectClass": "Geometry",
											"sid": 321839962378586,
											"parameters": {
												"z": "TotemSpawner.ZElevation"
											}
										},
										{
											"id": "set-z-elevation",
											"objectClass": "EnemyNoGoZone",
											"sid": 983581242934796,
											"parameters": {
												"z": "TotemSpawner.ZElevation"
											}
										},
										{
											"type": "comment",
											"text": "Set geometryID correctly."
										},
										{
											"id": "set-instvar-value",
											"objectClass": "Geometry",
											"sid": 490113110178484,
											"parameters": {
												"instance-variable": "geometryID",
												"value": "Totem.onGeometryID"
											}
										}
									],
									"sid": 156488052687428,
									"children": [
										{
											"eventType": "comment",
											"text": "Set positions of TotemShapes."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "pick-by-highest-lowest-value",
													"objectClass": "System",
													"sid": 666855724519316,
													"parameters": {
														"object": "TotemShape",
														"which": "lowest",
														"expression": "TotemShape.ZElevation"
													}
												}
											],
											"actions": [
												{
													"id": "set-z-elevation",
													"objectClass": "TotemShape",
													"sid": 112916145763828,
													"parameters": {
														"z": "TotemSpawner.ZElevation"
													}
												}
											],
											"sid": 270739960728241
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "pick-by-highest-lowest-value",
													"objectClass": "System",
													"sid": 427737638296639,
													"parameters": {
														"object": "TotemShape",
														"which": "highest",
														"expression": "TotemShape.ZElevation"
													}
												}
											],
											"actions": [
												{
													"id": "set-z-elevation",
													"objectClass": "TotemShape",
													"sid": 143444402979545,
													"parameters": {
														"z": "TotemSpawner.ZElevation + TotemShape.ZHeight + Totem.ZHeight"
													}
												}
											],
											"sid": 321631174958980
										}
									]
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Setup totem."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-created",
									"objectClass": "Totem",
									"sid": 623694063585995
								}
							],
							"actions": [
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 342899436349021,
									"parameters": {
										"seconds": "0",
										"use-timescale": true
									}
								},
								{
									"id": "start-timer",
									"objectClass": "Totem",
									"sid": 708734898799666,
									"behaviorType": "Timer",
									"parameters": {
										"duration": "Self.cooldown + Self.extraCooldown",
										"type": "once",
										"tag": "\"TotemAction\""
									}
								}
							],
							"sid": 521361865552736,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-boolean-instance-variable-set",
											"objectClass": "Totem",
											"sid": 487535760209847,
											"parameters": {
												"instance-variable": "open"
											}
										}
									],
									"actions": [
										{
											"customAction": "Open",
											"objectClass": "Totem",
											"sid": 420691854839600
										}
									],
									"sid": 302967031597578
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 338755999249608
										}
									],
									"actions": [
										{
											"customAction": "Close",
											"objectClass": "Totem",
											"sid": 804137018958754
										}
									],
									"sid": 214430698728835
								}
							]
						}
					],
					"sid": 329508231246560
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "Totem Effects",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Flash the enemy's billboard."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 951147030764547,
									"parameters": {
										"object": "Totem"
									}
								},
								{
									"id": "is-playing",
									"objectClass": "Totem",
									"sid": 574011740865054,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"TotemFlash\""
									}
								},
								{
									"id": "pick-children",
									"objectClass": "Totem",
									"sid": 653771595246833,
									"parameters": {
										"child": "TotemShape",
										"which": "own"
									}
								}
							],
							"actions": [
								{
									"id": "set-effect-parameter",
									"objectClass": "Totem",
									"sid": 549935861796489,
									"parameters": {
										"effect": "\"AdjustHSL\"",
										"parameter-index": "2",
										"value": "Totem.Tween.Value(\"TotemFlash\")"
									}
								},
								{
									"id": "set-effect-parameter",
									"objectClass": "TotemShape",
									"sid": 105681231188817,
									"parameters": {
										"effect": "\"AdjustHSL\"",
										"parameter-index": "2",
										"value": "Totem.Tween.Value(\"TotemFlash\")"
									}
								}
							],
							"sid": 642846437040945
						},
						{
							"eventType": "comment",
							"text": "Control totem's Z Height."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 440608742772326,
									"parameters": {
										"object": "Totem"
									}
								},
								{
									"id": "is-playing",
									"objectClass": "Totem",
									"sid": 302658875165598,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"TotemResize\""
									}
								}
							],
							"actions": [
								{
									"id": "set-z-height",
									"objectClass": "Totem",
									"sid": 650443543423495,
									"parameters": {
										"z-height": "Self.Tween.Value(\"TotemResize\")"
									}
								}
							],
							"sid": 694807722170459
						}
					],
					"sid": 303891461196116
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "Totem Actions",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Totem starts/ends attack procedure depending on the player position."
						},
						{
							"aceType": "action",
							"aceName": "Act",
							"objectClass": "Totem",
							"functionDescription": "Totem starts/ends attack procedure depending on the player position",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [],
							"sid": 682547891106690,
							"children": [
								{
									"eventType": "variable",
									"name": "angleOfMotion",
									"type": "number",
									"initialValue": "0",
									"comment": "Projectile's angle of motion",
									"isStatic": false,
									"isConstant": false,
									"sid": 152741494960996
								},
								{
									"eventType": "comment",
									"text": "Player is nearby."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "evaluate-expression",
											"objectClass": "System",
											"sid": 574875269861529,
											"parameters": {
												"value": "Totem.onGeometryID = Player.onGeometryID"
											}
										},
										{
											"id": "is-boolean-instance-variable-set",
											"objectClass": "Player",
											"sid": 288085985211587,
											"parameters": {
												"instance-variable": "cloaked"
											},
											"isInverted": true
										}
									],
									"actions": [],
									"sid": 564805200612511,
									"children": [
										{
											"eventType": "comment",
											"text": "Totem can only shoot if it's already open."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "is-boolean-instance-variable-set",
													"objectClass": "Totem",
													"sid": 768098600201478,
													"parameters": {
														"instance-variable": "open"
													}
												}
											],
											"actions": [
												{
													"type": "comment",
													"text": "Play sound."
												},
												{
													"callFunction": "playSFX",
													"sid": 496625676349541,
													"parameters": [
														"\"spell\"",
														"\"ETAttack\"",
														"-10",
														"random(0.9, 1.2)"
													]
												},
												{
													"type": "comment",
													"text": "Set totem animation."
												},
												{
													"id": "start-animation",
													"objectClass": "TotemTexture",
													"sid": 434236662111910,
													"parameters": {
														"from": "beginning"
													}
												},
												{
													"type": "comment",
													"text": "Set projectile's angle of motion."
												},
												{
													"id": "set-eventvar-value",
													"objectClass": "System",
													"sid": 745151478418963,
													"parameters": {
														"variable": "angleOfMotion",
														"value": "angle(Totem.X, Totem.Y, Player.X, Player.Y)"
													}
												},
												{
													"type": "comment",
													"text": "Create and setup the projectile."
												},
												{
													"customAction": "Create projectile",
													"objectClass": "EnemyProjectile",
													"sid": 325846700640369,
													"parameters": [
														"\"EnemyTotem0\"",
														"Totem.X + cos(angleOfMotion) * 16",
														"Totem.Y + sin(angleOfMotion) * 16",
														"Totem.ZElevation + 2",
														"angleOfMotion"
													]
												},
												{
													"type": "comment",
													"text": "Create cast effect."
												},
												{
													"callFunction": "createFX",
													"sid": 511168463703733,
													"parameters": [
														"\"Plane\"",
														"\"EnemyTotemEffect\"",
														"Totem.X",
														"Totem.Y",
														"Totem.ZElevation + 4"
													]
												}
											],
											"sid": 587640512975751
										},
										{
											"eventType": "comment",
											"text": "Open the totem."
										},
										{
											"eventType": "block",
											"conditions": [],
											"actions": [
												{
													"customAction": "Open",
													"objectClass": "Totem",
													"sid": 911379426690900
												}
											],
											"sid": 920493379685901
										}
									]
								},
								{
									"eventType": "comment",
									"text": "Player is not nearby."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 782110288957395
										}
									],
									"actions": [
										{
											"type": "comment",
											"text": "Close the totem."
										},
										{
											"customAction": "Close",
											"objectClass": "Totem",
											"sid": 434570727546392
										}
									],
									"sid": 987580252540823
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Trigger an action."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "Totem",
									"sid": 825443358253112,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"TotemAction\""
									}
								},
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 152394464316594,
									"parameters": {
										"object": "Totem"
									}
								}
							],
							"actions": [
								{
									"customAction": "Act",
									"objectClass": "Totem",
									"sid": 858777726389721
								},
								{
									"id": "start-timer",
									"objectClass": "Totem",
									"sid": 124086172628848,
									"behaviorType": "Timer",
									"parameters": {
										"duration": "Self.cooldown",
										"type": "once",
										"tag": "\"TotemAction\""
									}
								}
							],
							"sid": 331720073688263
						},
						{
							"eventType": "comment",
							"text": "Take a hit."
						},
						{
							"aceType": "action",
							"aceName": "Take hit",
							"objectClass": "Totem",
							"functionDescription": "Take a hit",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "damage",
									"type": "number",
									"initialValue": "0",
									"comment": "How much hp to subtract",
									"sid": 107507052505553
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "is-boolean-instance-variable-set",
									"objectClass": "Totem",
									"sid": 722486652633807,
									"parameters": {
										"instance-variable": "dead"
									},
									"isInverted": true
								},
								{
									"id": "is-boolean-instance-variable-set",
									"objectClass": "Totem",
									"sid": 940547397215623,
									"parameters": {
										"instance-variable": "recovering"
									},
									"isInverted": true
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Play sound."
								},
								{
									"callFunction": "playSFX",
									"sid": 117478583435377,
									"parameters": [
										"\"hit\"",
										"\"ETHit\"",
										"-11",
										"random(1.5, 1.8)"
									]
								},
								{
									"type": "comment",
									"text": "Subtract hp."
								},
								{
									"id": "subtract-from-instvar",
									"objectClass": "Totem",
									"sid": 804742404108426,
									"parameters": {
										"instance-variable": "hp",
										"value": "damage"
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "Totem",
									"sid": 540087624638206,
									"parameters": {
										"instance-variable": "recovering",
										"value": "true"
									}
								},
								{
									"type": "comment",
									"text": "Flash the enemy."
								},
								{
									"id": "tween-value",
									"objectClass": "Totem",
									"sid": 357628751398746,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"TotemFlash\"",
										"start-value": "100",
										"end-value": "150",
										"time": "0.075",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "yes",
										"repeat-count": "1"
									}
								}
							],
							"sid": 143724220260446,
							"children": [
								{
									"eventType": "comment",
									"text": "Totem died."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "Totem",
											"sid": 342035931422748,
											"parameters": {
												"instance-variable": "hp",
												"comparison": 3,
												"value": "0"
											}
										}
									],
									"actions": [
										{
											"type": "comment",
											"text": "Set state."
										},
										{
											"id": "set-boolean-instvar",
											"objectClass": "Totem",
											"sid": 280809608435586,
											"parameters": {
												"instance-variable": "dead",
												"value": "true"
											}
										},
										{
											"type": "comment",
											"text": "Stop timers."
										},
										{
											"id": "stop-all-timers",
											"objectClass": "Totem",
											"sid": 804503175794333,
											"behaviorType": "Timer"
										},
										{
											"type": "comment",
											"text": "Close the totem for good."
										},
										{
											"customAction": "Close",
											"objectClass": "Totem",
											"sid": 530637732128276
										}
									],
									"sid": 210663054096049
								},
								{
									"eventType": "comment",
									"text": "Start recovery time."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 585313302951896
										}
									],
									"actions": [],
									"sid": 140633419069356,
									"children": [
										{
											"eventType": "comment",
											"text": "Recovery time changes depending on player berserk status."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "is-timer-running",
													"objectClass": "Player",
													"sid": 322852779160346,
													"behaviorType": "Timer",
													"parameters": {
														"tag": "\"playerBerserk\""
													}
												}
											],
											"actions": [
												{
													"id": "start-timer",
													"objectClass": "Totem",
													"sid": 170936136503678,
													"behaviorType": "Timer",
													"parameters": {
														"duration": "Player.berserkMeleeCooldown",
														"type": "once",
														"tag": "\"TotemRecovery\""
													}
												}
											],
											"sid": 714079399975524
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "else",
													"objectClass": "System",
													"sid": 169244353134258
												}
											],
											"actions": [
												{
													"id": "start-timer",
													"objectClass": "Totem",
													"sid": 825732551584257,
													"behaviorType": "Timer",
													"parameters": {
														"duration": "Player.defaultMeleeCooldown",
														"type": "once",
														"tag": "\"TotemRecovery\""
													}
												}
											],
											"sid": 678394445305873
										}
									]
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Totem has recovered."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "Totem",
									"sid": 392800667330393,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"TotemRecovery\""
									}
								}
							],
							"actions": [
								{
									"id": "set-boolean-instvar",
									"objectClass": "Totem",
									"sid": 545165776991347,
									"parameters": {
										"instance-variable": "recovering",
										"value": "false"
									}
								}
							],
							"sid": 246540264349483
						},
						{
							"eventType": "comment",
							"text": "Open the totem."
						},
						{
							"aceType": "action",
							"aceName": "Open",
							"objectClass": "Totem",
							"functionDescription": "Open the totem",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "is-boolean-instance-variable-set",
									"objectClass": "Totem",
									"sid": 954424630391820,
									"parameters": {
										"instance-variable": "open"
									},
									"isInverted": true
								},
								{
									"id": "is-overlapping-another-object",
									"objectClass": "TotemShape",
									"sid": 955319998266893,
									"parameters": {
										"object": "Player"
									},
									"isInverted": true
								},
								{
									"id": "pick-children",
									"objectClass": "Totem",
									"sid": 765467943656049,
									"parameters": {
										"child": "TotemShape",
										"which": "own"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 132456820007116,
									"parameters": {
										"object": "TotemShape",
										"which": "highest",
										"expression": "TotemShape.ZElevation"
									}
								},
								{
									"id": "pick-children",
									"objectClass": "Totem",
									"sid": 467536488906599,
									"parameters": {
										"child": "Geometry",
										"which": "own"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Play sound."
								},
								{
									"callFunction": "playSFX",
									"sid": 736788989734191,
									"parameters": [
										"\"totem_open\"",
										"\"ETOpen\"",
										"-8 - distance(Player.X, Player.Y, Totem.X, Totem.Y)/14",
										"random(0.95, 1.15)"
									]
								},
								{
									"type": "comment",
									"text": "Animate totem."
								},
								{
									"id": "tween-one-property",
									"objectClass": "TotemShape",
									"sid": 357651796020138,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"LaunchTotemShape\"",
										"property": "offsetZElevation",
										"end-value": "Totem.ZElevation + Totem.defaultHeight",
										"time": "0.5",
										"ease": "easeoutbounce",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "tween-value",
									"objectClass": "Totem",
									"sid": 115828233701377,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"TotemResize\"",
										"start-value": "0",
										"end-value": "Self.defaultHeight",
										"time": "0.5",
										"ease": "easeoutbounce",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "set-z-height",
									"objectClass": "Geometry",
									"sid": 590884171383394,
									"parameters": {
										"z-height": "TotemShape.ZHeight * 2 + Totem.defaultHeight"
									}
								},
								{
									"type": "comment",
									"text": "Set state as open."
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "Totem",
									"sid": 108915810351690,
									"parameters": {
										"instance-variable": "open",
										"value": "true"
									}
								}
							],
							"sid": 677754721471542
						},
						{
							"eventType": "comment",
							"text": "Close the totem."
						},
						{
							"aceType": "action",
							"aceName": "Close",
							"objectClass": "Totem",
							"functionDescription": "Close the totem",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "is-boolean-instance-variable-set",
									"objectClass": "Totem",
									"sid": 923459586103291,
									"parameters": {
										"instance-variable": "open"
									}
								},
								{
									"id": "pick-children",
									"objectClass": "Totem",
									"sid": 846856524690536,
									"parameters": {
										"child": "TotemShape",
										"which": "own"
									}
								},
								{
									"id": "pick-by-highest-lowest-value",
									"objectClass": "System",
									"sid": 354058013956672,
									"parameters": {
										"object": "TotemShape",
										"which": "highest",
										"expression": "TotemShape.ZElevation"
									}
								},
								{
									"id": "pick-children",
									"objectClass": "Totem",
									"sid": 390559153460202,
									"parameters": {
										"child": "Geometry",
										"which": "own"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Play sound."
								},
								{
									"callFunction": "playSFX",
									"sid": 849361727498663,
									"parameters": [
										"\"totem_close\"",
										"\"ETClose\"",
										"-8 - distance(Player.X, Player.Y, Totem.X, Totem.Y)/14",
										"random(0.95, 1.15)"
									]
								},
								{
									"type": "comment",
									"text": "Animate totem."
								},
								{
									"id": "tween-one-property",
									"objectClass": "TotemShape",
									"sid": 716932603044764,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"DropTotemShape\"",
										"property": "offsetZElevation",
										"end-value": "Totem.ZElevation",
										"time": "0.5",
										"ease": "easeoutbounce",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "tween-value",
									"objectClass": "Totem",
									"sid": 913596077482034,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"TotemResize\"",
										"start-value": "Self.defaultHeight",
										"end-value": "0",
										"time": "0.5",
										"ease": "easeoutbounce",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "set-z-height",
									"objectClass": "Geometry",
									"sid": 361197216819242,
									"parameters": {
										"z-height": "TotemShape.ZHeight * 2"
									}
								},
								{
									"type": "comment",
									"text": "Set state as closed."
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "Totem",
									"sid": 931372303978811,
									"parameters": {
										"instance-variable": "open",
										"value": "false"
									}
								}
							],
							"sid": 868944925168984
						}
					],
					"sid": 148298149074684
				}
			],
			"sid": 119909286891709
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "HurtArea",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "comment",
					"text": "If the player touches a hurt area, they get hit with a pushback."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-overlapping-another-object",
							"objectClass": "Player",
							"sid": 428807277394490,
							"parameters": {
								"object": "HurtArea"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 401782363709783,
							"parameters": {
								"value": "Player.ZElevation <= HurtArea.ZElevation + 4"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 119559548529033,
							"parameters": {
								"value": "Player.ZElevation >= HurtArea.ZElevation - 2"
							}
						},
						{
							"id": "is-timer-running",
							"objectClass": "Player",
							"sid": 712039124917655,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "\"Immune\""
							},
							"isInverted": true
						}
					],
					"actions": [
						{
							"customAction": "Pushback",
							"objectClass": "Player",
							"sid": 783308561737859,
							"parameters": [
								"HurtArea.X",
								"HurtArea.Y"
							]
						}
					],
					"sid": 509711765058803
				}
			],
			"sid": 954069975557637
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "FinalBoss",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "variable",
					"name": "TOTEM_UP_Z",
					"type": "number",
					"initialValue": "48",
					"comment": "Totem's Z elevation when up",
					"isStatic": false,
					"isConstant": true,
					"sid": 660359846932184
				},
				{
					"eventType": "variable",
					"name": "TOTEM_DN_Z",
					"type": "number",
					"initialValue": "12",
					"comment": "Totem's Z elevation when down",
					"isStatic": false,
					"isConstant": true,
					"sid": 123681885642535
				},
				{
					"eventType": "variable",
					"name": "TOTEM_DD_Z",
					"type": "number",
					"initialValue": "0",
					"comment": "Totem's Z elevation when dead",
					"isStatic": false,
					"isConstant": true,
					"sid": 987643471772069
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "EndGame Area",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Change the world for the final battle."
						},
						{
							"functionName": "prepareFinalBattle",
							"functionDescription": "Change the world for the final battle",
							"functionCategory": "Game",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "function-block",
							"conditions": [],
							"actions": [
								{
									"type": "comment",
									"text": "Block sounds."
								},
								{
									"callFunction": "blockSFX",
									"sid": 987514237154540
								},
								{
									"type": "comment",
									"text": "Hide the avalanche totem."
								},
								{
									"id": "set-z-elevation",
									"objectClass": "TotemAvalanche",
									"sid": 113476348035729,
									"parameters": {
										"z": "TOTEM_DD_Z"
									}
								},
								{
									"type": "comment",
									"text": "Hide the water."
								},
								{
									"id": "set-visible",
									"objectClass": "WaterTex",
									"sid": 307804343846075,
									"parameters": {
										"visibility": "invisible"
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "WaterTex",
									"sid": 143799597547478,
									"parameters": {
										"z": "-128"
									}
								},
								{
									"type": "comment",
									"text": "Destroy enemies."
								},
								{
									"customAction": "Take hit",
									"objectClass": "EnemyMelee",
									"sid": 621201150017239,
									"parameters": [
										"9999"
									]
								},
								{
									"customAction": "Take hit",
									"objectClass": "EnemyRanged",
									"sid": 287184613636133,
									"parameters": [
										"9999"
									]
								},
								{
									"customAction": "Take hit",
									"objectClass": "Totem",
									"sid": 705778087054444,
									"parameters": [
										"9999"
									]
								},
								{
									"id": "destroy",
									"objectClass": "StalagmiteGeometry",
									"sid": 612631244337637
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 588547333215929,
									"parameters": {
										"seconds": "0",
										"use-timescale": true
									}
								},
								{
									"type": "comment",
									"text": "Destroy items."
								},
								{
									"id": "destroy",
									"objectClass": "ItemShadow",
									"sid": 623611718273990
								},
								{
									"id": "destroy",
									"objectClass": "ItemBillboard",
									"sid": 614905591792753
								},
								{
									"type": "comment",
									"text": "Destroy most objects on the map."
								},
								{
									"id": "destroy",
									"objectClass": "SnowBillboard",
									"sid": 907779969519012
								},
								{
									"id": "destroy",
									"objectClass": "SnowManager",
									"sid": 837787592891565
								},
								{
									"id": "destroy",
									"objectClass": "FakeGeometry",
									"sid": 112600906688980
								},
								{
									"id": "destroy",
									"objectClass": "PropBillboard",
									"sid": 112963544335523
								},
								{
									"id": "destroy",
									"objectClass": "MixedTundraTilemap0",
									"sid": 307346511818765
								},
								{
									"id": "destroy",
									"objectClass": "MixedSnowTilemap0",
									"sid": 523623153300351
								},
								{
									"type": "comment",
									"text": "Show TotemFinal bases."
								},
								{
									"id": "set-visible",
									"objectClass": "TotemFinalSpawner",
									"sid": 186098539014901,
									"parameters": {
										"visibility": "visible"
									}
								},
								{
									"type": "comment",
									"text": "Unblock sounds."
								},
								{
									"callFunction": "unblockSFX",
									"sid": 927305096095312
								}
							],
							"sid": 672366378317974,
							"children": [
								{
									"eventType": "comment",
									"text": "Destroy all unecessary geometries."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-by-evaluate",
											"objectClass": "System",
											"sid": 932374044512226,
											"parameters": {
												"object": "Geometry",
												"expression": "Geometry.geometryID <> 10"
											}
										}
									],
									"actions": [
										{
											"id": "destroy",
											"objectClass": "Geometry",
											"sid": 296391806520885
										}
									],
									"sid": 441700608982296
								},
								{
									"eventType": "comment",
									"text": "Create TotemFinals."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for-each",
											"objectClass": "System",
											"sid": 203849672875023,
											"parameters": {
												"object": "TotemFinalSpawner"
											}
										}
									],
									"actions": [
										{
											"id": "create-object",
											"objectClass": "System",
											"sid": 919084439047168,
											"parameters": {
												"object-to-create": "TotemFinalBillboard",
												"layer": "\"Entities\"",
												"x": "TotemFinalSpawner.X",
												"y": "TotemFinalSpawner.Y",
												"create-hierarchy": true,
												"template-name": "\"\""
											}
										},
										{
											"id": "set-z-elevation",
											"objectClass": "TotemFinalBillboard",
											"sid": 590563409121451,
											"parameters": {
												"z": "TOTEM_UP_Z"
											}
										},
										{
											"id": "set-instvar-value",
											"objectClass": "TotemFinalBillboard",
											"sid": 145608215892647,
											"parameters": {
												"instance-variable": "totemID",
												"value": "TotemFinalSpawner.totemID"
											}
										}
									],
									"sid": 230334700768821
								},
								{
									"eventType": "comment",
									"text": "Show cavern floor and create pillar."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-by-evaluate",
											"objectClass": "System",
											"sid": 424256683267575,
											"parameters": {
												"object": "Geometry",
												"expression": "Geometry.pillar"
											}
										}
									],
									"actions": [
										{
											"id": "set-visible",
											"objectClass": "Geometry",
											"sid": 672346905657317,
											"parameters": {
												"visibility": "visible"
											}
										},
										{
											"id": "set-visible",
											"objectClass": "MixedCavernTilemap0",
											"sid": 101147103259535,
											"parameters": {
												"visibility": "visible"
											}
										},
										{
											"callFunction": "createPillar",
											"sid": 939291113512377,
											"parameters": [
												"Geometry.X",
												"Geometry.Y",
												"Geometry.ZElevation",
												"Geometry.Width",
												"Geometry.Height"
											]
										}
									],
									"sid": 708941671995225
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Activate end-game sequence."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-collision-with-another-object",
									"objectClass": "Player",
									"sid": 958875487371159,
									"parameters": {
										"object": "EndGameArea"
									}
								},
								{
									"id": "is-boolean-instance-variable-set",
									"objectClass": "EndGameArea",
									"sid": 261274831019105,
									"parameters": {
										"instance-variable": "activated"
									},
									"isInverted": true
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Activate zone."
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "EndGameArea",
									"sid": 622589381385333,
									"parameters": {
										"instance-variable": "activated",
										"value": "true"
									}
								},
								{
									"type": "comment",
									"text": "Fade the BGM out."
								},
								{
									"callFunction": "fadeBGM",
									"sid": 587139140995615,
									"parameters": [
										false,
										"1.0"
									]
								},
								{
									"type": "comment",
									"text": "Disable controls."
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "Player",
									"sid": 138894421314181,
									"parameters": {
										"instance-variable": "performingAction",
										"value": "true"
									}
								},
								{
									"id": "set-animation",
									"objectClass": "PlayerTextures",
									"sid": 502896384407118,
									"parameters": {
										"animation": "\"Idle\" & Player.currentAngle",
										"from": "beginning"
									}
								},
								{
									"type": "comment",
									"text": "Change fog."
								},
								{
									"id": "tween-value",
									"objectClass": "EndGameArea",
									"sid": 518422391622957,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ChangeFog\"",
										"start-value": "0",
										"end-value": "100",
										"time": "2",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "yes",
										"repeat-count": "1"
									}
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 518635296520381,
									"parameters": {
										"seconds": "2.1",
										"use-timescale": true
									}
								},
								{
									"callFunction": "prepareFinalBattle",
									"sid": 652469041872760
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 654228002363804,
									"parameters": {
										"seconds": "2.1",
										"use-timescale": true
									}
								},
								{
									"type": "comment",
									"text": "Hide totems."
								},
								{
									"id": "tween-one-property",
									"objectClass": "TotemFinalBillboard",
									"sid": 229006203148276,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"HideTotem\"",
										"property": "offsetZElevation",
										"end-value": "TOTEM_DN_Z",
										"time": "1",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"type": "comment",
									"text": "Play boss music."
								},
								{
									"callFunction": "playBGM",
									"sid": 128072871727364,
									"parameters": [
										"\"Shooshi\"",
										false,
										"-2"
									]
								},
								{
									"type": "comment",
									"text": "Enable controls and start the battle."
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 479857128636035,
									"parameters": {
										"seconds": "1.0",
										"use-timescale": true
									}
								},
								{
									"id": "start-timer",
									"objectClass": "TotemAvalanche",
									"sid": 842948029284254,
									"behaviorType": "Timer",
									"parameters": {
										"duration": "1.0",
										"type": "once",
										"tag": "\"Pattern0\""
									}
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "Player",
									"sid": 511655454803105,
									"parameters": {
										"instance-variable": "performingAction",
										"value": "false"
									}
								}
							],
							"sid": 772269280421021
						},
						{
							"eventType": "comment",
							"text": "Apply changes to fog."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-playing",
									"objectClass": "EndGameArea",
									"sid": 957128567226357,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ChangeFog\""
									}
								}
							],
							"actions": [
								{
									"id": "set-layer-effect-parameter",
									"objectClass": "System",
									"sid": 220810469116917,
									"parameters": {
										"layer": "\"Entities\"",
										"effect": "\"Fogexponential\"",
										"parameter-index": "1",
										"value": "0.65 + EndGameArea.Tween.Value(\"ChangeFog\")/50"
									}
								},
								{
									"id": "set-layer-effect-parameter",
									"objectClass": "System",
									"sid": 338707887021897,
									"parameters": {
										"layer": "\"Entities\"",
										"effect": "\"Fogexponential\"",
										"parameter-index": "2",
										"value": "160 - EndGameArea.Tween.Value(\"ChangeFog\") * 1.6"
									}
								},
								{
									"id": "set-layer-effect-parameter",
									"objectClass": "System",
									"sid": 675260534714947,
									"parameters": {
										"layer": "\"Water\"",
										"effect": "\"Fogexponential\"",
										"parameter-index": "1",
										"value": "0.65 + EndGameArea.Tween.Value(\"ChangeFog\")/60"
									}
								},
								{
									"id": "set-layer-effect-parameter",
									"objectClass": "System",
									"sid": 516517700596179,
									"parameters": {
										"layer": "\"Water\"",
										"effect": "\"Fogexponential\"",
										"parameter-index": "2",
										"value": "160 - EndGameArea.Tween.Value(\"ChangeFog\") * 1.5"
									}
								},
								{
									"id": "set-opacity",
									"objectClass": "PlayerShadow",
									"sid": 474710158521900,
									"parameters": {
										"opacity": "max(50 - EndGameArea.Tween.Value(\"ChangeFog\"), 0)"
									}
								}
							],
							"sid": 934300701337490
						}
					],
					"sid": 209500121177413
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "FinalBoss patterns",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Patterns."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "TotemAvalanche",
									"sid": 395274182110746,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"Pattern0\""
									}
								}
							],
							"actions": [
								{
									"customAction": "Spiral Attack",
									"objectClass": "TotemAvalanche",
									"sid": 828323401431189
								}
							],
							"sid": 240658405205959
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "TotemAvalanche",
									"sid": 444765832681803,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"Pattern1\""
									}
								}
							],
							"actions": [],
							"sid": 573152515558610,
							"children": [
								{
									"eventType": "variable",
									"name": "modInteger",
									"type": "number",
									"initialValue": "0",
									"comment": "Random mod parameter value",
									"isStatic": false,
									"isConstant": false,
									"sid": 708550707644934
								},
								{
									"eventType": "variable",
									"name": "modOffset",
									"type": "number",
									"initialValue": "0",
									"comment": "Random mod offset parameter value",
									"isStatic": false,
									"isConstant": false,
									"sid": 850423112490691
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 612280799424066,
											"parameters": {
												"variable": "modInteger",
												"value": "choose(2, 3, 4, 6)"
											}
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 261896365306383,
											"parameters": {
												"variable": "modOffset",
												"value": "int(random(0, modInteger))"
											}
										},
										{
											"customAction": "Mod Attack",
											"objectClass": "TotemAvalanche",
											"sid": 176351727690808,
											"parameters": [
												"modInteger",
												"modOffset"
											]
										}
									],
									"sid": 955884102048330
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Quick attack animation is done playing. Attack and Immediately go to turtle position."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-tweens-finished",
									"objectClass": "TotemFinalBillboard",
									"sid": 405236794250905,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"TotemAttackQuick\""
									}
								}
							],
							"actions": [
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 555038939512218,
									"parameters": {
										"seconds": "0.2",
										"use-timescale": true
									}
								},
								{
									"customAction": "Attack",
									"objectClass": "TotemFinalBillboard",
									"sid": 248622849176115
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 299882317197243,
									"parameters": {
										"seconds": "0.5",
										"use-timescale": true
									}
								},
								{
									"customAction": "Change Z",
									"objectClass": "TotemFinalBillboard",
									"sid": 929231700087730,
									"parameters": [
										"TOTEM_DN_Z",
										"0.5",
										"\"TotemTurtle\""
									]
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "TotemFinalBillboard",
									"sid": 536773504399622,
									"parameters": {
										"instance-variable": "immune",
										"value": "true"
									}
								}
							],
							"sid": 230734824144130
						},
						{
							"eventType": "comment",
							"text": "Attack animation is done playing. Attack and wait for the next pattern."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-tweens-finished",
									"objectClass": "TotemFinalBillboard",
									"sid": 801727018517390,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"TotemAttack\""
									}
								}
							],
							"actions": [
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 336288201247912,
									"parameters": {
										"seconds": "0.5",
										"use-timescale": true
									}
								},
								{
									"customAction": "Attack",
									"objectClass": "TotemFinalBillboard",
									"sid": 217732102669255
								}
							],
							"sid": 769750539627869
						},
						{
							"eventType": "comment",
							"text": "Perform a spiral attack."
						},
						{
							"aceType": "action",
							"aceName": "Spiral Attack",
							"objectClass": "TotemAvalanche",
							"functionDescription": "Perform a spiral attack",
							"functionCategory": "Attack",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [
								{
									"id": "start-timer",
									"objectClass": "TotemAvalanche",
									"sid": 509622964753487,
									"behaviorType": "Timer",
									"parameters": {
										"duration": "5.5",
										"type": "once",
										"tag": "\"Pattern1\""
									}
								},
								{
									"customAction": "Change Z",
									"objectClass": "TotemFinalBillboard",
									"sid": 809700331770326,
									"parameters": [
										"TOTEM_DN_Z",
										"0.5",
										"\"TotemTurtle\""
									]
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "TotemFinalBillboard",
									"sid": 401210147862452,
									"parameters": {
										"instance-variable": "immune",
										"value": "true"
									}
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 119849250115290,
									"parameters": {
										"seconds": "1",
										"use-timescale": true
									}
								}
							],
							"sid": 260026545007336,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for",
											"objectClass": "System",
											"sid": 113268918584866,
											"parameters": {
												"name": "\"i\"",
												"start-index": "0",
												"end-index": "11"
											}
										},
										{
											"id": "pick-by-evaluate",
											"objectClass": "System",
											"sid": 971779200493854,
											"parameters": {
												"object": "TotemFinalBillboard",
												"expression": "TotemFinalBillboard.totemID = loopindex"
											}
										},
										{
											"id": "is-boolean-instance-variable-set",
											"objectClass": "TotemFinalBillboard",
											"sid": 806370491587625,
											"parameters": {
												"instance-variable": "dead"
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "wait",
											"objectClass": "System",
											"sid": 335128963266707,
											"parameters": {
												"seconds": "0.25 * loopindex",
												"use-timescale": true
											}
										},
										{
											"customAction": "Change Z",
											"objectClass": "TotemFinalBillboard",
											"sid": 926763732128006,
											"parameters": [
												"TOTEM_UP_Z",
												"0.5",
												"\"TotemAttackQuick\""
											]
										},
										{
											"id": "set-boolean-instvar",
											"objectClass": "TotemFinalBillboard",
											"sid": 964640550724831,
											"parameters": {
												"instance-variable": "immune",
												"value": "false"
											}
										}
									],
									"sid": 692079445491908
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Perform a modular attack."
						},
						{
							"aceType": "action",
							"aceName": "Mod Attack",
							"objectClass": "TotemAvalanche",
							"functionDescription": "Perform a modular attack",
							"functionCategory": "Attack",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "mod",
									"type": "number",
									"initialValue": "2",
									"comment": "Modulus",
									"sid": 196237788282853
								},
								{
									"name": "offset",
									"type": "number",
									"initialValue": "0",
									"comment": "Offset value for the mod",
									"sid": 431632832712898
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [],
							"sid": 672106919611835,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-by-evaluate",
											"objectClass": "System",
											"sid": 118404597854467,
											"parameters": {
												"object": "TotemFinalBillboard",
												"expression": "((TotemFinalBillboard.totemID + offset) % mod) = 0"
											}
										}
									],
									"actions": [
										{
											"customAction": "Change Z",
											"objectClass": "TotemFinalBillboard",
											"sid": 480425586948149,
											"parameters": [
												"TOTEM_UP_Z",
												"0.5",
												"\"TotemAttack\""
											]
										},
										{
											"id": "set-boolean-instvar",
											"objectClass": "TotemFinalBillboard",
											"sid": 799166836974147,
											"parameters": {
												"instance-variable": "immune",
												"value": "false"
											}
										},
										{
											"id": "start-timer",
											"objectClass": "TotemAvalanche",
											"sid": 163164530512371,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "3.0",
												"type": "once",
												"tag": "choose(\"Pattern1\", \"Pattern1\", \"Pattern0\")"
											}
										}
									],
									"sid": 977050687832771
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 601951636691734
										}
									],
									"actions": [
										{
											"id": "start-timer",
											"objectClass": "TotemAvalanche",
											"sid": 196249955185436,
											"behaviorType": "Timer",
											"parameters": {
												"duration": "1",
												"type": "once",
												"tag": "\"Pattern0\""
											}
										}
									],
									"sid": 818076335697636
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-by-evaluate",
											"objectClass": "System",
											"sid": 910841800726902,
											"parameters": {
												"object": "TotemFinalBillboard",
												"expression": "((TotemFinalBillboard.totemID + offset) % mod) <> 0"
											}
										}
									],
									"actions": [
										{
											"customAction": "Change Z",
											"objectClass": "TotemFinalBillboard",
											"sid": 619890356953768,
											"parameters": [
												"TOTEM_DN_Z",
												"0.5",
												"\"TotemTurtle\""
											]
										},
										{
											"id": "set-boolean-instvar",
											"objectClass": "TotemFinalBillboard",
											"sid": 455909617785888,
											"parameters": {
												"instance-variable": "immune",
												"value": "true"
											}
										}
									],
									"sid": 782714680777784
								}
							]
						}
					],
					"sid": 701507516580490
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "FinalBoss totems",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "If there are no more totems, apart from the avalanche, end the fight."
						},
						{
							"functionName": "checkEndFight",
							"functionDescription": "If there are no more totems, apart from the avalanche, end the fight",
							"functionCategory": "Game",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "function-block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 521316623766881,
									"parameters": {
										"value": "TotemFinalBillboard.Count <= 1"
									}
								}
							],
							"actions": [
								{
									"id": "tween-one-property",
									"objectClass": "TotemAvalanche",
									"sid": 278430984711963,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ShowAvalanche\"",
										"property": "offsetZElevation",
										"end-value": "TOTEM_UP_Z",
										"time": "0.5",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "TotemAvalanche",
									"sid": 451803511204323,
									"parameters": {
										"instance-variable": "immune",
										"value": "false"
									}
								}
							],
							"sid": 956971161754840
						},
						{
							"eventType": "comment",
							"text": "If the player touches a totem, they get hit with a pushback."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-playing",
									"objectClass": "FinalBoss",
									"sid": 367913749666267,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"TotemAttackQuick\""
									}
								},
								{
									"id": "is-playing",
									"objectClass": "FinalBoss",
									"sid": 794099082523336,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"TotemAttack\""
									}
								},
								{
									"id": "is-playing",
									"objectClass": "FinalBoss",
									"sid": 997439141864978,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"ShowAvalanche\""
									}
								}
							],
							"actions": [],
							"sid": 910911724360419,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-overlapping-another-object",
											"objectClass": "Player",
											"sid": 311827628603872,
											"parameters": {
												"object": "FinalBoss"
											}
										},
										{
											"id": "evaluate-expression",
											"objectClass": "System",
											"sid": 718916979497237,
											"parameters": {
												"value": "Player.ZElevation > FinalBoss.ZElevation"
											}
										},
										{
											"id": "is-timer-running",
											"objectClass": "Player",
											"sid": 709740496209050,
											"behaviorType": "Timer",
											"parameters": {
												"tag": "\"Immune\""
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"customAction": "Pushback",
											"objectClass": "Player",
											"sid": 111481701346159,
											"parameters": [
												"FinalBoss.X",
												"FinalBoss.Y"
											]
										}
									],
									"sid": 334001736601329
								}
							],
							"isOrBlock": true
						},
						{
							"eventType": "comment",
							"text": "Change totem's Z elevation through tween."
						},
						{
							"aceType": "action",
							"aceName": "Change Z",
							"objectClass": "TotemFinalBillboard",
							"functionDescription": "Change totem's Z elevation through tween",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "destinationZ",
									"type": "number",
									"initialValue": "0",
									"comment": "Destination Z elevation",
									"sid": 523281473770985
								},
								{
									"name": "timeToComplete",
									"type": "number",
									"initialValue": "0",
									"comment": "Time to complete the movement",
									"sid": 732632093420368
								},
								{
									"name": "movementTag",
									"type": "string",
									"initialValue": "",
									"comment": "Tag of the movement",
									"sid": 711578714012625
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "is-boolean-instance-variable-set",
									"objectClass": "TotemFinalBillboard",
									"sid": 337839578073718,
									"parameters": {
										"instance-variable": "dead"
									},
									"isInverted": true
								}
							],
							"actions": [
								{
									"id": "tween-one-property",
									"objectClass": "TotemFinalBillboard",
									"sid": 486946511137271,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "movementTag",
										"property": "offsetZElevation",
										"end-value": "destinationZ",
										"time": "timeToComplete",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								}
							],
							"sid": 489356406105676,
							"children": [
								{
									"eventType": "comment",
									"text": "Play open sound."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "evaluate-expression",
											"objectClass": "System",
											"sid": 760074867811192,
											"parameters": {
												"value": "destinationZ > TotemFinalBillboard.ZElevation"
											}
										}
									],
									"actions": [
										{
											"callFunction": "playSFX",
											"sid": 283171951708376,
											"parameters": [
												"\"totem_open\"",
												"\"EFBOpen\"",
												"-8 - distance(Player.X, Player.Y, TotemFinalBillboard.X, TotemFinalBillboard.Y)/14",
												"random(0.95, 1.15)"
											]
										}
									],
									"sid": 989678812625372
								},
								{
									"eventType": "comment",
									"text": "Play close sound."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 158043508060608
										},
										{
											"id": "evaluate-expression",
											"objectClass": "System",
											"sid": 543079801282628,
											"parameters": {
												"value": "destinationZ < TotemFinalBillboard.ZElevation"
											}
										}
									],
									"actions": [
										{
											"callFunction": "playSFX",
											"sid": 294179229796109,
											"parameters": [
												"\"totem_close\"",
												"\"EFBClose\"",
												"-8 - distance(Player.X, Player.Y, TotemFinalBillboard.X, TotemFinalBillboard.Y)/14",
												"random(0.95, 1.15)"
											]
										}
									],
									"sid": 754692429397485
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Make this totem attack."
						},
						{
							"aceType": "action",
							"aceName": "Attack",
							"objectClass": "TotemFinalBillboard",
							"functionDescription": "Make this totem attack",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [],
							"eventType": "custom-ace-block",
							"conditions": [],
							"actions": [],
							"sid": 774280520986011,
							"children": [
								{
									"eventType": "variable",
									"name": "angleOfMotion",
									"type": "number",
									"initialValue": "0",
									"comment": "Projectile's angle of motion",
									"isStatic": false,
									"isConstant": false,
									"sid": 989567461942153
								},
								{
									"eventType": "comment",
									"text": "Player is nearby."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-boolean-instance-variable-set",
											"objectClass": "Player",
											"sid": 333797782128566,
											"parameters": {
												"instance-variable": "cloaked"
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"type": "comment",
											"text": "Play sound."
										},
										{
											"callFunction": "playSFX",
											"sid": 974376998064325,
											"parameters": [
												"\"spell\"",
												"\"EFBAttack\"",
												"-14",
												"random(0.6, 0.9)"
											]
										},
										{
											"type": "comment",
											"text": "Set projectile's angle of motion."
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 435183983110304,
											"parameters": {
												"variable": "angleOfMotion",
												"value": "angle(TotemFinalBillboard.X, TotemFinalBillboard.Y, Player.X, Player.Y)"
											}
										},
										{
											"type": "comment",
											"text": "Create and setup the projectile."
										},
										{
											"customAction": "Create projectile",
											"objectClass": "EnemyProjectile",
											"sid": 624644766768138,
											"parameters": [
												"\"EnemyAvalanche0\"",
												"TotemFinalBillboard.X + cos(angleOfMotion) * 16",
												"TotemFinalBillboard.Y + sin(angleOfMotion) * 16",
												"TotemFinalBillboard.ZElevation + 13",
												"angleOfMotion"
											]
										},
										{
											"type": "comment",
											"text": "Create cast effect."
										},
										{
											"callFunction": "createFX",
											"sid": 656877917273857,
											"parameters": [
												"\"Plane\"",
												"\"EnemyAvalancheEffect\"",
												"TotemFinalBillboard.X",
												"TotemFinalBillboard.Y",
												"TotemFinalBillboard.ZElevation + 13"
											]
										},
										{
											"type": "comment",
											"text": "Play attack animation."
										},
										{
											"id": "start-animation",
											"objectClass": "TotemFinalTex",
											"sid": 163497142668715,
											"parameters": {
												"from": "beginning"
											}
										}
									],
									"sid": 913918429372594
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Play final boss death sound."
						},
						{
							"functionName": "playFinalBossSound",
							"functionDescription": "Play final boss death sound",
							"functionCategory": "Game",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "objectType",
									"type": "string",
									"initialValue": "",
									"comment": "Get current object type",
									"sid": 794182525331261
								}
							],
							"eventType": "function-block",
							"conditions": [
								{
									"id": "evaluate-expression",
									"objectClass": "System",
									"sid": 863667448058482,
									"parameters": {
										"value": "objectType = \"TotemAvalanche\""
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Play sound."
								},
								{
									"callFunction": "playSFX",
									"sid": 210165848499686,
									"parameters": [
										"\"final_boss_death\"",
										"\"EFBDeath\"",
										"-2",
										"1.0"
									]
								}
							],
							"sid": 599431202255769
						},
						{
							"eventType": "comment",
							"text": "Take a hit."
						},
						{
							"aceType": "action",
							"aceName": "Take hit",
							"objectClass": "FinalBoss",
							"functionDescription": "Take a hit",
							"functionCategory": "",
							"functionReturnType": "none",
							"functionCopyPicked": false,
							"functionIsAsync": false,
							"functionParameters": [
								{
									"name": "damage",
									"type": "number",
									"initialValue": "0",
									"comment": "How much hp to subtract",
									"sid": 759823262535861
								}
							],
							"eventType": "custom-ace-block",
							"conditions": [
								{
									"id": "is-boolean-instance-variable-set",
									"objectClass": "FinalBoss",
									"sid": 269804922250806,
									"parameters": {
										"instance-variable": "dead"
									},
									"isInverted": true
								},
								{
									"id": "is-boolean-instance-variable-set",
									"objectClass": "FinalBoss",
									"sid": 342120854073187,
									"parameters": {
										"instance-variable": "recovering"
									},
									"isInverted": true
								},
								{
									"id": "is-boolean-instance-variable-set",
									"objectClass": "FinalBoss",
									"sid": 592077230800605,
									"parameters": {
										"instance-variable": "immune"
									},
									"isInverted": true
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Play sound."
								},
								{
									"callFunction": "playSFX",
									"sid": 637540311872376,
									"parameters": [
										"\"hit\"",
										"\"EFBHit\"",
										"-11",
										"random(1.5, 1.8)"
									]
								},
								{
									"type": "comment",
									"text": "Subtract hp."
								},
								{
									"id": "subtract-from-instvar",
									"objectClass": "FinalBoss",
									"sid": 870817483630625,
									"parameters": {
										"instance-variable": "hp",
										"value": "damage"
									}
								},
								{
									"type": "comment",
									"text": "Set state."
								},
								{
									"id": "set-boolean-instvar",
									"objectClass": "FinalBoss",
									"sid": 345998158294507,
									"parameters": {
										"instance-variable": "recovering",
										"value": "true"
									}
								},
								{
									"type": "comment",
									"text": "Flash the enemy."
								},
								{
									"id": "tween-value",
									"objectClass": "FinalBoss",
									"sid": 667490793150428,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"BossFlash\"",
										"start-value": "100",
										"end-value": "150",
										"time": "0.075",
										"ease": "easeinoutsine",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "yes",
										"repeat-count": "1"
									}
								}
							],
							"sid": 374736673944564,
							"children": [
								{
									"eventType": "comment",
									"text": "Totem died."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "FinalBoss",
											"sid": 604003473696061,
											"parameters": {
												"instance-variable": "hp",
												"comparison": 3,
												"value": "0"
											}
										}
									],
									"actions": [
										{
											"type": "comment",
											"text": "Set state."
										},
										{
											"id": "set-boolean-instvar",
											"objectClass": "FinalBoss",
											"sid": 742352685862139,
											"parameters": {
												"instance-variable": "dead",
												"value": "true"
											}
										},
										{
											"type": "comment",
											"text": "Stop timers and tweems."
										},
										{
											"id": "stop-tweens",
											"objectClass": "FinalBoss",
											"sid": 364861255731235,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"TotemAttack\""
											}
										},
										{
											"id": "stop-tweens",
											"objectClass": "FinalBoss",
											"sid": 572908213663002,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"TotemAttackQuick\""
											}
										},
										{
											"id": "stop-tweens",
											"objectClass": "FinalBoss",
											"sid": 951089152914223,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"TotemTurtle\""
											}
										},
										{
											"id": "stop-all-timers",
											"objectClass": "FinalBoss",
											"sid": 438592082314776,
											"behaviorType": "Timer"
										},
										{
											"type": "comment",
											"text": "Move to dead position."
										},
										{
											"callFunction": "playFinalBossSound",
											"sid": 293498141637732,
											"parameters": [
												"FinalBoss.ObjectTypeName"
											]
										},
										{
											"id": "tween-one-property",
											"objectClass": "FinalBoss",
											"sid": 364767765047161,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"TotemDie\"",
												"property": "offsetZElevation",
												"end-value": "TOTEM_DD_Z",
												"time": "1.0",
												"ease": "easeoutbounce",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										},
										{
											"id": "wait-for-previous-actions",
											"objectClass": "System",
											"sid": 408860853140023
										},
										{
											"id": "destroy",
											"objectClass": "FinalBoss",
											"sid": 629707782265488
										}
									],
									"sid": 882209776925886,
									"children": [
										{
											"eventType": "comment",
											"text": "Check if the boss fight has ended."
										},
										{
											"eventType": "block",
											"conditions": [],
											"actions": [
												{
													"callFunction": "checkEndFight",
													"sid": 886204903181396
												}
											],
											"sid": 893000600628773
										},
										{
											"eventType": "comment",
											"text": "Check if the player has beaten the game."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "evaluate-expression",
													"objectClass": "System",
													"sid": 186530789970884,
													"parameters": {
														"value": "FinalBoss.ObjectTypeName = \"TotemAvalanche\""
													}
												}
											],
											"actions": [
												{
													"type": "comment",
													"text": "Lock player's controls."
												},
												{
													"id": "set-boolean-instvar",
													"objectClass": "Player",
													"sid": 660727879335980,
													"parameters": {
														"instance-variable": "performingAction",
														"value": "true"
													}
												},
												{
													"type": "comment",
													"text": "Play item animation."
												},
												{
													"id": "set-animation",
													"objectClass": "PlayerTextures",
													"sid": 121992700561041,
													"parameters": {
														"animation": "\"Item\"",
														"from": "beginning"
													}
												},
												{
													"type": "comment",
													"text": "Go to credits."
												},
												{
													"callFunction": "goToCredits",
													"sid": 904132826273353
												}
											],
											"sid": 663521129553590
										}
									]
								},
								{
									"eventType": "comment",
									"text": "Start recovery time."
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 312308662450850
										}
									],
									"actions": [],
									"sid": 843495094135659,
									"children": [
										{
											"eventType": "comment",
											"text": "Recovery time changes depending on player berserk status."
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "is-timer-running",
													"objectClass": "Player",
													"sid": 685017437060548,
													"behaviorType": "Timer",
													"parameters": {
														"tag": "\"playerBerserk\""
													}
												}
											],
											"actions": [
												{
													"id": "start-timer",
													"objectClass": "FinalBoss",
													"sid": 172147614729692,
													"behaviorType": "Timer",
													"parameters": {
														"duration": "Player.berserkMeleeCooldown",
														"type": "once",
														"tag": "\"BossRecovery\""
													}
												}
											],
											"sid": 510391182515143
										},
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "else",
													"objectClass": "System",
													"sid": 409631628759989
												}
											],
											"actions": [
												{
													"id": "start-timer",
													"objectClass": "FinalBoss",
													"sid": 410465297613967,
													"behaviorType": "Timer",
													"parameters": {
														"duration": "Player.defaultMeleeCooldown",
														"type": "once",
														"tag": "\"BossRecovery\""
													}
												}
											],
											"sid": 833784988725045
										}
									]
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Totem has recovered."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "on-timer",
									"objectClass": "FinalBoss",
									"sid": 436068068253062,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "\"BossRecovery\""
									}
								}
							],
							"actions": [
								{
									"id": "set-boolean-instvar",
									"objectClass": "FinalBoss",
									"sid": 672359585099932,
									"parameters": {
										"instance-variable": "recovering",
										"value": "false"
									}
								}
							],
							"sid": 672926232938582
						},
						{
							"eventType": "comment",
							"text": "Flash the enemy's billboard."
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "System",
									"sid": 570400481481187,
									"parameters": {
										"object": "FinalBoss"
									}
								},
								{
									"id": "is-playing",
									"objectClass": "FinalBoss",
									"sid": 213998688184058,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "\"BossFlash\""
									}
								}
							],
							"actions": [
								{
									"id": "set-effect-parameter",
									"objectClass": "FinalBoss",
									"sid": 115220378969577,
									"parameters": {
										"effect": "\"AdjustHSL\"",
										"parameter-index": "2",
										"value": "FinalBoss.Tween.Value(\"BossFlash\")"
									}
								}
							],
							"sid": 404774237553573
						}
					],
					"sid": 685796686962613
				}
			],
			"sid": 655400213079225
		}
	],
	"sid": 729429016930983
}